---
title: "Genes diferencialmente expresados y significación biológica"
subtitle: ""
author: "Cristina Muntañola Valero"
date: "`r Sys.Date()`"
output:
  pdf_document:
    toc: true 
    toc_depth: 3
    df_print: paged
  html_document:
    toc: true
    toc_depth: 3
    df_print: paged
urlcolor: blue
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

En esta parte se continúa con los genes anotados (de microarrays), filtrados y normalizados.

# GSE8879


## Selección de genes diferencialmente expresados


Como en las etapas anteriores la selección de genes diferencialmente expresados (GDE) puede basarse en distintas aproximaciones, desde la t de Student al programa SAM pasando por multitud de variantes.

En este ejemplo, dado que se realizaran tres comparaciones que luego deseamos comparar entre ellas, se aplicará la aproximación presentada por Smyth (2004) basado en la utilización del modelo lineal general combinada con un método para obtener una estimación mejorada de la varianza.

Crearemos las matrices de diseño y de contrastes. El primer paso para el análisis basado en modelos lineales es crear la matriz de diseño.

Básicamente, la matriz de diseño es una tabla que describe la asignación de cada muestra a un grupo. Tiene tantas filas como muestras y tantas columnas como grupos (si solo se considera un factor). Cada fila contiene un uno en la columna del grupo al que pertenece la muestra y un cero en las restantes.

La matriz de contrastes se utiliza para describir las comparaciones entre grupos. Consta de tantas columnas como comparaciones y tantas filas como grupos (es decir como columnas de la matriz de diseño). Una comparación entre grupos –llamada “contraste”– se representa con un “1” y un “-1” en las filas de los grupos a comparar y ceros en las restantes. Si varios grupos intervinieran en la comparación se tendría tantos coeficientes como grupos con la única restricción de que su suma sería cero.

La matriz de diseño puede definirse manualmente o a partir de un factor creado específicamente para ello. Utilizaremos el segundo método basándonos en el campo “grupo”


```{r, warning=TRUE, error=FALSE}
setwd('C:/Users/Copito/OneDrive/Documentos/Master bioinf y bioest/TFM/datasets/GSE8879/')
load(file = './GSE8879datos.normalizados.Rda')
require(Biobase)
datadir <- "C:/Users/Copito/OneDrive/Documentos/Master bioinf y bioest/TFM/datasets/"
```



```{r, warning=TRUE, error=FALSE}
library(GEOquery)

GSE8879_getGEO <- getGEO("GSE8879", GSEMatrix =TRUE, AnnotGPL=TRUE, destdir = "C:/Users/Copito/OneDrive/Documentos/Master bioinf y bioest/TFM/datasets/GSE8879/" )

GSE8879_getGEO<-GSE8879_getGEO[[1]]


GSE8879_sampleNames <- GSE8879_getGEO@phenoData@data[["title"]]
GSE8879_grupos<-GSE8879_getGEO@phenoData@data[["characteristics_ch1"]]
```


```{r, warning=TRUE, error=FALSE}

a=c()

for(i in 1:length(GSE8879_grupos)) {
  if (GSE8879_grupos[i]=="cell type: diagnostic leukemic blasts of early T-cell precursor acute lymphoblastic leukemia (ETP)"){
    a[i]<-'ETP'
  }
  else {a[i]<-'not ETP'}
}


GSE8879_design <- model.matrix(~0 + as.factor(a))
rownames(GSE8879_design) <- GSE8879_sampleNames

colnames(GSE8879_design) <- c("ETP", 'not_ETP')
head(GSE8879_design)

```

Las comparaciones que nos interesan son:

-¿Existe desregulación de las RBP entre grupos? No hay interacciones

ETP - not ETP

```{r, warning=TRUE, error=FALSE}

library(limma)
cont.matrix <- makeContrasts(grupos_TALL = ETP - not_ETP, levels = GSE8879_design)
print(cont.matrix)

```

Ahora estimaremos el modelo. Una vez definida la matriz de diseño y los contrastes podemos pasar a estimar el modelo, estimar los contrastes y realizar las pruebas de significación que nos indiquen, para cada gen y cada comparación, si puede considerarse diferencialmente expresado.

El método implementado en limma amplía el análisis tradicional utilizando modelos de Bayes empíricos para combinar la información de toda la matriz de datos y de cada gen individual y obtener estimaciones de error mejoradas.

El análisis proporciona los estadísticos de test habituales como Fold-change t-moderados o p-valores ajustados que se utilizan para ordenar los genes de más a menos diferencialmente expresados.

A fin de controlar el porcentaje de falsos positivos que puedan resultar del alto numero de contrastes realizados simultáneamente los p–valores se ajustan de forma que tengamos control sobre la tasa de falsos positivos utilizando el método de Benjamini y Hochberg.


```{r, warning=TRUE, error=FALSE}
# save(GSE8879_Filtered, eset_GSE8879_Filtered,
     # GSE8879_geneIds, file =
       # "C:/Users/Copito/OneDrive/Documentos/Master bioinf y bioest/TFM/datasets/GSE8879/datos.normalizados.Rda")

library(limma)
fit <- lmFit(eset_GSE8879_Filtered, GSE8879_design)
fit.GSE8879 <- contrasts.fit(fit, cont.matrix)
fit.GSE8879 <- eBayes(fit.GSE8879)
head(rownames(fit.GSE8879))

```

La función topTable genera para cada contraste una lista de genes ordenados de mas a menos diferencialmente expresados.



```{r, warning=TRUE, error=TRUE}
topTab_GSE8879 <- topTable(fit.GSE8879, number = nrow(fit.GSE8879), coef = "grupos_TALL",
    adjust = "fdr")


head(topTab_GSE8879)
```


Para identificar los genes más diferencialmente expresados podemos utilizar la lista de anotaciones y añadir algunas a las topTables.

```{r, warning=TRUE, error=TRUE}
library(dplyr)
anotaTopTab <- function(topTab) {
    topTab_Anot <- topTab %>%
        mutate(PROBEID = rownames(topTab)) %>%
        merge(GSE8879_geneIds, "PROBEID") %>%
        arrange(adj.P.Val)
    return(topTab_Anot)
}
topTab_GSE8879_Anot <- anotaTopTab(topTab_GSE8879)
head(topTab_GSE8879_Anot)
```

```{r, warning=TRUE, error=FALSE}
# save(topTab_GSE37389_Anot,
  # file ="C:/Users/laura/OneDrive/Documentos/Cris/GSE56488topTab_Anot.Rda")

save(topTab_GSE8879_Anot,
  file ="C:/Users/Copito/OneDrive/Documentos/Master bioinf y bioest/TFM/datasets/GSE8879/GSE8879topTab_Anot.Rda")

```

Comparaciones múltiples

Cuando se realizan varias comparaciones a la vez puede resultar importante ver que genes cambian simultáneamente en más de una comparación.

Si el número de comparaciones es alto también puede ser necesario realizar un ajuste de p-valores entre las comparaciones, distinto del realizado entre genes.

La función decidetests permite realizar ambas cosas. En este ejemplo no se ajustaran los p-valores entre comparaciones. Tan solo se seleccionaran los genes que cambian en una o más condiciones.

EL resultado del análisis es una tabla res que para cada gen y cada comparación contiene un 1 (si el gen esta sobre-expresado o up'' en esta condicion), un 0 (si no hay cambio significativo) o un -1  (si esta "down"-regulado).


```{r, warning=TRUE, error=FALSE}
library(limma)
GSE8879_res <- decideTests(fit.GSE8879, method = "separate", adjust.method = "fdr", p.value = 0.05,
    lfc = 0)
```

Para resumir dicho análisis podemos contar qué filas tienen como mínimo una celda distinta de cero:



```{r, warning=TRUE, error=FALSE}
sum.GSE8879res.rows <- apply(abs(GSE8879_res), 1, sum)
GSE8879_res.selected <- GSE8879_res[sum.GSE8879res.rows != 0, ]
print(summary(GSE8879_res))
```


Si ahora visualizamos los resultados de cada comparación por separado, podemos observar como los volcano-plots concuerdan con la tabla anterior


```{r, warning=TRUE, error=FALSE}
xlimits <- c(-3, +3)
ylimits <- c(0, 8)
GSE8879_genenames <- topTab_GSE8879_Anot$SYMBOL
coef <- 1
volcanoplot(fit.GSE8879, highlight = 10, names = GSE8879_genenames, coef = coef, main = paste("DEGS en comparación ",
    colnames(cont.matrix)[coef], sep = "\n"), cex.main = 0.8, xlim = xlimits, ylim = ylimits)

abline(v = c(-1, 1))

```


Visualización de los perfiles de expresión

Tras seleccionar los genes diferencialmente expresados podemos visualizar las expresiones de cada gen agrupándolas para destacar los genes que se encuentran up o down regulados simultáneamente constituyendo perfiles de expresión.

Hay distintas formas de visualización pero aquí tan sólo se presenta el uso de mapas de color o “Heatmaps.”

En primer lugar seleccionamos los genes a visualizar: Se toman todos aquellos que han resultado diferencialmente expresados en alguna de las tres comparaciones.

Para representar el Heatmap tan sólo necesitamos la matriz de datos resultante.

```{r, warning=TRUE, error=FALSE}
eset_GSE8879_Filtered
require(hgu133a.db)
```


```{r, warning=TRUE, error=FALSE}
probeNames <- rownames(GSE8879_res)
probeNames.selected <- probeNames[sum.GSE8879res.rows != 0]
exprs2cluster <- exprs(eset_GSE8879_Filtered)[probeNames.selected, ]
symbols <- AnnotationDbi::select(hgu133a.db, probeNames.selected,
    columns = "SYMBOL")[, 2]
colnames(exprs2cluster) <- GSE8879_sampleNames
rownames(exprs2cluster) <- symbols
color.map <- function(GSE8879_grupos) {
    if (GSE8879_grupos == "cell type: diagnostic leukemic blasts of early T-cell precursor acute lymphoblastic leukemia (ETP)") {
        c <- "yellow"
    } else {
        if (GSE8879_grupos == "cell type: diagnostic leukemic blasts of T-cell precursor acute lymphoblastic leukemia") {
            c <- "red"
        } else {
            if (GSE8879_grupos == "METPER") {
                c <- "red"
            } else {
                c <- "green"
            }
        }
    }
    return(c)
}

```


```{r, warning=TRUE, error=FALSE}
grupColors <- unlist(lapply(GSE8879_grupos, color.map))
library("gplots")
heatmap.2(exprs2cluster, col=topo.colors(75), scale="none", ColSideColors=grupColors,
          key=TRUE, symkey=FALSE, density.info="none", trace="none", cexRow=0.5)

```


Mapa de colores basado en los genes seleccionados por estar diferencialmente expresados.




# GSE10609



## Selección de genes diferencialmente expresados


```{r, warning=TRUE, error=FALSE}
setwd('C:/Users/Copito/OneDrive/Documentos/Master bioinf y bioest/TFM/datasets/GSE10609/')
load(file = './GSE10609datos.normalizados.Rda')
require(Biobase)
datadir <- "C:/Users/Copito/OneDrive/Documentos/Master bioinf y bioest/TFM/datasets/"
```



```{r, warning=TRUE, error=FALSE}
library(GEOquery)

GSE10609_getGEO <- getGEO("GSE10609", GSEMatrix =TRUE, AnnotGPL=TRUE, destdir = "C:/Users/Copito/OneDrive/Documentos/Master bioinf y bioest/TFM/datasets/GSE10609/" )

GSE10609_getGEO<-GSE10609_getGEO[[1]]


```

```{r, warning=TRUE, error=FALSE}
setwd('C:/Users/Copito/OneDrive/Documentos/Master bioinf y bioest/TFM/datasets/GSE10609/')


colores <- GSE10609_Filtered[["eset"]]@phenoData@data[["colores"]]
grupos <- as.factor(GSE10609_Filtered[["eset"]]@phenoData@data[["grupo"]])
numSamples <- length(GSE10609_Filtered[["eset"]]@phenoData@data[["shortName"]])
sampleNames <- GSE10609_Filtered[["eset"]]@phenoData@data[["shortName"]]


GSE10609_design <- model.matrix(~0 + grupos)
rownames(GSE10609_design) <- sampleNames

colnames(GSE10609_design) <- levels(grupos) # ¡cuidado! ver si está bien
head(GSE10609_design)

```

Las comparaciones que nos interesan son:

-¿Existe desregulación de las RBP entre grupos? Sin interacciones:

HOX11-HOX11L2

HOX11-HOXA

HOX11-LMO2

HOX11-TAL1

Y lo mismo con el resto entre ellos.



-¿Hay desregulación entre los HOX y alguno de los demás?

(HOX11 + HOX11L2) - HOXA

(HOX11 + HOX11L2) - LMO2

(HOX11 + HOX11L2) - TAL1

Ya que, según la bibliografía, HOX11 y HOX11L2 están estrechamente relacionados.


```{r, warning=TRUE, error=FALSE}

library(limma)
cont.matrix <- makeContrasts(grupo_HOX = HOX11 - HOX11L2,
                             grupo_HOX11HOXA = HOX11 - HOXA,
                             grup_HOX11LMO2 = HOX11 - LMO2,
                             grup_HOX11TAL1 = HOX11 - TAL1,
                             
                             grup_HOX11L2HOXA = HOX11L2 - HOXA,
                             grup_HOX11L2LMO2 = HOX11L2 - LMO2,
                             grup_HOX11L2TAL1 = HOX11L2 - TAL1,
                             
                             grup_HOXALMO2 = HOXA - LMO2,
                             grup_HOXATAL1 = HOXA - TAL1,

                             grup_LMO2TAL1 = LMO2 - TAL1,
                             
                             grup_HOX11_HOX11L2HOXA = (HOX11+HOX11L2)/2 - HOXA,
                             grup_HOX11_HOX11L2LMO2 = (HOX11+HOX11L2)/2 - LMO2,
                             grup_HOX11_HOX11L2TAL1 = (HOX11+HOX11L2)/2 - TAL1,
                             
                             levels = GSE10609_design)
print(cont.matrix)

```



```{r, warning=TRUE, error=FALSE}
# save(GSE8879_Filtered, eset_GSE8879_Filtered,
     # GSE8879_geneIds, file =
       # "C:/Users/Copito/OneDrive/Documentos/Master bioinf y bioest/TFM/datasets/GSE10609/datos.normalizados.Rda")


library(limma)
fit <- lmFit(eset_GSE10609_Filtered, GSE10609_design)
fit.GSE10609 <- contrasts.fit(fit, cont.matrix)
fit.GSE10609 <- eBayes(fit.GSE10609)
head(rownames(fit.GSE10609))

```

```{r, warning=TRUE, error=FALSE}
colnames(cont.matrix)
```


```{r, warning=TRUE, error=FALSE}
topTab_GSE10609_HOX <- topTable(fit.GSE10609, number = nrow(fit.GSE10609), coef = "grupo_HOX",
    adjust = "fdr")

topTab_GSE10609_HOX11HOXA <- topTable(fit.GSE10609, number = nrow(fit.GSE10609), coef = "grupo_HOX11HOXA",
    adjust = "fdr")

topTab_GSE10609_HOX11LMO2 <- topTable(fit.GSE10609, number = nrow(fit.GSE10609), coef = "grup_HOX11LMO2",
    adjust = "fdr")

topTab_GSE10609_HOX11TAL1 <- topTable(fit.GSE10609, number = nrow(fit.GSE10609), coef = "grup_HOX11TAL1",
    adjust = "fdr")

topTab_GSE10609_HOX11L2HOXA <- topTable(fit.GSE10609, number = nrow(fit.GSE10609), coef = "grup_HOX11L2HOXA",
    adjust = "fdr")

topTab_GSE10609_HOX11L2LMO2 <- topTable(fit.GSE10609, number = nrow(fit.GSE10609), coef = "grup_HOX11L2LMO2",
    adjust = "fdr")


topTab_GSE10609_HOX11L2TAL1 <- topTable(fit.GSE10609, number = nrow(fit.GSE10609), coef = "grup_HOX11L2TAL1",
    adjust = "fdr")


topTab_GSE10609_HOXALMO2 <- topTable(fit.GSE10609, number = nrow(fit.GSE10609), coef = "grup_HOXALMO2",
    adjust = "fdr")


topTab_GSE10609_HOXATAL1 <- topTable(fit.GSE10609, number = nrow(fit.GSE10609), coef = "grup_HOXATAL1",
    adjust = "fdr")


topTab_GSE10609_LMO2TAL1 <- topTable(fit.GSE10609, number = nrow(fit.GSE10609), coef = "grup_LMO2TAL1",
    adjust = "fdr")


topTab_GSE10609_HOX11HOX11L2HOXA <- topTable(fit.GSE10609, number = nrow(fit.GSE10609),
                                        coef = "grup_HOX11_HOX11L2HOXA",
                                        adjust = "fdr")


topTab_GSE10609_HOX11HOX11L2LMO2 <- topTable(fit.GSE10609, number = nrow(fit.GSE10609),
                                        coef = "grup_HOX11_HOX11L2LMO2",
                                        adjust = "fdr")

topTab_GSE10609_HOX11HOX11L2TAL1 <- topTable(fit.GSE10609, number = nrow(fit.GSE10609),
                                        coef = "grup_HOX11_HOX11L2TAL1",
                                        adjust = "fdr")


head(topTab_GSE10609_HOX11L2HOXA)
```

topTab_GSE10609_HOX, topTab_GSE10609_HOX11HOXA, topTab_GSE10609_HOX11LMO2, topTab_GSE10609_HOX11TAL1, topTab_GSE10609_HOX11L2HOXA, topTab_GSE10609_HOX11L2LMO2, topTab_GSE10609_HOX11L2TAL1, topTab_GSE10609_HOXALMO2, topTab_GSE10609_HOXATAL1, topTab_GSE10609_LMO2TAL1, topTab_GSE10609_HOX11HOX11L2HOXA, topTab_GSE10609_HOX11HOX11L2LMO2, topTab_GSE10609_HOX11HOX11L2TAL1.

```{r, warning=TRUE, error=FALSE}
library(dplyr)
anotaTopTab <- function(topTab) {
    topTab_Anot <- topTab %>%
        mutate(PROBEID = rownames(topTab)) %>%
        merge(GSE10609_geneIds, "PROBEID") %>%
        arrange(adj.P.Val)
    return(topTab_Anot)
}

topTab_GSE10609_HOX_Anot <- anotaTopTab(topTab_GSE10609_HOX)

topTab_GSE10609_HOX11HOXA_Anot <- anotaTopTab(topTab_GSE10609_HOX11HOXA)



topTab_GSE10609_HOX11LMO2_Anot <- anotaTopTab(topTab_GSE10609_HOX11LMO2)

topTab_GSE10609_HOX11TAL1_Anot <- anotaTopTab(topTab_GSE10609_HOX11TAL1)


topTab_GSE10609_HOX11L2HOXA_Anot <- anotaTopTab(topTab_GSE10609_HOX11L2HOXA)

topTab_GSE10609_HOX11L2LMO2_Anot <- anotaTopTab(topTab_GSE10609_HOX11L2LMO2)


topTab_GSE10609_HOX11L2TAL1_Anot <- anotaTopTab(topTab_GSE10609_HOX11L2TAL1)

topTab_GSE10609_HOXALMO2_Anot <- anotaTopTab(topTab_GSE10609_HOXALMO2)


topTab_GSE10609_HOXATAL1_Anot <- anotaTopTab(topTab_GSE10609_HOXATAL1)

topTab_GSE10609_LMO2TAL1_Anot <- anotaTopTab(topTab_GSE10609_LMO2TAL1)

topTab_GSE10609_HOX11HOX11L2HOXA_Anot <- anotaTopTab(topTab_GSE10609_HOX11HOX11L2HOXA)

topTab_GSE10609_HOX11HOX11L2LMO2_Anot <- anotaTopTab(topTab_GSE10609_HOX11HOX11L2LMO2)

topTab_GSE10609_HOX11HOX11L2TAL1_Anot <- anotaTopTab(topTab_GSE10609_HOX11HOX11L2TAL1)




head(topTab_GSE10609_HOXATAL1_Anot)
```

Comparaciones múltiples


```{r, warning=TRUE, error=FALSE}
GSE10609_res <- decideTests(fit.GSE10609, method = "separate", adjust.method = "fdr", p.value = 0.05,
    lfc = 0)

```

Para resumir dicho análisis podemos contar qué filas tienen como mínimo una celda distinta de cero:



```{r, warning=TRUE, error=FALSE}
sum.GSE10609res.rows <- apply(abs(GSE10609_res), 1, sum)
GSE10609_res.selected <- GSE10609_res[sum.GSE10609res.rows != 0, ]
print(summary(GSE10609_res))
```


Si ahora visualizamos los resultados de cada comparación por separado, podemos observar como los volcano-plots concuerdan con la tabla anterior


topTab_GSE10609_HOX_Anot, topTab_GSE10609_HOX11HOXA_Anot, topTab_GSE10609_HOX11LMO2_Anot, topTab_GSE10609_HOX11TAL1_Anot, topTab_GSE10609_HOX11L2HOXA_Anot, topTab_GSE10609_HOX11L2LMO2_Anot, topTab_GSE10609_HOX11L2TAL1_Anot, topTab_GSE10609_HOXALMO2_Anot, topTab_GSE10609_HOXATAL1_Anot, topTab_GSE10609_LMO2TAL1_Anot, topTab_GSE10609_HOX11HOX11L2HOXA_Anot, topTab_GSE10609_HOX11HOX11L2LMO2_Anot, topTab_GSE10609_HOX11HOX11L2TAL1_Anot.


```{r, warning=TRUE, error=FALSE}
xlimits <- c(-3, +3)
ylimits <- c(0, 8)
coef <- 1

par(mfrow=c(1,2))

GSE10609_genenames <- topTab_GSE10609_HOXATAL1_Anot$SYMBOL

volcanoplot(fit.GSE10609, highlight = 10, names = GSE10609_genenames, coef = coef, main = paste("DEGS en comparación ",
    colnames(cont.matrix)[coef], sep = "\n"), cex.main = 0.8, xlim = xlimits, ylim = ylimits)

abline(v = c(-1, 1))

GSE10609_genenames <- topTab_GSE10609_HOX11HOXA_Anot$SYMBOL

volcanoplot(fit.GSE10609, highlight = 10, names = GSE10609_genenames, coef = coef, main = paste("DEGS en comparación ",
    colnames(cont.matrix)[coef], sep = "\n"), cex.main = 0.8, xlim = xlimits, ylim = ylimits)

abline(v = c(-1, 1))


GSE10609_genenames <- topTab_GSE10609_HOX11LMO2_Anot$SYMBOL

volcanoplot(fit.GSE10609, highlight = 10, names = GSE10609_genenames, coef = coef, main = paste("DEGS en comparación ",
    colnames(cont.matrix)[coef], sep = "\n"), cex.main = 0.8, xlim = xlimits, ylim = ylimits)

abline(v = c(-1, 1))

GSE10609_genenames <- topTab_GSE10609_HOX11TAL1_Anot$SYMBOL

volcanoplot(fit.GSE10609, highlight = 10, names = GSE10609_genenames, coef = coef, main = paste("DEGS en comparación ",
    colnames(cont.matrix)[coef], sep = "\n"), cex.main = 0.8, xlim = xlimits, ylim = ylimits)

abline(v = c(-1, 1))


GSE10609_genenames <- topTab_GSE10609_HOX11L2HOXA_Anot$SYMBOL

volcanoplot(fit.GSE10609, highlight = 10, names = GSE10609_genenames, coef = coef, main = paste("DEGS en comparación ",
    colnames(cont.matrix)[coef], sep = "\n"), cex.main = 0.8, xlim = xlimits, ylim = ylimits)

abline(v = c(-1, 1))

GSE10609_genenames <- topTab_GSE10609_HOX11L2LMO2_Anot$SYMBOL

volcanoplot(fit.GSE10609, highlight = 10, names = GSE10609_genenames, coef = coef, main = paste("DEGS en comparación ",
    colnames(cont.matrix)[coef], sep = "\n"), cex.main = 0.8, xlim = xlimits, ylim = ylimits)

abline(v = c(-1, 1))


GSE10609_genenames <- topTab_GSE10609_HOX11L2TAL1_Anot$SYMBOL

volcanoplot(fit.GSE10609, highlight = 10, names = GSE10609_genenames, coef = coef, main = paste("DEGS en comparación ",
    colnames(cont.matrix)[coef], sep = "\n"), cex.main = 0.8, xlim = xlimits, ylim = ylimits)

abline(v = c(-1, 1))

GSE10609_genenames <- topTab_GSE10609_HOXALMO2_Anot$SYMBOL

volcanoplot(fit.GSE10609, highlight = 10, names = GSE10609_genenames, coef = coef, main = paste("DEGS en comparación ",
    colnames(cont.matrix)[coef], sep = "\n"), cex.main = 0.8, xlim = xlimits, ylim = ylimits)

abline(v = c(-1, 1))


GSE10609_genenames <- topTab_GSE10609_HOXATAL1_Anot$SYMBOL

volcanoplot(fit.GSE10609, highlight = 10, names = GSE10609_genenames, coef = coef, main = paste("DEGS en comparación ",
    colnames(cont.matrix)[coef], sep = "\n"), cex.main = 0.8, xlim = xlimits, ylim = ylimits)

abline(v = c(-1, 1))


GSE10609_genenames <- topTab_GSE10609_LMO2TAL1_Anot$SYMBOL

volcanoplot(fit.GSE10609, highlight = 10, names = GSE10609_genenames, coef = coef, main = paste("DEGS en comparación ",
    colnames(cont.matrix)[coef], sep = "\n"), cex.main = 0.8, xlim = xlimits, ylim = ylimits)

abline(v = c(-1, 1))


GSE10609_genenames <- topTab_GSE10609_HOX11HOX11L2HOXA_Anot$SYMBOL

volcanoplot(fit.GSE10609, highlight = 10, names = GSE10609_genenames, coef = coef, main = paste("DEGS en comparación ",
    colnames(cont.matrix)[coef], sep = "\n"), cex.main = 0.8, xlim = xlimits, ylim = ylimits)

abline(v = c(-1, 1))

GSE10609_genenames <- topTab_GSE10609_HOX11HOX11L2LMO2_Anot$SYMBOL

volcanoplot(fit.GSE10609, highlight = 10, names = GSE10609_genenames, coef = coef, main = paste("DEGS en comparación ",
    colnames(cont.matrix)[coef], sep = "\n"), cex.main = 0.8, xlim = xlimits, ylim = ylimits)

abline(v = c(-1, 1))

par(mfrow=c(1,1))


GSE10609_genenames <- topTab_GSE10609_HOX11HOX11L2TAL1_Anot$SYMBOL

volcanoplot(fit.GSE10609, highlight = 10, names = GSE10609_genenames, coef = coef, main = paste("DEGS en comparación ",
    colnames(cont.matrix)[coef], sep = "\n"), cex.main = 0.8, xlim = xlimits, ylim = ylimits)

abline(v = c(-1, 1))






```

```{r, warning=TRUE, error=FALSE}
xlimits <- c(-3, +3)
ylimits <- c(0, 8)
GSE10609_genenames <- c(topTab_GSE10609_HOX_Anot$SYMBOL, topTab_GSE10609_HOX11HOXA_Anot$SYMBOL,
                        topTab_GSE10609_HOX11LMO2_Anot$SYMBOL,
                        topTab_GSE10609_HOX11TAL1_Anot$SYMBOL,
                        topTab_GSE10609_HOX11L2HOXA_Anot$SYMBOL,
                        topTab_GSE10609_HOX11L2LMO2_Anot$SYMBOL,
                        topTab_GSE10609_HOX11L2TAL1_Anot$SYMBOL,
                        topTab_GSE10609_HOXALMO2_Anot$SYMBOL, topTab_GSE10609_HOXATAL1_Anot$SYMBOL,
                        topTab_GSE10609_LMO2TAL1_Anot$SYMBOL,
                        topTab_GSE10609_HOX11HOX11L2HOXA_Anot$SYMBOL,
                        topTab_GSE10609_HOX11HOX11L2LMO2_Anot$SYMBOL,
                        topTab_GSE10609_HOX11HOX11L2TAL1_Anot$SYMBOL)

volcanoplot(fit.GSE10609, highlight = 10, names = GSE10609_genenames, main = paste("DEGS en comparación ",
    colnames(cont.matrix)[coef], sep = "\n"), cex.main = 0.8, xlim = xlimits, ylim = ylimits)

abline(v = c(-1, 1))

```


Visualización de los perfiles de expresión


```{r, warning=TRUE, error=FALSE}
eset_GSE10609_Filtered
require(hgu133plus2.db)
```


```{r, warning=TRUE, error=FALSE}
probeNames <- rownames(GSE10609_res)
probeNames.selected <- probeNames[sum.GSE10609res.rows != 0]
exprs2cluster <- exprs(eset_GSE10609_Filtered)[probeNames.selected, ]
symbols <- AnnotationDbi::select(hgu133plus2.db, probeNames.selected,
    columns = "SYMBOL")[, 2]
colnames(exprs2cluster) <- sampleNames
rownames(exprs2cluster) <- symbols
color.map = colores

```


```{r, warning=TRUE, error=FALSE}

heatmap(exprs2cluster, col = rainbow(100), ColSideColors = colores, cexCol = 0.9)

```


```{r, warning=TRUE, error=FALSE}
heatmap.2(exprs2cluster, col=topo.colors(75), scale="none", ColSideColors=colores,
          key=TRUE, symkey=FALSE, density.info="none", trace="none", cexRow=0.5)
```
          
Mapa de colores basado en los genes seleccionados por estar diferencialmente expresados.



```{r, warning=TRUE, error=FALSE}
ls()
save(topTab_GSE10609_HOX_Anot, topTab_GSE10609_HOX11HOX11L2HOXA_Anot,
     topTab_GSE10609_HOX11HOX11L2LMO2_Anot, topTab_GSE10609_HOX11HOX11L2TAL1_Anot,
     topTab_GSE10609_HOX11HOXA_Anot, topTab_GSE10609_HOX11L2HOXA_Anot,
     topTab_GSE10609_HOX11L2LMO2_Anot, topTab_GSE10609_HOX11L2TAL1_Anot,
     topTab_GSE10609_HOX11LMO2_Anot, topTab_GSE10609_HOX11TAL1_Anot,
     topTab_GSE10609_HOXALMO2_Anot, topTab_GSE10609_HOXATAL1_Anot, topTab_GSE10609_LMO2TAL1_Anot, 
     file = 'C:/Users/Copito/OneDrive/Documentos/Master bioinf y bioest/TFM/datasets/GSE10609/GSE10609topTabs_Anot')
```


# GSE14618_GPL570

## Selección de genes diferencialmente expresados


```{r, warning=TRUE, error=FALSE}
setwd('C:/Users/Copito/OneDrive/Documentos/Master bioinf y bioest/TFM/datasets/GSE14618/')

# setwd('datosyeso/')

# setwd('C:/Users/laura/OneDrive/Documentos/Cris/')

load(file = 'C:/Users/Copito/OneDrive/Documentos/Master bioinf y bioest/TFM/datasets/GSE14618/GSE14618_GPL570datos.normalizados.Rda')

# load(file = 'C:/Users/laura/OneDrive/Documentos/Cris/GSE14618_GPL570datos.normalizados.Rda')

require(Biobase)

# datadir <- "datosyeso/"

# datadir <- "C:/Users/laura/OneDrive/Documentos/Cris/"

datadir <- "C:/Users/Copito/OneDrive/Documentos/Master bioinf y bioest/TFM/datasets/GSE14618/"
```



```{r, warning=TRUE, error=FALSE}
library(GEOquery)

GSE14618_getGEO <- getGEO("GSE14618", GSEMatrix =TRUE, AnnotGPL=TRUE, destdir = datadir)

# GSE8879_getGEO <- getGEO("GSE8879", GSEMatrix =TRUE, AnnotGPL=TRUE, destdir = "C:/Users/Copito/OneDrive/Documentos/Master bioinf y bioest/TFM/datasets/GSE8879/" )

GSE14618_GPL570<-GSE14618_getGEO[[1]]


GSE14618_GPL570_sampleNames <- substring(GSE14618_GPL570@phenoData@data[["title"]], 1, 3)


a<-substring((GSE14618_GPL570@phenoData@data[["description"]])[1:6], 1, 2)

b<-substring((GSE14618_GPL570@phenoData@data[["description"]])[7:20], 1, 1)

c<-substring((GSE14618_GPL570@phenoData@data[["description"]])[21:50], 1, 1)

d<- c(a,b,c)

cols=c()

for (valor in d){
  if (valor=="NR"){cols=append(cols, 'green2')}
  else if (valor=="F"){cols=append(cols, 'goldenrod')}
  else if (valor=="C"){cols=append(cols, 'deeppink')}
}
 

GSE14618_GPL570_grupos <- d


(sampleInfo_GPL570 <- pData(GSE14618_GPL570))[1:10,]
```


```{r, warning=TRUE, error=FALSE}

GSE14618_GPL570_design <- model.matrix(~0 + as.factor(GSE14618_GPL570_grupos))
rownames(GSE14618_GPL570_design) <- GSE14618_GPL570_sampleNames

colnames(GSE14618_GPL570_design) <- c("C", 'F_g', 'NR')
head(GSE14618_GPL570_design)

```

F_g es F.

Las comparaciones que nos interesan son:

-¿Existe desregulación de las RBP entre grupos? No hay interacciones

C - F_g

C - NR

F - NR

```{r, warning=TRUE, error=FALSE}

library(limma)
cont.matrix <- makeContrasts(C_F = C - F_g,
                             C_NR = C - NR,
                             F_NR = F_g - NR,
                             levels = GSE14618_GPL570_design)
print(cont.matrix)

```

Ahora estimaremos el modelo.


```{r, warning=TRUE, error=FALSE}
# save(GSE8879_Filtered, eset_GSE8879_Filtered,
     # GSE8879_geneIds, file =
       # "C:/Users/Copito/OneDrive/Documentos/Master bioinf y bioest/TFM/datasets/GSE8879/datos.normalizados.Rda")

library(limma)
fit <- lmFit(eset_GSE14618_GPL570_Filtered, GSE14618_GPL570_design)
fit.GSE14618_GPL570 <- contrasts.fit(fit, cont.matrix)
fit.GSE14618_GPL570 <- eBayes(fit.GSE14618_GPL570)
head(rownames(fit.GSE14618_GPL570))

```

La función topTable genera para cada contraste una lista de genes ordenados de mas a menos diferencialmente expresados.

C_F C_NR F_NR

```{r, warning=TRUE, error=TRUE}
topTab_GSE14618_GPL570_CF <- topTable(fit.GSE14618_GPL570,
                           number = nrow(fit.GSE14618_GPL570), coef = "C_F",
                           adjust = "fdr")

topTab_GSE14618_GPL570_CNR <- topTable(fit.GSE14618_GPL570,
                                       number = nrow(fit.GSE14618_GPL570), coef = "C_NR",
    adjust = "fdr")

topTab_GSE14618_GPL570_FNR <- topTable(fit.GSE14618_GPL570,
                                       number = nrow(fit.GSE14618_GPL570), coef = "F_NR",
    adjust = "fdr")


head(topTab_GSE14618_GPL570_CNR)
```


Para identificar los genes más diferencialmente expresados podemos utilizar la lista de anotaciones y añadir algunas a las topTables.


topTab_GSE14618_GPL570_CF, topTab_GSE14618_GPL570_CNR y topTab_GSE14618_GPL570_FNR.

```{r, warning=TRUE, error=TRUE}
library(dplyr)
anotaTopTab <- function(topTab) {
    topTab_Anot <- topTab %>%
        mutate(PROBEID = rownames(topTab)) %>%
        merge(GSE14618_GPL570__geneIds, "PROBEID") %>%
        arrange(adj.P.Val)
    return(topTab_Anot)
}
topTab_GSE14618_GPL570_CFAnot <- anotaTopTab(topTab_GSE14618_GPL570_CF)

topTab_GSE14618_GPL570_CNRAnot <- anotaTopTab(topTab_GSE14618_GPL570_CNR)

topTab_GSE14618_GPL570_FNRAnot <- anotaTopTab(topTab_GSE14618_GPL570_FNR)


head(topTab_GSE14618_GPL570_CNRAnot)
```

Comparaciones múltiples. Con fit.GSE14618_GPL570.


```{r, warning=TRUE, error=FALSE}
GSE14618_GPL570_res <- decideTests(fit.GSE14618_GPL570,
                                   method = "separate", adjust.method = "fdr",
                                   p.value = 0.05, lfc = 0)
```

Para resumir dicho análisis podemos contar qué filas tienen como mínimo una celda distinta de cero:



```{r, warning=TRUE, error=FALSE}
sum.GSE14618_GPL570res.rows <- apply(abs(GSE14618_GPL570_res), 1, sum)
GSE14618_GPL570_res.selected <- GSE14618_GPL570_res[sum.GSE14618_GPL570res.rows != 0, ]
print(summary(GSE14618_GPL570_res))
```


Si ahora visualizamos los resultados de cada comparación por separado, podemos observar como los volcano-plots concuerdan con la tabla anterior

topTab_GSE14618_GPL570_CFAnot, topTab_GSE14618_GPL570_CNRAnot y topTab_GSE14618_GPL570_FNRAnot.

```{r, warning=TRUE, error=FALSE}
xlimits <- c(-3, +3)
ylimits <- c(0, 4)

GSE14618_GPL570_genenames <- c(topTab_GSE14618_GPL570_CFAnot$SYMBOL,
                               topTab_GSE14618_GPL570_CNRAnot$SYMBOL,
                               topTab_GSE14618_GPL570_FNRAnot$SYMBOL)

volcanoplot(fit.GSE14618_GPL570, highlight = 10, names = GSE14618_GPL570_genenames, main = "GSE14618 GPL570", cex.main = 0.8, xlim = xlimits, ylim = ylimits)

abline(v = c(-1, 1))

```

```{r, warning=TRUE, error=FALSE}
xlimits <- c(-3, +3)
ylimits <- c(0, 8)
GSE14618_GPL570_genenames <- topTab_GSE14618_GPL570_CFAnot$SYMBOL
coef <- 1

par(mfrow=c(1,2))

volcanoplot(fit.GSE14618_GPL570, highlight = 10, names = GSE14618_GPL570_genenames, coef = coef, main = paste("DEGS en comparación ",
    colnames(cont.matrix)[coef], sep = "\n"), cex.main = 0.8, xlim = xlimits, ylim = ylimits)

abline(v = c(-1, 1))

GSE14618_GPL570_genenames <- topTab_GSE14618_GPL570_CNRAnot$SYMBOL

volcanoplot(fit.GSE14618_GPL570, highlight = 10, names = GSE14618_GPL570_genenames, coef = coef, main = paste("DEGS en comparación ",
    colnames(cont.matrix)[coef], sep = "\n"), cex.main = 0.8, xlim = xlimits, ylim = ylimits)

abline(v = c(-1, 1))


par(mfrow=c(1,1))

GSE14618_GPL570_genenames <- topTab_GSE14618_GPL570_FNRAnot$SYMBOL

volcanoplot(fit.GSE14618_GPL570, highlight = 10, names = GSE14618_GPL570_genenames, coef = coef, main = paste("DEGS en comparación ",
    colnames(cont.matrix)[coef], sep = "\n"), cex.main = 0.8, xlim = xlimits, ylim = ylimits)

abline(v = c(-1, 1))

```

Visualización de los perfiles de expresión



```{r, warning=TRUE, error=FALSE}
eset_GSE14618_GPL570_Filtered
require(hgu133plus2.db)
```


```{r, warning=TRUE, error=FALSE}
probeNames <- rownames(GSE14618_GPL570_res)
probeNames.selected <- probeNames[sum.GSE14618_GPL570res.rows != 0]
exprs2cluster <- exprs(eset_GSE14618_GPL570_Filtered)[probeNames.selected, ]
symbols <- AnnotationDbi::select(hgu133plus2.db, probeNames.selected,
    columns = "SYMBOL")[, 2]
colnames(exprs2cluster) <- GSE14618_GPL570_sampleNames
rownames(exprs2cluster) <- symbols
color.map <- function(GSE14618_GPL570_grupos) {
    if (GSE14618_GPL570_grupos == "NR") {
        c <- "yellow"
    } else {
        if (GSE14618_GPL570_grupos == "F") {
            c <- "red"
        } else {
            if (GSE14618_GPL570_grupos == "C") {
                c <- "blue"
            } else {
                c <- "green"
            }
        }
    }
    return(c)
}

```


```{r, warning=TRUE, error=FALSE}
grupColors <- unlist(lapply(GSE14618_GPL570_grupos, color.map))
heatmap(exprs2cluster, col = rainbow(100), ColSideColors = grupColors, cexCol = 0.9)

```

```{r, warning=TRUE, error=FALSE}
library("gplots")
heatmap.2(exprs2cluster, col=topo.colors(75), scale="none", ColSideColors=grupColors,
          key=TRUE, symkey=FALSE, density.info="none", trace="none", cexRow=0.5)

```

Mapa de colores basado en los genes seleccionados por estar diferencialmente expresados.


```{r, warning=TRUE, error=FALSE}

# save(topTab_GSE14618_GPL570_CFAnot, anotaTopTab(topTab_GSE14618_GPL570_CNR), topTab_GSE14618_GPL570_FNRAnot,
     # file = 'C:/Users/Copito/OneDrive/Documentos/Master bioinf y bioest/TFM/datasets/GSE10609/topTabs_Anot'


save(topTab_GSE14618_GPL570_CFAnot, topTab_GSE14618_GPL570_CNRAnot, topTab_GSE14618_GPL570_FNRAnot,
     file = 'C:/Users/laura/OneDrive/Documentos/Cris/topTabs_Anot.RData')

```

# GSE14618_GPL96

## Selección de genes diferencialmente expresados


```{r, warning=TRUE, error=FALSE}
setwd('C:/Users/Copito/OneDrive/Documentos/Master bioinf y bioest/TFM/datasets/GSE14618/')

# setwd('datosyeso/')

# setwd('C:/Users/laura/OneDrive/Documentos/Cris/')

load(file = 'C:/Users/Copito/OneDrive/Documentos/Master bioinf y bioest/TFM/datasets/GSE14618/GSE14618_GPL96datos.normalizados.Rda')

# load(file = 'C:/Users/laura/OneDrive/Documentos/Cris/GSE14618_GPL96datos.normalizados.Rda')

require(Biobase)

# datadir <- "datosyeso/"

# datadir <- "C:/Users/laura/OneDrive/Documentos/Cris/"
datadir <- "C:/Users/Copito/OneDrive/Documentos/Master bioinf y bioest/TFM/datasets/GSE14618/"
```



```{r, warning=TRUE, error=FALSE}
library(GEOquery)

# GSE14618_getGEO <- getGEO("GSE14618", GSEMatrix =TRUE, AnnotGPL=TRUE, destdir = datadir)

GSE14618_getGEO <- getGEO("GSE14618", GSEMatrix =TRUE, AnnotGPL=TRUE, destdir = "C:/Users/Copito/OneDrive/Documentos/Master bioinf y bioest/TFM/datasets/GSE8879/" )

GSE14618_GPL96<-GSE14618_getGEO[[2]]


GSE14618_GPL96_sampleNames <- substring(GSE14618_GPL96@phenoData@data[["title"]], 1, 3)



a<-substring((GSE14618_GPL96@phenoData@data[["description"]])[1], 1, 2)

b<-substring((GSE14618_GPL96@phenoData@data[["description"]])[2:42], 1, 1)

d<- c(a,b)

cols=c()

for (valor in d){
  if (valor=="NR"){cols=append(cols, 'green2')}
  else if (valor=="F"){cols=append(cols, 'goldenrod')}
  else if (valor=="C"){cols=append(cols, 'gray')}
}
 

GSE14618_GPL96_grupos <- d


(sampleInfo_GPL96 <- pData(GSE14618_GPL96))[1:10,]
```


```{r, warning=TRUE, error=FALSE}

GSE14618_GPL96_design <- model.matrix(~0 + as.factor(GSE14618_GPL96_grupos))
rownames(GSE14618_GPL96_design) <- GSE14618_GPL96_sampleNames

colnames(GSE14618_GPL96_design) <- c("C", 'F_g', 'NR')
head(GSE14618_GPL96_design)

```

F_g es F.

Las comparaciones que nos interesan son:

-¿Existe desregulación de las RBP entre grupos? No hay interacciones

C - F_g

C - NR

F - NR

```{r, warning=TRUE, error=FALSE}

library(limma)
cont.matrix <- makeContrasts(C_F = C - F_g,
                             C_NR = C - NR,
                             F_NR = F_g - NR,
                             levels = GSE14618_GPL96_design)
print(cont.matrix)

```

Ahora estimaremos el modelo.


```{r, warning=TRUE, error=FALSE}
# save(GSE8879_Filtered, eset_GSE8879_Filtered,
     # GSE8879_geneIds, file =
       # "C:/Users/Copito/OneDrive/Documentos/Master bioinf y bioest/TFM/datasets/GSE8879/datos.normalizados.Rda")

library(limma)
fit <- lmFit(eset_GSE14618_GPL96_Filtered, GSE14618_GPL96_design)
fit.GSE14618_GPL96 <- contrasts.fit(fit, cont.matrix)
fit.GSE14618_GPL96 <- eBayes(fit.GSE14618_GPL96)
head(rownames(fit.GSE14618_GPL96))

```

La función topTable genera para cada contraste una lista de genes ordenados de mas a menos diferencialmente expresados.

C_F C_NR F_NR

```{r, warning=TRUE, error=TRUE}
topTab_GSE14618_GPL96_CF <- topTable(fit.GSE14618_GPL96,
                           number = nrow(fit.GSE14618_GPL96), coef = "C_F",
                           adjust = "fdr")

topTab_GSE14618_GPL96_CNR <- topTable(fit.GSE14618_GPL96,
                                       number = nrow(fit.GSE14618_GPL96), coef = "C_NR",
    adjust = "fdr")

topTab_GSE14618_GPL96_FNR <- topTable(fit.GSE14618_GPL96,
                                       number = nrow(fit.GSE14618_GPL96), coef = "F_NR",
    adjust = "fdr")


head(topTab_GSE14618_GPL96_CNR)
```


Para identificar los genes más diferencialmente expresados podemos utilizar la lista de anotaciones y añadir algunas a las topTables.


topTab_GSE14618_GPL570_CF, topTab_GSE14618_GPL570_CNR y topTab_GSE14618_GPL570_FNR.

```{r, warning=TRUE, error=TRUE}
library(dplyr)
anotaTopTab <- function(topTab) {
    topTab_Anot <- topTab %>%
        mutate(PROBEID = rownames(topTab)) %>%
        merge(GSE14618_GPL96__geneIds, "PROBEID") %>%
        arrange(adj.P.Val)
    return(topTab_Anot)
}
topTab_GSE14618_GPL96_CFAnot <- anotaTopTab(topTab_GSE14618_GPL96_CF)

topTab_GSE14618_GPL96_CNRAnot <- anotaTopTab(topTab_GSE14618_GPL96_CNR)

topTab_GSE14618_GPL96_FNRAnot <- anotaTopTab(topTab_GSE14618_GPL96_FNR)


head(topTab_GSE14618_GPL96_CNRAnot)
```

Comparaciones múltiples. Con fit.GSE14618_GPL570.


```{r, warning=TRUE, error=FALSE}
GSE14618_GPL96_res <- decideTests(fit.GSE14618_GPL96,
                                   method = "separate", adjust.method = "fdr",
                                   p.value = 0.05, lfc = 0)
```

Para resumir dicho análisis podemos contar qué filas tienen como mínimo una celda distinta de cero:



```{r, warning=TRUE, error=FALSE}
sum.GSE14618_GPL96res.rows <- apply(abs(GSE14618_GPL96_res), 1, sum)
GSE14618_GPL96_res.selected <- GSE14618_GPL96_res[sum.GSE14618_GPL96res.rows != 0, ]
print(summary(GSE14618_GPL96_res))
```


Si ahora visualizamos los resultados de cada comparación por separado, podemos observar como los volcano-plots concuerdan con la tabla anterior

topTab_GSE14618_GPL96_CFAnot, topTab_GSE14618_GPL96_CNRAnot y topTab_GSE14618_GPL96_FNRAnot.

```{r, warning=TRUE, error=FALSE}
xlimits <- c(-3, +3)
ylimits <- c(0, 8)
GSE14618_GPL96_genenames <- topTab_GSE14618_GPL96_CFAnot$SYMBOL
coef <- 1

par(mfrow=c(1,2))

volcanoplot(fit.GSE14618_GPL96, highlight = 10, names = GSE14618_GPL96_genenames, coef = coef, main = paste("DEGS en comparación ",
    colnames(cont.matrix)[coef], sep = "\n"), cex.main = 0.8, xlim = xlimits, ylim = ylimits)

abline(v = c(-1, 1))

GSE14618_GPL96_genenames <- topTab_GSE14618_GPL96_CNRAnot$SYMBOL

volcanoplot(fit.GSE14618_GPL96, highlight = 10, names = GSE14618_GPL96_genenames, coef = coef, main = paste("DEGS en comparación ",
    colnames(cont.matrix)[coef], sep = "\n"), cex.main = 0.8, xlim = xlimits, ylim = ylimits)

abline(v = c(-1, 1))


par(mfrow=c(1,1))

GSE14618_GPL96_genenames <- topTab_GSE14618_GPL96_FNRAnot$SYMBOL

volcanoplot(fit.GSE14618_GPL96, highlight = 10, names = GSE14618_GPL96_genenames, coef = coef, main = paste("DEGS en comparación ",
    colnames(cont.matrix)[coef], sep = "\n"), cex.main = 0.8, xlim = xlimits, ylim = ylimits)

abline(v = c(-1, 1))

```



```{r, warning=TRUE, error=FALSE}
xlimits <- c(-1.5, +1.5)
ylimits <- c(0, 4)

coef <- 1

GSE14618_GPL96_genenames <- c(topTab_GSE14618_GPL96_CFAnot$SYMBOL,
                              topTab_GSE14618_GPL96_CNRAnot$SYMBOL,
                              topTab_GSE14618_GPL96_FNRAnot$SYMBOL)

volcanoplot(fit.GSE14618_GPL96, highlight = 10, names = GSE14618_GPL96_genenames, main = 'GSE14618 GPL96', cex.main = 0.8, xlim = xlimits, ylim = ylimits)

abline(v = c(-1, 1))

```


Visualización de los perfiles de expresión



```{r, warning=TRUE, error=FALSE}
eset_GSE14618_GPL96_Filtered
require(hgu133a.db)
```


```{r, warning=TRUE, error=FALSE}
probeNames <- rownames(GSE14618_GPL96_res)
probeNames.selected <- probeNames[sum.GSE14618_GPL96res.rows != 0]
exprs2cluster <- exprs(eset_GSE14618_GPL96_Filtered)[probeNames.selected, ]
symbols <- AnnotationDbi::select(hgu133a.db, probeNames.selected,
    columns = "SYMBOL")[, 2]
colnames(exprs2cluster) <- GSE14618_GPL96_sampleNames
rownames(exprs2cluster) <- symbols
color.map <- function(GSE14618_GPL96_grupos) {
    if (GSE14618_GPL96_grupos == "NR") {
        c <- "yellow"
    } else {
        if (GSE14618_GPL96_grupos == "F") {
            c <- "red"
        } else {
            if (GSE14618_GPL96_grupos == "C") {
                c <- "blue"
            } else {
                c <- "green"
            }
        }
    }
    return(c)
}

```


```{r, warning=TRUE, error=FALSE}
grupColors <- unlist(lapply(pData(eset_GSE14618_GPL96_Filtered)$grupo, color.map))
heatmap(exprs2cluster, col = rainbow(100), ColSideColors = cols, cexCol = 0.9)

```

```{r, warning=TRUE, error=FALSE}

c=c()
for (colorconcreto in GSE14618_GPL96_grupos){

    if (colorconcreto == "NR") {
        c <- append(c,"yellow")
    } else {
        if (colorconcreto == "F") {
            c <-  append(c,"red")
        } else {
            if (colorconcreto == "C") {
                c <-  append(c,"blue")
            } else {
                c <-  append(c,"green")
            }
        }}}


library("gplots")
heatmap.2(exprs2cluster, col=topo.colors(75), scale="none", ColSideColors=cols,
          key=TRUE, symkey=FALSE, density.info="none", trace="none", cexRow=0.5)


```


Mapa de colores basado en los genes seleccionados por estar diferencialmente expresados.


```{r, warning=TRUE, error=FALSE}

save(topTab_GSE14618_GPL96_CFAnot, topTab_GSE14618_GPL96_CNRAnot,
     topTab_GSE14618_GPL96_FNRAnot,
     file = 'C:/Users/Copito/OneDrive/Documentos/Master bioinf y bioest/TFM/datasets/GSE10609/topTabs_Anot')


# save(topTab_GSE14618_GPL96_CFAnot, topTab_GSE14618_GPL96_CNRAnot, topTab_GSE14618_GPL96_FNRAnot,
     # file = 'C:/Users/laura/OneDrive/Documentos/Cris/topTabs_Anot.RData')

```


# GSE26713



## Selección de genes diferencialmente expresados


```{r, warning=TRUE, error=FALSE}
setwd('C:/Users/Copito/OneDrive/Documentos/Master bioinf y bioest/TFM/datasets/GSE26713/')

# setwd('datosyeso/')

# setwd('C:/Users/laura/OneDrive/Documentos/Cris/')

load(file = 'C:/Users/Copito/OneDrive/Documentos/Master bioinf y bioest/TFM/datasets/GSE26713/GSE26713datos.normalizados.Rda')

load(file = 'C:/Users/Copito/OneDrive/Documentos/Master bioinf y bioest/TFM/datasets/GSE26713/GSE26713topTabs_Anot.RData')

load(file = 'C:/Users/Copito/OneDrive/Documentos/Master bioinf y bioest/TFM/datasets/GSE26713/Resultado_GSE26713.rda')

# load(file = 'C:/Users/laura/OneDrive/Documentos/Cris/GSE26713datos.normalizados.Rda')

require(Biobase)

# datadir <- "datosyeso/"

# datadir <- "C:/Users/laura/OneDrive/Documentos/Cris/"
datadir <- "C:/Users/Copito/OneDrive/Documentos/Master bioinf y bioest/TFM/datasets/GSE26713/"
```



```{r, warning=TRUE, error=FALSE}

# GSE26713_getGEO <- getGEO("GSE26713", GSEMatrix =TRUE, AnnotGPL=TRUE, destdir = datadir)

# GSE26713_getGEO <- getGEO("GSE26713", GSEMatrix =TRUE, AnnotGPL=TRUE, destdir = "C:/Users/Copito/OneDrive/Documentos/Master bioinf y bioest/TFM/datasets/GSE26713/" )

# GSE26713_getGEO<-GSE26713_getGEO[[2]]

setwd('C:/Users/Copito/OneDrive/Documentos/Master bioinf y bioest/TFM/datasets/GSE26713/')

load('C:/Users/Copito/OneDrive/Documentos/Master bioinf y bioest/TFM/datasets/GSE26713/GSE26713_rawData.Rda')
require(Biobase)
GSE26713_colores <- pData(GSE26713_rawData)$colores
GSE26713_grupos <- as.factor(pData(GSE26713_rawData)$grupo)
GSE26713_numSamples <- nrow(pData(GSE26713_rawData))
GSE26713_sampleNames <- pData(GSE26713_rawData)$shortName

```


```{r, warning=TRUE, error=FALSE}

GSE26713_design <- model.matrix(~0 + GSE26713_grupos)
rownames(GSE26713_design) <- GSE26713_sampleNames

colnames(GSE26713_design) <- c("BM", 'HOXA', 'LMO1',
                               'LMO2', 'MYB', 'TAL1', 'TAL2',
                               'TAL2_LMO1', 'TLX1', 'TLX3', 'unknown')
head(GSE26713_design)

```


Las comparaciones que nos interesan son:

-¿Existe desregulación de las RBP entre grupos? No hay interacciones

BM - HOXA, BM - LMO1, BM - LMO2, BM - MYB, BM - TAL1, BM - TAL2, BM - TAL2/LMO1, BM - TLX1, BM - TLX3

HOXA - LMO1, HOXA - LMO2, HOXA - MYB, HOXA - TAL1, HOXA - TAL2, HOXA - TAL2/LMO1, HOXA - TLX1, HOXA - TLX3

LMO1 - LMO2, LMO1 - MYB, LMO1 - TAL1, LMO1 - TAL2, LMO1 - TAL2/LMO1, LMO1 - TLX1, LMO1 - TLX3

LMO2 - MYB, LMO2 - TAL1, LMO2 - TAL2, LMO2 - TAL2/LMO1, LMO2 - TLX1, LMO2 - TLX3

MYB - TAL1, MYB - TAL2, MYB - TAL2/LMO1, MYB - TLX1, MYB - TLX3

TAL1 - TAL2, TAL1 - TAL2/LMO1, TAL1 - TLX1, TAL1 - TLX3

TAL2 - TAL2/LMO1, TAL2 - TLX1, TAL2 - TLX3

TAL2/LMO1 - TLX1, TAL2/LMO1 - TLX3

TLX1 - TLX3

-¿Hay desregulación entre los LMO y alguno de los demás?

(LMO1 + LMO2) - BM, (LMO1 + LMO2) - MYB, (LMO1 + LMO2) - TAL1, (LMO1 + LMO2) - TAL2, (LMO1 + LMO2) - TAL2/LMO1, (LMO1 + LMO2) - TLX1, (LMO1 + LMO2) - TLX3


(LMO1 + LMO2) - (TAL1 + TAL2), (LMO1 + LMO2) - (TLX1 + TLX3)


-¿Hay desregulación entre los TAL y alguno de los demás?

(TAL1 + TAL2) - BM, (TAL1 + TAL2) - MYB, (TAL1 + TAL2) - TAL2/LMO1, (TAL1 + TAL2) - TLX1, (TAL1 + TAL2) - TLX3


(TAL1 + TAL2) - (TLX1 + TLX3)


-¿Hay desregulación entre los TLX y alguno de los demás?

(TLX1 + TLX3) - BM, (TLX1 + TLX3) - MYB, (TLX1 + TLX3) - TAL1, (TLX1 + TLX3) - TAL2, (TLX1 + TLX3) - TAL2/LMO1



```{r, warning=TRUE, error=FALSE}

library(limma)
cont.matrix <- makeContrasts(BM_HOXA = BM - HOXA, BM_LMO1 = BM - LMO1,
                             BM_LMO2 = BM - LMO2, BM_MYB = BM - MYB,
                             BM_TAL1 = BM - TAL1, BM_TAL2 = BM - TAL2,
                             BM_TAL2LMO1 = BM - TAL2_LMO1,
                             BM_TLX1 = BM - TLX1, BM_TLX3 = BM - TLX3,
                             HOXA_LMO1 = HOXA - LMO1, HOXA_LMO2 = HOXA - LMO2,
                             HOXA_MYB = HOXA - MYB, HOXA_TAL1 = HOXA - TAL1,
                             HOXA_TAL2 = HOXA - TAL2, HOXA_TAL2LMO1 = HOXA - TAL2_LMO1,
                             HOXA_TLX1 = HOXA - TLX1, HOXA_TLX3 = HOXA - TLX3,
                             LMO = LMO1 - LMO2, LMO1_MYB = LMO1 - MYB,
                             LMO1_TAL1 = LMO1 - TAL1, LMO1_TAL2 = LMO1 - TAL2,
                             LMO1_TAL2LMO1 = LMO1 - TAL2_LMO1,
                             LMO1_TLX1 = LMO1 - TLX1, LMO1_TLX3 = LMO1 - TLX3,
                             LMO2_MYB = LMO2 - MYB, LMO2_TAL1 = LMO2 - TAL1,
                             LMO2_TAL2 = LMO2 - TAL2, LMO2_TAL2LMO1 = LMO2 - TAL2_LMO1,
                             LMO2_TLX1 = LMO2 - TLX1, LMO2_TLX3 = LMO2 - TLX3,
                             MYB_TAL1 = MYB - TAL1, MYB_TAL2 = MYB - TAL2,
                             MYB_TAL2LMO1 = MYB - TAL2_LMO1,
                             MYB_TLX1 = MYB - TLX1, MYB_TLX3 = MYB - TLX3,
                             TAL = TAL1 - TAL2, TAL1_TAL2LMO1 = TAL1 - TAL2_LMO1,
                             TAL1_TLX1 = TAL1 - TLX1, TAL1_TLX3 = TAL1 - TLX3,
                             TAL2_TAL2_LMO1 = TAL2 - TAL2_LMO1, TAL2_TLX1 = TAL2 - TLX1,
                             TAL2_TLX3 = TAL2 - TLX3, TAL2LMO1_TLX1 = TAL2_LMO1 - TLX1,
                             TAL2_LMO1 = TAL2_LMO1 - TLX3, TLX = TLX1 - TLX3,
                             LMO_BM = (LMO1 + LMO2)/2 - BM, LMO1LMO2_MYB = (LMO1 + LMO2)/2 - MYB,
                             LMO_TAL1 = (LMO1 + LMO2)/2 - TAL1,
                             LMO_TAL2 = (LMO1 + LMO2)/2 - TAL2,
                             LMO_TAL2LMO1 =  (LMO1 + LMO2)/2 - TAL2_LMO1,
                             LMO_TLX1 = (LMO1 + LMO2)/2 - TLX1,
                             LMO_TLX3 = (LMO1 + LMO2)/2 - TLX3,
                             LMO_TAL = (LMO1 + LMO2)/2 - (TAL1 + TAL2)/2,
                             LMO_TLX = (LMO1 + LMO2)/2 - (TLX1 + TLX3)/2,
                             TAL_BM = (TAL1 + TAL2)/2 - BM,
                             TAL_MYB = (TAL1 + TAL2)/2 - MYB,
                             TAL_TAL2LMO1 = (TAL1 + TAL2)/2 - TAL2_LMO1,
                             TAL_TLX1 = (TAL1 + TAL2)/2 - TLX1,
                             TAL_TLX3 = (TAL1 + TAL2)/2 - TLX3,
                             TAL_TLX = (TAL1 + TAL2)/2 - (TLX1 + TLX3)/2,
                             TLX_BM = (TLX1 + TLX3)/2 - BM,
                             TLX_MYB = (TLX1 + TLX3)/2 - MYB,
                             TLX_TAL1 = (TLX1 + TLX3)/2 - TAL1,
                             TLX_TAL2 = (TLX1 + TLX3)/2 - TAL2,
                             TLX_TAL2LMO1 = (TLX1 + TLX3)/2 - TAL2_LMO1, 
                             levels = GSE26713_design)
print(cont.matrix)

```

Ahora estimaremos el modelo.


```{r, warning=TRUE, error=FALSE}
# save(GSE8879_Filtered, eset_GSE8879_Filtered,
     # GSE8879_geneIds, file =
       # "C:/Users/Copito/OneDrive/Documentos/Master bioinf y bioest/TFM/datasets/GSE8879/datos.normalizados.Rda")

library(limma)
fit <- lmFit(eset_GSE26713_Filtered, GSE26713_design)
fit.GSE26713 <- contrasts.fit(fit, cont.matrix)
fit.GSE26713 <- eBayes(fit.GSE26713)
head(rownames(fit.GSE26713))

```

La función topTable genera para cada contraste una lista de genes ordenados de mas a menos diferencialmente expresados.

C_F C_NR F_NR

```{r, warning=TRUE, error=TRUE}
topTab_GSE26713_BMHOXA <- topTable(fit.GSE26713,
                           number = nrow(fit.GSE26713), coef = "BM_HOXA",
                           adjust = "fdr")

topTab_GSE26713_BMLMO1 <- topTable(fit.GSE26713,
                                       number = nrow(fit.GSE26713), coef = "BM_LMO1",
    adjust = "fdr")

topTab_GSE26713_BMLMO2 <- topTable(fit.GSE26713,
                                       number = nrow(fit.GSE26713), coef = "BM_LMO2",
    adjust = "fdr")

topTab_GSE26713_BMMYB <- topTable(fit.GSE26713,
                           number = nrow(fit.GSE26713), coef = "BM_MYB",
                           adjust = "fdr")

topTab_GSE26713_BMTAL1 <- topTable(fit.GSE26713,
                                       number = nrow(fit.GSE26713), coef = "BM_TAL1",
    adjust = "fdr")

topTab_GSE26713_BMTAL2 <- topTable(fit.GSE26713,
                                       number = nrow(fit.GSE26713), coef = "BM_TAL2",
    adjust = "fdr")


topTab_GSE26713_BMTAL2LMO1 <- topTable(fit.GSE26713,
                           number = nrow(fit.GSE26713), coef = "BM_TAL2LMO1",
                           adjust = "fdr")

topTab_GSE26713_BMTLX1 <- topTable(fit.GSE26713,
                                       number = nrow(fit.GSE26713), coef = "BM_TLX1",
    adjust = "fdr")

topTab_GSE26713_BMTLX3 <- topTable(fit.GSE26713,
                                       number = nrow(fit.GSE26713), coef = "BM_TLX3",
    adjust = "fdr")

topTab_GSE26713_HOXALMO1 <- topTable(fit.GSE26713,
                           number = nrow(fit.GSE26713), coef = "HOXA_LMO1",
                           adjust = "fdr")

topTab_GSE26713_HOXALMO2 <- topTable(fit.GSE26713,
                                       number = nrow(fit.GSE26713), coef = "HOXA_LMO2",
    adjust = "fdr")

topTab_GSE26713_HOXAMYB <- topTable(fit.GSE26713,
                                       number = nrow(fit.GSE26713), coef = "HOXA_MYB",
    adjust = "fdr")

topTab_GSE26713_HOXATAL1 <- topTable(fit.GSE26713,
                           number = nrow(fit.GSE26713), coef = "HOXA_TAL1",
                           adjust = "fdr")

topTab_GSE26713_HOXATAL2 <- topTable(fit.GSE26713,
                                       number = nrow(fit.GSE26713), coef = "HOXA_TAL2",
    adjust = "fdr")

topTab_GSE26713_HOXATAL2LMO1 <- topTable(fit.GSE26713,
                                       number = nrow(fit.GSE26713), coef = "HOXA_TAL2LMO1",
    adjust = "fdr")


topTab_GSE26713_HOXATLX1 <- topTable(fit.GSE26713,
                           number = nrow(fit.GSE26713), coef = "HOXA_TLX1",
                           adjust = "fdr")

topTab_GSE26713_HOXATLX3 <- topTable(fit.GSE26713,
                                       number = nrow(fit.GSE26713), coef = "HOXA_TLX3",
    adjust = "fdr")

topTab_GSE26713_LMO <- topTable(fit.GSE26713,
                                       number = nrow(fit.GSE26713), coef = "LMO",
    adjust = "fdr")



topTab_GSE26713_LMO1MYB <- topTable(fit.GSE26713,
                                       number = nrow(fit.GSE26713), coef = "LMO1_MYB",
    adjust = "fdr")

topTab_GSE26713_LMO1TAL1 <- topTable(fit.GSE26713,
                                       number = nrow(fit.GSE26713), coef = "LMO1_TAL1",
    adjust = "fdr")


topTab_GSE26713_LMO1TAL2 <- topTable(fit.GSE26713,
                           number = nrow(fit.GSE26713), coef = "LMO1_TAL2",
                           adjust = "fdr")

topTab_GSE26713_LMO1TAL2LMO1 <- topTable(fit.GSE26713,
                                       number = nrow(fit.GSE26713), coef = "LMO1_TAL2LMO1",
    adjust = "fdr")

topTab_GSE26713_LMO1TLX1 <- topTable(fit.GSE26713,
                                       number = nrow(fit.GSE26713), coef = "LMO1_TLX1",
    adjust = "fdr")


topTab_GSE26713_LMO1TLX3 <- topTable(fit.GSE26713,
                                       number = nrow(fit.GSE26713), coef = "LMO1_TLX3",
    adjust = "fdr")


topTab_GSE26713_LMO2MYB <- topTable(fit.GSE26713,
                           number = nrow(fit.GSE26713), coef = "LMO2_MYB",
                           adjust = "fdr")

topTab_GSE26713_LMO2TAL1 <- topTable(fit.GSE26713,
                                       number = nrow(fit.GSE26713), coef = "LMO2_TAL1",
    adjust = "fdr")

topTab_GSE26713_LMO2TAL2 <- topTable(fit.GSE26713,
                                       number = nrow(fit.GSE26713), coef = "LMO2_TAL2",
    adjust = "fdr")



topTab_GSE26713_LMO2TAL2LMO1 <- topTable(fit.GSE26713,
                                       number = nrow(fit.GSE26713), coef = "LMO2_TAL2LMO1",
    adjust = "fdr")

topTab_GSE26713_LMO2TLX1 <- topTable(fit.GSE26713,
                                       number = nrow(fit.GSE26713), coef = "LMO2_TLX1",
    adjust = "fdr")


topTab_GSE26713_LMO2TLX3 <- topTable(fit.GSE26713,
                           number = nrow(fit.GSE26713), coef = "LMO2_TLX3",
                           adjust = "fdr")

topTab_GSE26713_MYBTAL1 <- topTable(fit.GSE26713,
                                       number = nrow(fit.GSE26713), coef = "MYB_TAL1",
    adjust = "fdr")

topTab_GSE26713_MYBTAL2 <- topTable(fit.GSE26713,
                                       number = nrow(fit.GSE26713), coef = "MYB_TAL2",
    adjust = "fdr")


topTab_GSE26713_MYBTAL2LMO1 <- topTable(fit.GSE26713,
                                       number = nrow(fit.GSE26713), coef = "MYB_TAL2LMO1",
    adjust = "fdr")


topTab_GSE26713_MYBTLX1 <- topTable(fit.GSE26713,
                           number = nrow(fit.GSE26713), coef = "MYB_TLX1",
                           adjust = "fdr")

topTab_GSE26713_MYBTLX3 <- topTable(fit.GSE26713,
                                       number = nrow(fit.GSE26713), coef = "MYB_TLX3",
    adjust = "fdr")

topTab_GSE26713_TAL <- topTable(fit.GSE26713,
                                       number = nrow(fit.GSE26713), coef = "TAL",
    adjust = "fdr")


topTab_GSE26713_TAL1TAL2LMO1 <- topTable(fit.GSE26713,
                                       number = nrow(fit.GSE26713), coef = "TAL1_TAL2LMO1",
    adjust = "fdr")


topTab_GSE26713_TAL1TLX1 <- topTable(fit.GSE26713,
                           number = nrow(fit.GSE26713), coef = "TAL1_TLX1",
                           adjust = "fdr")

topTab_GSE26713_TAL1TLX3 <- topTable(fit.GSE26713,
                                       number = nrow(fit.GSE26713), coef = "TAL1_TLX3",
    adjust = "fdr")

topTab_GSE26713_TAL2TAL2LMO1 <- topTable(fit.GSE26713,
                                       number = nrow(fit.GSE26713), coef = "TAL2_TAL2_LMO1",
    adjust = "fdr")


topTab_GSE26713_TAL2TLX1 <- topTable(fit.GSE26713,
                                       number = nrow(fit.GSE26713), coef = "TAL2_TLX1",
    adjust = "fdr")


topTab_GSE26713_TAL2TLX3 <- topTable(fit.GSE26713,
                           number = nrow(fit.GSE26713), coef = "TAL2_TLX3",
                           adjust = "fdr")

topTab_GSE26713_TAL2LMO1TLX1 <- topTable(fit.GSE26713,
                                       number = nrow(fit.GSE26713), coef = "TAL2LMO1_TLX1",
    adjust = "fdr")

topTab_GSE26713_TAL2LMO1 <- topTable(fit.GSE26713,
                                       number = nrow(fit.GSE26713), coef = "TAL2_LMO1",
    adjust = "fdr")



topTab_GSE26713_TLX <- topTable(fit.GSE26713,
                                       number = nrow(fit.GSE26713), coef = "TLX",
    adjust = "fdr")


topTab_GSE26713_LMO_BM <- topTable(fit.GSE26713,
                           number = nrow(fit.GSE26713), coef = "LMO_BM",
                           adjust = "fdr")

topTab_GSE26713_LMO1LMO2MYB <- topTable(fit.GSE26713,
                                       number = nrow(fit.GSE26713), coef = "LMO1LMO2_MYB",
    adjust = "fdr")

topTab_GSE26713_LMOTAL1 <- topTable(fit.GSE26713,
                                       number = nrow(fit.GSE26713), coef = "LMO_TAL1",
    adjust = "fdr")


topTab_GSE26713_LMOTAL2 <- topTable(fit.GSE26713,
                                       number = nrow(fit.GSE26713), coef = "LMO_TAL2",
    adjust = "fdr")


topTab_GSE26713_LMOTAL2LMO1 <- topTable(fit.GSE26713,
                           number = nrow(fit.GSE26713), coef = "LMO_TAL2LMO1",
                           adjust = "fdr")

topTab_GSE26713_LMOTLX1 <- topTable(fit.GSE26713,
                                       number = nrow(fit.GSE26713), coef = "LMO_TLX1",
    adjust = "fdr")

topTab_GSE26713_LMOTLX3 <- topTable(fit.GSE26713,
                                       number = nrow(fit.GSE26713), coef = "LMO_TLX3",
    adjust = "fdr")



topTab_GSE26713_LMOTAL <- topTable(fit.GSE26713,
                                       number = nrow(fit.GSE26713), coef = "LMO_TAL",
    adjust = "fdr")


topTab_GSE26713_LMOTLX <- topTable(fit.GSE26713,
                           number = nrow(fit.GSE26713), coef = "LMO_TLX",
                           adjust = "fdr")

topTab_GSE26713_TALBM <- topTable(fit.GSE26713,
                                       number = nrow(fit.GSE26713), coef = "TAL_BM",
    adjust = "fdr")

topTab_GSE26713_TALMYB <- topTable(fit.GSE26713,
                                       number = nrow(fit.GSE26713), coef = "TAL_MYB",
    adjust = "fdr")


topTab_GSE26713_TALTAL2LMO1 <- topTable(fit.GSE26713,
                                       number = nrow(fit.GSE26713), coef = "TAL_TAL2LMO1",
    adjust = "fdr")


topTab_GSE26713_TALTLX1 <- topTable(fit.GSE26713,
                           number = nrow(fit.GSE26713), coef = "TAL_TLX1",
                           adjust = "fdr")

topTab_GSE26713_TALTLX3 <- topTable(fit.GSE26713,
                                       number = nrow(fit.GSE26713), coef = "TAL_TLX3",
    adjust = "fdr")

topTab_GSE26713_TALTLX <- topTable(fit.GSE26713,
                                       number = nrow(fit.GSE26713), coef = "TAL_TLX",
    adjust = "fdr")


topTab_GSE26713_TALTLX <- topTable(fit.GSE26713,
                                       number = nrow(fit.GSE26713), coef = "TAL_TLX",
    adjust = "fdr")

topTab_GSE26713_TLXBM <- topTable(fit.GSE26713,
                                       number = nrow(fit.GSE26713), coef = "TLX_BM",
    adjust = "fdr")


topTab_GSE26713_TLXMYB <- topTable(fit.GSE26713,
                                       number = nrow(fit.GSE26713), coef = "TLX_MYB",
    adjust = "fdr")


topTab_GSE26713_TLXTAL1 <- topTable(fit.GSE26713,
                           number = nrow(fit.GSE26713), coef = "TLX_TAL1",
                           adjust = "fdr")

topTab_GSE26713_TLXTAL2 <- topTable(fit.GSE26713,
                                       number = nrow(fit.GSE26713), coef = "TLX_TAL2",
    adjust = "fdr")

topTab_GSE26713_TLXTAL2LMO1 <- topTable(fit.GSE26713,
                                       number = nrow(fit.GSE26713), coef = "TLX_TAL2LMO1",
    adjust = "fdr")


head(topTab_GSE26713_TLXTAL2)
```


Para identificar los genes más diferencialmente expresados podemos utilizar la lista de anotaciones y añadir algunas a las topTables.


```{r, warning=TRUE, error=TRUE}
library(dplyr)
anotaTopTab <- function(topTab) {
    topTab_Anot <- topTab %>%
        mutate(PROBEID = rownames(topTab)) %>%
        merge(GSE26713_geneIds, "PROBEID") %>%
        arrange(adj.P.Val)
    return(topTab_Anot)
}

topTab_GSE26713_BMHOXAAnot <- anotaTopTab(topTab_GSE26713_BMHOXA)


topTab_GSE26713_BMLMO1Anot <- anotaTopTab(topTab_GSE26713_BMLMO1)


topTab_GSE26713_BMLMO2Anot <- anotaTopTab(topTab_GSE26713_BMLMO2)


topTab_GSE26713_BMMYBAnot <- anotaTopTab(topTab_GSE26713_BMMYB)


topTab_GSE26713_BMTAL1Anot <- anotaTopTab(topTab_GSE26713_BMTAL1)


topTab_GSE26713_BMTAL2Anot <- anotaTopTab(topTab_GSE26713_BMTAL2)


topTab_GSE26713_BMTAL2LMO1Anot <- anotaTopTab(topTab_GSE26713_BMTAL2LMO1)


topTab_GSE26713_BMTLX1Anot <- anotaTopTab(topTab_GSE26713_BMTLX1)


topTab_GSE26713_BMTLX3Anot <- anotaTopTab(topTab_GSE26713_BMTLX3)


topTab_GSE26713_HOXALMO1Anot <- anotaTopTab(topTab_GSE26713_HOXALMO1)


topTab_GSE26713_HOXALMO2Anot <- anotaTopTab(topTab_GSE26713_HOXALMO2)


topTab_GSE26713_HOXAMYBAnot <- anotaTopTab(topTab_GSE26713_HOXAMYB)


topTab_GSE26713_HOXATAL1Anot <- anotaTopTab(topTab_GSE26713_HOXATAL1)


topTab_GSE26713_HOXATAL2Anot <- anotaTopTab(topTab_GSE26713_HOXATAL2)


topTab_GSE26713_HOXATAL2LMO1Anot <- anotaTopTab(topTab_GSE26713_HOXATAL2LMO1)



topTab_GSE26713_HOXATLX1Anot <- anotaTopTab(topTab_GSE26713_HOXATLX1)


topTab_GSE26713_HOXATLX3Anot <- anotaTopTab(topTab_GSE26713_HOXATLX3)


topTab_GSE26713_LMOAnot <- anotaTopTab(topTab_GSE26713_LMO)



topTab_GSE26713_LMOBMAnot <- anotaTopTab(topTab_GSE26713_LMO_BM)


topTab_GSE26713_LMO1LMO2MYBAnot <- anotaTopTab(topTab_GSE26713_LMO1LMO2MYB)


topTab_GSE26713_LMO1MYBAnot <- anotaTopTab(topTab_GSE26713_LMO1MYB)



topTab_GSE26713_LMO1TAL1Anot <- anotaTopTab(topTab_GSE26713_LMO1TAL1)


topTab_GSE26713_LMO1TAL2Anot <- anotaTopTab(topTab_GSE26713_LMO1TAL2)


topTab_GSE26713_LMO1TAL2LMO1Anot <- anotaTopTab(topTab_GSE26713_LMO1TAL2LMO1)


topTab_GSE26713_LMO1TLX1Anot <- anotaTopTab(topTab_GSE26713_LMO1TLX1)



topTab_GSE26713_LMO1TLX3Anot <- anotaTopTab(topTab_GSE26713_LMO1TLX3)


topTab_GSE26713_LMO2MYBAnot <- anotaTopTab(topTab_GSE26713_LMO2MYB)


topTab_GSE26713_LMO2TAL1Anot <- anotaTopTab(topTab_GSE26713_LMO2TAL1)



topTab_GSE26713_LMO2TAL2Anot <- anotaTopTab(topTab_GSE26713_LMO2TAL2)


topTab_GSE26713_LMO2TAL2LMO1Anot <- anotaTopTab(topTab_GSE26713_LMO2TAL2LMO1)


topTab_GSE26713_LMO2TLX1Anot <- anotaTopTab(topTab_GSE26713_LMO2TLX1)


topTab_GSE26713_LMO2TLX3Anot <- anotaTopTab(topTab_GSE26713_LMO2TLX3)


topTab_GSE26713_LMOTALAnot <- anotaTopTab(topTab_GSE26713_LMOTAL)



topTab_GSE26713_LMOTAL1Anot <- anotaTopTab(topTab_GSE26713_LMOTAL1)


topTab_GSE26713_LMOTAL2Anot <- anotaTopTab(topTab_GSE26713_LMOTAL2)


topTab_GSE26713_LMOTAL2LMO1Anot <- anotaTopTab(topTab_GSE26713_LMOTAL2LMO1)



topTab_GSE26713_LMOTLXAnot <- anotaTopTab(topTab_GSE26713_LMOTLX)


topTab_GSE26713_LMOTLX1Anot <- anotaTopTab(topTab_GSE26713_LMOTLX1)


topTab_GSE26713_LMOTLX3Anot <- anotaTopTab(topTab_GSE26713_LMOTLX3)


topTab_GSE26713_MYBTAL1Anot <- anotaTopTab(topTab_GSE26713_MYBTAL1)



topTab_GSE26713_MYBTAL2Anot <- anotaTopTab(topTab_GSE26713_MYBTAL2)


topTab_GSE26713_MYBTAL2LMO1Anot <- anotaTopTab(topTab_GSE26713_MYBTAL2LMO1)


topTab_GSE26713_MYBTLX1Anot <- anotaTopTab(topTab_GSE26713_MYBTLX1)


topTab_GSE26713_MYBTLX3Anot <- anotaTopTab(topTab_GSE26713_MYBTLX3)



topTab_GSE26713_TALAnot <- anotaTopTab(topTab_GSE26713_TAL)


topTab_GSE26713_TALTLXAnot <- anotaTopTab(topTab_GSE26713_TALTLX)


topTab_GSE26713_TAL1TAL2LMO1Anot <- anotaTopTab(topTab_GSE26713_TAL1TAL2LMO1)


topTab_GSE26713_TAL1TLX1Anot <- anotaTopTab(topTab_GSE26713_TAL1TLX1)



topTab_GSE26713_TAL1TLX3Anot <- anotaTopTab(topTab_GSE26713_TAL1TLX3)


topTab_GSE26713_TAL2LMO1Anot <- anotaTopTab(topTab_GSE26713_TAL2LMO1)


topTab_GSE26713_TAL2LMO1TLX1Anot <- anotaTopTab(topTab_GSE26713_TAL2LMO1TLX1)


topTab_GSE26713_TAL2TAL2LMO1Anot <- anotaTopTab(topTab_GSE26713_TAL2TAL2LMO1)


topTab_GSE26713_TAL2TLX1Anot <- anotaTopTab(topTab_GSE26713_TAL2TLX1)



topTab_GSE26713_TAL2TLX3Anot <- anotaTopTab(topTab_GSE26713_TAL2TLX3)


topTab_GSE26713_TALBMAnot <- anotaTopTab(topTab_GSE26713_TALBM)


topTab_GSE26713_TALMYBAnot <- anotaTopTab(topTab_GSE26713_TALMYB)



topTab_GSE26713_TALTAL2LMO1Anot <- anotaTopTab(topTab_GSE26713_TALTAL2LMO1)


topTab_GSE26713_TALTLXLAnot <- anotaTopTab(topTab_GSE26713_TALTLX)


topTab_GSE26713_TALTLX1Anot <- anotaTopTab(topTab_GSE26713_TALTLX1)


topTab_GSE26713_TALTLX3Anot <- anotaTopTab(topTab_GSE26713_TALTLX3)


topTab_GSE26713_TLXAnot <- anotaTopTab(topTab_GSE26713_TLX)


topTab_GSE26713_TLXBMAnot <- anotaTopTab(topTab_GSE26713_TLXBM)

topTab_GSE26713_TLXMYBAnot <- anotaTopTab(topTab_GSE26713_TLXMYB)


topTab_GSE26713_TLXTAL1Anot <- anotaTopTab(topTab_GSE26713_TLXTAL1)


topTab_GSE26713_TLXTAL2Anot <- anotaTopTab(topTab_GSE26713_TLXTAL2)

topTab_GSE26713_TLXTAL2LMO1Anot <- anotaTopTab(topTab_GSE26713_TLXTAL2LMO1)





head(topTab_GSE26713_TLXTAL1Anot)
```

Comparaciones múltiples.


```{r, warning=TRUE, error=FALSE}
library(limma)
GSE26713_res <- decideTests(fit.GSE26713,
                                   method = "separate", adjust.method = "fdr",
                                   p.value = 0.05, lfc = 0)
```

Para resumir dicho análisis podemos contar qué filas tienen como mínimo una celda distinta de cero:



```{r, warning=TRUE, error=FALSE}
sum.GSE26713res.rows <- apply(abs(GSE26713_res), 1, sum)
GSE26713_res.selected <- GSE26713_res[sum.GSE26713res.rows != 0, ]
print(summary(GSE26713_res))
```



```{r, warning=TRUE, error=FALSE}
xlimits <- c(-6, +6)
ylimits <- c(0, 34)
GSE26713_genenames <- c(topTab_GSE26713_BMHOXAAnot$SYMBOL, topTab_GSE26713_BMLMO1Anot$SYMBOL,
                        topTab_GSE26713_BMLMO2Anot$SYMBOL, topTab_GSE26713_BMMYBAnot$SYMBOL,
                        topTab_GSE26713_BMTAL1Anot$SYMBOL, topTab_GSE26713_BMTAL2Anot$SYMBOL,
                        topTab_GSE26713_BMTAL2LMO1Anot$SYMBOL,
                        topTab_GSE26713_BMTLX1Anot$SYMBOL,
                        topTab_GSE26713_BMTLX3Anot$SYMBOL, topTab_GSE26713_HOXALMO1Anot$SYMBOL,
                        topTab_GSE26713_HOXALMO2Anot$SYMBOL, topTab_GSE26713_HOXAMYBAnot$SYMBOL,
                        topTab_GSE26713_HOXATAL1Anot$SYMBOL,
                        topTab_GSE26713_HOXATAL2Anot$SYMBOL,
                        topTab_GSE26713_HOXATAL2LMO1Anot$SYMBOL,
                        topTab_GSE26713_HOXATLX1Anot$SYMBOL,
                        topTab_GSE26713_HOXATLX3Anot$SYMBOL, topTab_GSE26713_LMOAnot$SYMBOL,
                        topTab_GSE26713_LMOBMAnot$SYMBOL,
                        topTab_GSE26713_LMO1LMO2MYBAnot$SYMBOL,
                        topTab_GSE26713_LMO1MYBAnot$SYMBOL, topTab_GSE26713_LMO1TAL1Anot$SYMBOL,
                        topTab_GSE26713_LMO1TAL2Anot$SYMBOL,
                        topTab_GSE26713_LMO1TAL2LMO1Anot$SYMBOL,
                        topTab_GSE26713_LMO1TLX1Anot$SYMBOL,
                        topTab_GSE26713_LMO1TLX3Anot$SYMBOL, topTab_GSE26713_LMO2MYBAnot$SYMBOL,
                        topTab_GSE26713_LMO2TAL1Anot$SYMBOL,
                        topTab_GSE26713_LMO2TAL2Anot$SYMBOL,
                        topTab_GSE26713_LMO2TAL2LMO1Anot$SYMBOL,
                        topTab_GSE26713_LMO2TLX1Anot$SYMBOL,
                        topTab_GSE26713_LMO2TLX3Anot$SYMBOL, topTab_GSE26713_LMOTALAnot$SYMBOL,
                        topTab_GSE26713_LMOTAL1Anot$SYMBOL, topTab_GSE26713_LMOTAL2Anot$SYMBOL,
                        topTab_GSE26713_LMOTAL2LMO1Anot$SYMBOL,
                        topTab_GSE26713_LMOTLXAnot$SYMBOL, topTab_GSE26713_LMOTLX1Anot$SYMBOL,
                        topTab_GSE26713_LMOTLX3Anot$SYMBOL, topTab_GSE26713_MYBTAL1Anot$SYMBOL,
                        topTab_GSE26713_MYBTAL2Anot$SYMBOL,
                        topTab_GSE26713_MYBTAL2LMO1Anot$SYMBOL,
                        topTab_GSE26713_MYBTLX1Anot$SYMBOL, topTab_GSE26713_MYBTLX3Anot$SYMBOL,
                        topTab_GSE26713_TALAnot$SYMBOL, topTab_GSE26713_TALTLXAnot$SYMBOL,
                        topTab_GSE26713_TAL1TAL2LMO1Anot$SYMBOL,
                        topTab_GSE26713_TAL1TLX1Anot$SYMBOL,
                        topTab_GSE26713_TAL1TLX3Anot$SYMBOL,
                        topTab_GSE26713_TAL2LMO1Anot$SYMBOL,
                        topTab_GSE26713_TAL2LMO1TLX1Anot$SYMBOL,
                        topTab_GSE26713_TAL2TAL2LMO1Anot$SYMBOL,
                        topTab_GSE26713_TAL2TLX1Anot$SYMBOL,
                        topTab_GSE26713_TAL2TLX3Anot$SYMBOL,
                        topTab_GSE26713_TALBMAnot$SYMBOL, topTab_GSE26713_TALMYBAnot$SYMBOL,
                        topTab_GSE26713_TALTAL2LMO1Anot$SYMBOL,
                        topTab_GSE26713_TALTLXLAnot$SYMBOL, topTab_GSE26713_TALTLX1Anot$SYMBOL,
                        topTab_GSE26713_TALTLX3Anot$SYMBOL, topTab_GSE26713_TLXAnot$SYMBOL,
                        topTab_GSE26713_TLXBMAnot$SYMBOL, topTab_GSE26713_TLXMYBAnot$SYMBOL,
                        topTab_GSE26713_TLXTAL1Anot$SYMBOL, topTab_GSE26713_TLXTAL2Anot$SYMBOL,
                        topTab_GSE26713_TLXTAL2LMO1Anot$SYMBOL)

volcanoplot(fit.GSE26713, highlight = 10, names = GSE26713_genenames, main = 'GSE26713', cex.main = 0.8, xlim = xlimits, ylim = ylimits)

abline(v = c(-1, 1))



```


Visualización de los perfiles de expresión



```{r, warning=TRUE, error=FALSE}
eset_GSE26713_Filtered
require(hgu133plus2.db)
```


```{r, warning=TRUE, error=FALSE}
library(hgu133plus2.db)
probeNames <- rownames(GSE26713_res)
probeNames.selected <- probeNames[sum.GSE26713res.rows != 0]
exprs2cluster <- exprs(eset_GSE26713_Filtered)[probeNames.selected, ]
symbols <- AnnotationDbi::select(hgu133plus2.db, probeNames.selected,
    columns = "SYMBOL")[, 2]
colnames(exprs2cluster) <- GSE26713_sampleNames
rownames(exprs2cluster) <- symbols
color.map <- function(GSE26713_grupos) {
  
  if (GSE26713_grupos == "BM") { c <- "yellow"}
  
  else if(GSE26713_grupos == "HOXA") {c <- "red"}
  
  else if (GSE26713_grupos == "LMO1") {c <- "aquamarine"}
  
  else if (GSE26713_grupos == "LMO2") {c <- "chartreuse"}
  
  else if (GSE26713_grupos == "MYB") {c <- "chocolate4"}
  
  else if (GSE26713_grupos == "TAL1") {c <- "cornflowerblue"}
  
  else if (GSE26713_grupos == "TAL2") {c <- "darkblue"}
  
  else if (GSE26713_grupos == "TAL2/LMO1") {c <- "darkgoldenrod2"}
  
  else if (GSE26713_grupos == "TLX1") {
                c <- "darkmagenta"

        } else if (GSE26713_grupos == "TLX3") {
            c <- "deeppink"
            
            } else if (GSE26713_grupos == "unknown") {
                c <- "gray"}
    return(c)
}

```


```{r, warning=TRUE, error=FALSE}

GSE26713_grupos <- as.factor(pData(GSE26713_rawData)$grupo)
c=c()
for (colll in GSE26713_grupos) {
  
  if (colll == "BM") { c <- append(c, "yellow")}
  
  else if(colll == "HOXA") {c <- append(c, "red")}
  
  else if (colll == "LMO1") {c <- append(c, "aquamarine")}
  
  else if (colll == "LMO2") {c <- append(c, "chartreuse")}
  
  else if (colll == "MYB") {c <- append(c, "chocolate4")}
  
  else if (colll == "TAL1") {c <- append(c, "cornflowerblue")}
  
  else if (colll == "TAL2") {c <- append(c, "darkblue")}
  
  else if (colll == "TAL2/LMO1") {c <- append(c, "darkgoldenrod2")}
  
  else if (colll == "TLX1") {
                c <- append(c, "burlywood2")

        } else if (colll == "TLX3") {
            c <- append(c, "gray1")
            
            } else if (colll == "unknown") {
                c <- append(c, "gray")}
 else { c <- append(c, "seagreen1")}
}

heatmap(exprs2cluster, col = rainbow(100), ColSideColors = c, cexCol = 0.9)

```

```{r, warning=TRUE, error=FALSE}
library("gplots")
heatmap.2(exprs2cluster, col=topo.colors(75), scale="none", ColSideColors=c,
          key=TRUE, symkey=FALSE, density.info="none", trace="none", cexRow=0.5)
```          
          
Mapa de colores basado en los genes seleccionados por estar diferencialmente expresados.


```{r, warning=TRUE, error=FALSE}

# save(topTab_GSE26713_CFAnot, ETC,
     # file = 'C:/Users/Copito/OneDrive/Documentos/Master bioinf y bioest/TFM/datasets/GSE10609/topTabs_Anot'


save(topTab_GSE26713_BMHOXAAnot, topTab_GSE26713_BMLMO1Anot, topTab_GSE26713_BMLMO2Anot, topTab_GSE26713_BMMYBAnot,
     topTab_GSE26713_BMTAL1Anot, topTab_GSE26713_BMTAL2Anot, topTab_GSE26713_BMTAL2LMO1Anot, topTab_GSE26713_BMTLX1Anot,
     topTab_GSE26713_BMTLX3Anot, topTab_GSE26713_HOXALMO1Anot, topTab_GSE26713_HOXALMO2Anot, topTab_GSE26713_HOXATAL1Anot,
     topTab_GSE26713_HOXATAL2Anot, topTab_GSE26713_HOXATAL2LMO1Anot, topTab_GSE26713_HOXATLX1Anot, topTab_GSE26713_HOXATLX3Anot,
     topTab_GSE26713_LMOAnot, topTab_GSE26713_LMOBMAnot, topTab_GSE26713_LMO1LMO2MYBAnot, topTab_GSE26713_LMO1MYBAnot,
     topTab_GSE26713_LMO2TAL1Anot, topTab_GSE26713_LMO2TAL2Anot, topTab_GSE26713_LMO2TAL2LMO1Anot, topTab_GSE26713_LMO2TLX1Anot,
     topTab_GSE26713_LMO2TLX3Anot, topTab_GSE26713_LMOTALAnot, topTab_GSE26713_LMOTAL1Anot, topTab_GSE26713_LMOTAL2Anot,
     topTab_GSE26713_LMOTAL2LMO1Anot, topTab_GSE26713_LMOTLX3Anot, topTab_GSE26713_LMOTLX1Anot,
     topTab_GSE26713_MYBTAL1Anot, topTab_GSE26713_MYBTAL2Anot, topTab_GSE26713_MYBTAL2LMO1Anot, topTab_GSE26713_MYBTLX1Anot,
     topTab_GSE26713_MYBTLX3Anot, topTab_GSE26713_TALAnot, topTab_GSE26713_TAL1TAL2LMO1Anot, topTab_GSE26713_TAL1TLX1Anot,
     topTab_GSE26713_TAL1TLX3Anot, topTab_GSE26713_TAL2LMO1Anot, topTab_GSE26713_TAL2LMO1TLX1Anot,
     topTab_GSE26713_TAL2TAL2LMO1Anot, topTab_GSE26713_TAL2TLX1Anot, topTab_GSE26713_TAL2TLX3Anot, topTab_GSE26713_TALAnot,
     topTab_GSE26713_TALBMAnot, topTab_GSE26713_TALMYBAnot, topTab_GSE26713_TALTAL2LMO1Anot, topTab_GSE26713_TALTLXAnot,
     topTab_GSE26713_TALTLX1Anot, topTab_GSE26713_TALTLX3Anot, topTab_GSE26713_TALTLXLAnot, topTab_GSE26713_TALTLXAnot,
     topTab_GSE26713_TLXAnot, topTab_GSE26713_TLXBMAnot, topTab_GSE26713_TLXMYBAnot, topTab_GSE26713_TLXTAL1Anot, topTab_GSE26713_TLXTAL2Anot, topTab_GSE26713_TLXTAL2LMO1Anot,
     file = 'C:/Users/Copito/OneDrive/Documentos/Master bioinf y bioest/TFM/datasets/GSE26713/GSE26713topTabs_Anot.RData')


```




# GSE28703




## Selección de genes diferencialmente expresados


```{r, warning=TRUE, error=FALSE}
setwd('C:/Users/Copito/OneDrive/Documentos/Master bioinf y bioest/TFM/datasets/GSE28703/')

# setwd('datosyeso/')

# setwd('C:/Users/laura/OneDrive/Documentos/Cris/')

load(file = 'C:/Users/Copito/OneDrive/Documentos/Master bioinf y bioest/TFM/datasets/GSE28703/GSE28703_datos.normalizados.Rda')

# load(file = 'C:/Users/laura/OneDrive/Documentos/Cris/GSE26713datos.normalizados.Rda')

require(Biobase)

# datadir <- "datosyeso/"

# datadir <- "C:/Users/laura/OneDrive/Documentos/Cris/"
```



```{r, warning=TRUE, error=FALSE}
library(GEOquery)

# GSE28703_getGEO <- getGEO("GSE28703", GSEMatrix =TRUE, AnnotGPL=TRUE, destdir = datadir)

GSE28703_getGEO <- getGEO("GSE28703", GSEMatrix =TRUE, AnnotGPL=TRUE, destdir = "C:/Users/Copito/OneDrive/Documentos/Master bioinf y bioest/TFM/datasets/GSE28703/" )

GSE28703_getGEO<-GSE28703_getGEO[[1]]


(GSE28703_sampleNames <- GSE28703_getGEO@phenoData@data[["title"]])

GSE28703_numSamples <- length(GSE28703_sampleNames)

GSE28703_getGEO@phenoData@data[["source_name_ch1"]]

GSE28703_colores <- c(rep("red", 7), rep("blue", 40), rep("red", 5))
# rojo: RNA extracted from diagnostic leukemic blasts of early T-cell precursor
# acute lymphoblastic leukemia, azul: RNA extracted from diagnostic leukemic blasts
# of T-cell precursor acute lymphoblastic leukemia (non-ETP)

GSE28703_grupos <- c(rep("early T-ALL", 7), rep("non-ETP", 40),
          rep("early T-ALL", 5))


```


```{r, warning=TRUE, error=FALSE}

GSE28703_design <- model.matrix(~0 + as.factor(GSE28703_grupos))
rownames(GSE28703_design) <- GSE28703_sampleNames

colnames(GSE28703_design) <- c('early_T_ALL', 'non_ETP')
head(GSE28703_design)

```


Las comparaciones que nos interesan son:

-¿Existe desregulación de las RBP entre grupos? No hay interacciones

early T-ALL - non_ETP

```{r, warning=TRUE, error=FALSE}

library(limma)
cont.matrix <- makeContrasts(ETP_notETP = early_T_ALL - non_ETP, 
                             levels = GSE28703_design)
print(cont.matrix)

```

Ahora estimaremos el modelo.


```{r, warning=TRUE, error=FALSE}
# save(GSE8879_Filtered, eset_GSE8879_Filtered,
     # GSE8879_geneIds, file =
       # "C:/Users/Copito/OneDrive/Documentos/Master bioinf y bioest/TFM/datasets/GSE8879/datos.normalizados.Rda")

library(limma)
fit <- lmFit(eset_GSE28703_Filtered, GSE28703_design)
fit.GSE28703 <- contrasts.fit(fit, cont.matrix)
fit.GSE28703 <- eBayes(fit.GSE28703)
head(rownames(fit.GSE28703))

```

La función topTable genera para cada contraste una lista de genes ordenados de mas a menos diferencialmente expresados.

ETP_notETP:

```{r, warning=TRUE, error=TRUE}
topTab_GSE28703 <- topTable(fit.GSE28703,
                           number = nrow(fit.GSE28703), coef = "ETP_notETP",
                           adjust = "fdr")



head(topTab_GSE28703)
```


Para identificar los genes más diferencialmente expresados podemos utilizar la lista de anotaciones y añadir algunas a las topTables.


```{r, warning=TRUE, error=TRUE}
library(dplyr)
anotaTopTab <- function(topTab) {
    topTab_Anot <- topTab %>%
        mutate(PROBEID = rownames(topTab)) %>%
        merge(GSE28703_geneIds, "PROBEID") %>%
        arrange(adj.P.Val)
    return(topTab_Anot)
}

topTab_GSE28703Anot <- anotaTopTab(topTab_GSE28703)


head(topTab_GSE28703Anot)
```

Comparaciones múltiples.


```{r, warning=TRUE, error=FALSE}
GSE28703_res <- decideTests(fit.GSE28703,
                                   method = "separate", adjust.method = "fdr",
                                   p.value = 0.05, lfc = 0)
```

Para resumir dicho análisis podemos contar qué filas tienen como mínimo una celda distinta de cero:



```{r, warning=TRUE, error=FALSE}
sum.GSE28703res.rows <- apply(abs(GSE28703_res), 1, sum)
GSE28703_res.selected <- GSE28703_res[sum.GSE28703res.rows != 0, ]
print(summary(GSE28703_res))
```


```{r, warning=TRUE, error=FALSE}
xlimits <- c(-7, +6)
ylimits <- c(0, 18)

GSE28703_genenames <- topTab_GSE28703Anot$SYMBOL
coef <- 1


volcanoplot(fit.GSE28703, highlight = 10, names = GSE28703_genenames, coef = coef, main = 'GSE28703', cex.main = 0.8, xlim = xlimits, ylim = ylimits)

abline(v = c(-1, 1))



```


Visualización de los perfiles de expresión



```{r, warning=TRUE, error=FALSE}
eset_GSE28703_Filtered
require(hthgu133pluspm.db)
```


```{r, warning=TRUE, error=FALSE}
probeNames <- rownames(GSE28703_res)
probeNames.selected <- probeNames[sum.GSE28703res.rows != 0]
exprs2cluster <- exprs(eset_GSE28703_Filtered)[probeNames.selected, ]
symbols <- AnnotationDbi::select(hthgu133pluspm.db, probeNames.selected,
    columns = "SYMBOL")[, 2]
colnames(exprs2cluster) <- GSE28703_sampleNames
rownames(exprs2cluster) <- symbols
color.map <- function(GSE28703_grupos) {
  
  if (GSE28703_grupos == "early T-ALL") { c <- "yellow"}
  
  else if(GSE28703_grupos == "non-ETP") {c <- "red"}
  else {c <- "gray"}
    return(c)
}

```


```{r, warning=TRUE, error=FALSE}
grupColors <- unlist(lapply(GSE28703_grupos, color.map))
heatmap(exprs2cluster, col = rainbow(100), ColSideColors = GSE28703_colores, cexCol = 0.9)

```

```{r, warning=TRUE, error=FALSE}
library("gplots")
heatmap.2(exprs2cluster, col=topo.colors(75), scale="none", ColSideColors=grupColors,
          key=TRUE, symkey=FALSE, density.info="none", trace="none", cexRow=0.5)
```


Mapa de colores basado en los genes seleccionados por estar diferencialmente expresados.


```{r, warning=TRUE, error=FALSE}

save(topTab_GSE28703Anot,
     file = 'C:/Users/Copito/OneDrive/Documentos/Master bioinf y bioest/TFM/datasets/GSE28703/GSE28703topTabs_Anot.RData')



```




# GSE32215

## Selección de genes diferencialmente expresados



```{r, warning=TRUE, error=FALSE}
setwd('C:/Users/Copito/OneDrive/Documentos/Master bioinf y bioest/TFM/datasets/GSE32215/')
load(file = './GSE32215_datos.normalizados.Rda')
require(Biobase)
datadir <- "C:/Users/Copito/OneDrive/Documentos/Master bioinf y bioest/TFM/datasets/"
```



```{r, warning=TRUE, error=FALSE}
library(GEOquery)

GSE32215_getGEO <- getGEO("GSE32215", GSEMatrix =TRUE, AnnotGPL=TRUE, destdir = "C:/Users/Copito/OneDrive/Documentos/Master bioinf y bioest/TFM/datasets/GSE32215/" )

GSE32215_getGEO<-GSE32215_getGEO[[1]]


shortNames <- GSE32215_getGEO@phenoData@data[["title"]]

GSE32215_sampleNames <- shortNames


(d<- GSE32215_getGEO@phenoData@data[["cell type:ch1"]])

cols=c()

for (valor in d){
  if (valor=="adult T-ALL"){cols=append(cols, 'red')}
  else if (valor=="pediatric T-ALL"){cols=append(cols, 'blue')}
  else if (valor=="unknown"){cols=append(cols, 'goldenrod1')}
}
 

GSE32215_grupos <- d
```


```{r, warning=TRUE, error=FALSE}
GSE32215_design <- model.matrix(~0 + as.factor(GSE32215_grupos))
rownames(GSE32215_design) <- GSE32215_sampleNames

colnames(GSE32215_design)

colnames(GSE32215_design) <- c("adult_TALL", 'pediatric_TALL')
head(GSE32215_design)

```

Las comparaciones que nos interesan son:

-¿Existe desregulación de las RBP entre grupos? No hay interacciones

adult T-ALL - pediatric T-ALL

```{r, warning=TRUE, error=FALSE}

library(limma)
cont.matrix <- makeContrasts(grupos_TALL = adult_TALL - pediatric_TALL, levels = GSE32215_design)
print(cont.matrix)

```



```{r, warning=TRUE, error=FALSE}
# save(GSE8879_Filtered, eset_GSE8879_Filtered,
     # GSE8879_geneIds, file =
       # "C:/Users/Copito/OneDrive/Documentos/Master bioinf y bioest/TFM/datasets/GSE8879/datos.normalizados.Rda")

library(limma)
fit <- lmFit(eset_GSE32215_Filtered, GSE32215_design)
fit.GSE32215 <- contrasts.fit(fit, cont.matrix)
fit.GSE32215 <- eBayes(fit.GSE32215)
head(rownames(fit.GSE32215))

```

La función topTable genera para cada contraste una lista de genes ordenados de mas a menos diferencialmente expresados.



```{r, warning=TRUE, error=TRUE}
topTab_GSE32215 <- topTable(fit.GSE32215, number = nrow(fit.GSE32215), coef = "grupos_TALL",
    adjust = "fdr")


head(topTab_GSE32215)
```


Para identificar los genes más diferencialmente expresados podemos utilizar la lista de anotaciones y añadir algunas a las topTables.

```{r, warning=TRUE, error=TRUE}
library(dplyr)
anotaTopTab <- function(topTab) {
    topTab_Anot <- topTab %>%
        mutate(PROBEID = rownames(topTab)) %>%
        merge(GSE32215_geneIds, "PROBEID") %>%
        arrange(adj.P.Val)
    return(topTab_Anot)
}
topTab_GSE32215_Anot <- anotaTopTab(topTab_GSE32215)
head(topTab_GSE32215_Anot)
```


```{r, warning=TRUE, error=TRUE}
save(topTab_GSE32215_Anot, file = 'C:/Users/Copito/OneDrive/Documentos/Master bioinf y bioest/TFM/datasets/GSE32215/GSE32215_topTabAnot.Rda')
```



Comparaciones múltiples



```{r, warning=TRUE, error=FALSE}
GSE32215_res <- decideTests(fit.GSE32215, method = "separate", adjust.method = "fdr", p.value = 0.05,
    lfc = 0)
```

Para resumir dicho análisis podemos contar qué filas tienen como mínimo una celda distinta de cero:



```{r, warning=TRUE, error=FALSE}
sum.GSE32215res.rows <- apply(abs(GSE32215_res), 1, sum)
GSE32215_res.selected <- GSE32215_res[sum.GSE32215res.rows != 0, ]
print(summary(GSE32215_res))
```


Si ahora visualizamos los resultados de cada comparación por separado, podemos observar como los volcano-plots concuerdan con la tabla anterior


```{r, warning=TRUE, error=FALSE}
xlimits <- c(-2, +3)
ylimits <- c(0, 25)
GSE32215_genenames <- topTab_GSE32215_Anot$SYMBOL
coef <- 1
volcanoplot(fit.GSE32215, highlight = 10, names = GSE32215_genenames, coef = coef, main = 'GSE32215_Anot', cex.main = 0.8, xlim = xlimits, ylim = ylimits)

abline(v = c(-1, 1))

```


Visualización de los perfiles de expresión


```{r, warning=TRUE, error=FALSE}
eset_GSE32215_Filtered
require(hgu133plus2.db)
```


```{r, warning=TRUE, error=FALSE}
probeNames <- rownames(GSE32215_res)
probeNames.selected <- probeNames[sum.GSE32215res.rows != 0]
exprs2cluster <- exprs(eset_GSE32215_Filtered)[probeNames.selected, ]
symbols <- AnnotationDbi::select(hgu133plus2.db, probeNames.selected,
    columns = "SYMBOL")[, 2]
colnames(exprs2cluster) <- GSE32215_sampleNames
rownames(exprs2cluster) <- symbols
color.map <- function(GSE32215_grupos) {
    if (GSE32215_grupos == "adult T-ALL") {
        c <- "yellow"
    } else {
        if (GSE32215_grupos == "pediatric T-ALL") {
            c <- "red"
        } else {c <- "green"}
        
    }
    return(c)
}

```


```{r, warning=TRUE, error=FALSE}
grupColors <- unlist(lapply(GSE32215_grupos, color.map))
heatmap(exprs2cluster, col = rainbow(100), ColSideColors = grupColors, cexCol = 0.9)

```


Mapa de colores basado en los genes seleccionados por estar diferencialmente expresados.

```{r, warning=TRUE, error=FALSE}
library("gplots")
heatmap.2(exprs2cluster, col=topo.colors(75), scale="none", ColSideColors=grupColors,
          key=TRUE, symkey=FALSE, density.info="none", trace="none", cexRow=0.5)
```






# GSE33469


## Selección de genes diferencialmente expresados



```{r, warning=TRUE, error=FALSE}
setwd('C:/Users/Copito/OneDrive/Documentos/Master bioinf y bioest/TFM/datasets/GSE33469/')
load(file = './GSE33469_datos.normalizados.Rda')
require(Biobase)
datadir <- "C:/Users/Copito/OneDrive/Documentos/Master bioinf y bioest/TFM/datasets/"
```



```{r, warning=TRUE, error=FALSE}
library(GEOquery)

GSE33469_getGEO <- getGEO("GSE33469", GSEMatrix =TRUE, AnnotGPL=TRUE, destdir = "C:/Users/Copito/OneDrive/Documentos/Master bioinf y bioest/TFM/datasets/GSE33469/" )

GSE33469_getGEO<-GSE33469_getGEO[[1]]



d<- substring(GSE33469_getGEO@phenoData@data[["title"]], 15)

cols=rep('red', 57)



GSE33469_sampleNames <- GSE33469_getGEO@phenoData@data[["title"]]

(GSE33469_grupos<-d)
```

Solo hay un grupo. No podemos hacer el análisis. Todas las muestras son de pacientes con T-ALL, sin diferenciaciones...


# GSE33470


## Selección de genes diferencialmente expresados


```{r, warning=TRUE, error=FALSE}
setwd('C:/Users/Copito/OneDrive/Documentos/Master bioinf y bioest/TFM/datasets/GSE33470/')
load(file = './GSE33470datos.normalizados.Rda')
require(Biobase)
datadir <- "C:/Users/Copito/OneDrive/Documentos/Master bioinf y bioest/TFM/datasets/"



# setwd('C:/Users/laura/OneDrive/Documentos/Cris/')
# load(file = './GSE33470datos.normalizados.Rda')
# require(Biobase)
# datadir <- "C:/Users/laura/OneDrive/Documentos/Cris/"

```



```{r, warning=TRUE, error=FALSE}
library(GEOquery)

# GSE33470_getGEO <- getGEO("GSE33470", GSEMatrix =TRUE, AnnotGPL=TRUE, destdir = "C:/Users/Copito/OneDrive/Documentos/Master bioinf y bioest/TFM/datasets/GSE33470/" )

# GSE33470_getGEO<-GSE33470_getGEO[[1]]


# GSE33470_sampleNames <- GSE33470_getGEO@phenoData@data[["title"]]

# GSE33470_grupos<-GSE33470_getGEO@phenoData@data[["characteristics_ch1"]]


GSE33470_getGEO <- getGEO("GSE33470", GSEMatrix =TRUE, AnnotGPL=TRUE, destdir = datadir )

GSE33470_getGEO<-GSE33470_getGEO[[1]]


GSE33470_sampleNames <- GSE33470_getGEO@phenoData@data[["title"]]
GSE33470_grupos<-GSE33470_getGEO@phenoData@data[["characteristics_ch1"]]


d<- GSE33470_getGEO@phenoData@data[["t-cell population:ch1"]]

cols=c()

for (valor in d){
  if (valor=="CD3+CD4+"){cols=append(cols, 'chartreuse4')}
  else if (valor=="CD3+CD8+"){cols=append(cols, 'aquamarine2')}
  else if (valor=="CD34+CD1a-"){cols=append(cols, 'blue4')}
  else if (valor=="CD34+CD1a+"){cols=append(cols, 'darkgray')}
  else if (valor=="CD4ISP"){cols=append(cols, 'darkorange')}
  else if (valor=="DPCD3-"){cols=append(cols, 'red1')}
  else {cols=append(cols, 'palevioletred2')}
}
 

GSE33470_grupos <- d

```


```{r, warning=TRUE, error=FALSE}


GSE33470_design <- model.matrix(~0 + as.factor(GSE33470_grupos))
rownames(GSE33470_design) <- GSE33470_sampleNames

colnames(GSE33470_design) <- c("CD3masCD4_mas", 'CD3masCD8_mas',
                               "CD34masCD1a_menos", 'CD34masCD1a_mas',
                               "CD4ISP", 'DPCD3_menos',
                               'DPCD3_mas')
head(GSE33470_design)

```

Los grupos son CD3+CD4+, CD3+CD8+, CD34+CD1a-, CD34+CD1a+, CD4ISP, DPCD3-, DPCD3+.

Las comparaciones que nos interesan son:

-¿Existe desregulación de las RBP entre grupos? No hay interacciones

CD3+CD4+   CD3+CD8+, CD3+CD4+    CD34+CD1a-, CD3+CD4+    CD34+CD1a+, CD3+CD4+    CD4ISP, CD3+CD4+    DPCD3-, CD3+CD4+    DPCD3+

CD3+CD8+    CD34+CD1a-, CD3+CD8+    CD34+CD1a+, CD3+CD8+    CD4ISP, CD3+CD8+    DPCD3-, CD3+CD8+    DPCD3+

CD34+CD1a-    CD34+CD1a+, CD34+CD1a-    CD4ISP, CD34+CD1a-    DPCD3-, CD34+CD1a-   DPCD3+

CD34+CD1a+    CD4ISP, CD34+CD1a+    DPCD3-, CD34+CD1a+    DPCD3+

CD4ISP   DPCD3-, CD4ISP   DPCD3+

DPCD3-  DPCD3+

-¿Existe desregulación de las RBP entre conjuntos de grupos? No hay interacciones

(CD3+CD4+  +  CD3+CD8+) - (CD34+CD1a-  +  CD34+CD1a+)

(CD3+CD4+  +  CD3+CD8+) - CD4ISP

(CD3+CD4+  +  CD3+CD8+) - (DPCD3-  +  DPCD3+)



(CD34+CD1a-  +  CD34+CD1a+) - CD4ISP

(CD34+CD1a-  +  CD34+CD1a+) - (DPCD3-  +  DPCD3+)


CD4ISP - (DPCD3-  +  DPCD3+)


```{r, warning=TRUE, error=FALSE}
lista_a<-list('CD3masCD4_mas', 'CD3masCD8_mas',
              'CD34masCD1a_menos', 'CD34masCD1a_mas',
              'CD4ISP', 'DPCD3_menos', 'DPCD3_mas')

lista_b<-list('CD3masCD4_mas + CD3masCD8_mas', 'CD34masCD1a_menos + CD34masCD1a_mas', 'CD4ISP', 'DPCD3_menos + DPCD3_mas')


```

CD3masCD4_mas CD3masCD8_mas CD34masCD1a_menos CD34masCD1a_mas CD4ISP DPCD3_menos DPCD3_mas

```{r, warning=TRUE, error=FALSE}

library(limma)
cont.matrix <- makeContrasts(CD3 = CD3masCD4_mas - CD3masCD8_mas,
                             
                             CD3masCD4_CD34masmenos= CD3masCD4_mas - CD34masCD1a_menos,
                             
                             CD3masCD4_CD34masmas= CD3masCD4_mas - CD34masCD1a_mas,
                             
                             
                             CD3masCD4_CD4= CD3masCD4_mas - CD4ISP,
                             
                             CD3masCD4_DPCD3menos= CD3masCD4_mas - DPCD3_menos,
                             
                             CD3masCD4_DPCD3mas= CD3masCD4_mas - DPCD3_mas,
                             
                             
                             CD3masCD8_CD34masmenos= CD3masCD8_mas - CD34masCD1a_menos,
                             
                             CD3masCD8_CD34masmas= CD3masCD8_mas - CD34masCD1a_mas,
                             
                             CD3masCD8_CD4= CD3masCD8_mas - CD4ISP,
                             
                             CD3masCD8_DPCD3menos= CD3masCD8_mas - DPCD3_menos,
                             
                             CD3masCD8_DPCD3mas= CD3masCD8_mas - DPCD3_mas,
                             
                             
                             
                             CD34= CD34masCD1a_menos - CD34masCD1a_mas,
                             
                             CD34masmenos_CD4= CD34masCD1a_menos - CD4ISP,
                             
                             CD34masmenos_DPCD3menos= CD34masCD1a_menos - DPCD3_menos,
                             
                             CD34masmenos_DPCD3mas= CD34masCD1a_menos - DPCD3_mas,
                             
                             
                             CD34masmas_CD4= CD34masCD1a_mas - CD4ISP,
                             
                             CD34masmas_DPCD3menos= CD34masCD1a_mas - DPCD3_menos,
                             
                             CD34masmas_DPCD3mas= CD34masCD1a_mas - DPCD3_mas,
                             
                             
                             
                             CD4_DPCD3menos= CD4ISP - DPCD3_menos,
                             
                             CD4_DPCD3mas= CD4ISP - DPCD3_mas,
                             

                             DPCD3= DPCD3_menos - DPCD3_mas,
                             
  
                             
                             CD3_CD34= (CD3masCD4_mas  +  CD3masCD8_mas)/2 - (CD34masCD1a_menos  +  CD34masCD1a_mas)/2, 
                             
                             CD3_CD4= (CD3masCD4_mas  +  CD3masCD8_mas)/2 - CD4ISP,
                             
                             CD3_DPCD3= (CD3masCD4_mas  +  CD3masCD8_mas)/2 - (DPCD3_menos  +  DPCD3_mas)/2,
                             
                             
                             
                             CD34_CD4= (CD34masCD1a_menos  +  CD34masCD1a_mas)/2 - CD4ISP, 
                             
                             CD34_DPCD3= (CD34masCD1a_menos  +  CD34masCD1a_mas)/2 - (DPCD3_menos  +  DPCD3_mas)/2, 
                             
                             
                             CD4_DPCD3= CD4ISP - (DPCD3_menos  +  DPCD3_mas)/2,
                             
                             
                             levels = GSE33470_design)


print(cont.matrix)

```

Ahora estimaremos el modelo. Una vez definida la matriz de diseño y los contrastes podemos pasar a estimar el modelo, estimar los contrastes y realizar las pruebas de significación que nos indiquen, para cada gen y cada comparación, si puede considerarse diferencialmente expresado.


```{r, warning=TRUE, error=FALSE}
# save(GSE8879_Filtered, eset_GSE8879_Filtered,
     # GSE8879_geneIds, file =
       # "C:/Users/Copito/OneDrive/Documentos/Master bioinf y bioest/TFM/datasets/GSE8879/datos.normalizados.Rda")

library(limma)
fit <- lmFit(eset_GSE33470_Filtered, GSE33470_design)
fit.GSE33470 <- contrasts.fit(fit, cont.matrix)
fit.GSE33470 <- eBayes(fit.GSE33470)
head(rownames(fit.GSE33470))

```

La función se ejecutó y le dio resultados, pero uno de los parámetros que generalmente se estima a partir de los datos no era estimable, por lo que usó un valor predeterminado.


La función topTable genera para cada contraste una lista de genes ordenados de mas a menos diferencialmente expresados.



```{r, warning=TRUE, error=FALSE}
topTab_GSE33470CD3 <- topTable(fit.GSE33470, number = nrow(fit.GSE33470), coef = "CD3",
    adjust = "fdr")

topTab_GSE33470CD3masCD4CD34masmeno <- topTable(fit.GSE33470, number = nrow(fit.GSE33470), coef = "CD3masCD4_CD34masmenos",
    adjust = "fdr")

topTab_GSE33470CD3masCD4CD34masmas <- topTable(fit.GSE33470, number = nrow(fit.GSE33470), coef = "CD3masCD4_CD34masmas",
    adjust = "fdr")

topTab_GSE33470CD3masCD4CD4 <- topTable(fit.GSE33470, number = nrow(fit.GSE33470), coef = "CD3masCD4_CD4",
    adjust = "fdr")

topTab_GSE33470CD3masCD4DPCD3menos <- topTable(fit.GSE33470, number = nrow(fit.GSE33470), coef = "CD3masCD4_DPCD3menos",
    adjust = "fdr")

topTab_GSE33470CD3masCD4DPCD3mas <- topTable(fit.GSE33470, number = nrow(fit.GSE33470), coef = "CD3masCD4_DPCD3mas",
    adjust = "fdr")

topTab_GSE33470CD3masCD8CD34masmenos <- topTable(fit.GSE33470, number = nrow(fit.GSE33470), coef = "CD3masCD8_CD34masmenos",
    adjust = "fdr")

topTab_GSE33470CD3masCD8CD34masmas <- topTable(fit.GSE33470, number = nrow(fit.GSE33470), coef = "CD3masCD8_CD34masmas",
    adjust = "fdr")

topTab_GSE33470CD3masCD8CD4 <- topTable(fit.GSE33470, number = nrow(fit.GSE33470), coef = "CD3masCD8_CD4",
    adjust = "fdr")

topTab_GSE33470CD3masCD8DPCD3menos <- topTable(fit.GSE33470, number = nrow(fit.GSE33470), coef = "CD3masCD8_DPCD3menos",
    adjust = "fdr")

topTab_GSE33470CD3masCD8DPCD3mas <- topTable(fit.GSE33470, number = nrow(fit.GSE33470), coef = "CD3masCD8_DPCD3mas",
    adjust = "fdr")

topTab_GSE33470CD34 <- topTable(fit.GSE33470, number = nrow(fit.GSE33470), coef = "CD34",
    adjust = "fdr")

topTab_GSE33470CD34masmenosCD4 <- topTable(fit.GSE33470, number = nrow(fit.GSE33470), coef = "CD34masmenos_CD4",
    adjust = "fdr")

topTab_GSE33470CD34masmenosDPCD3menos <- topTable(fit.GSE33470, number = nrow(fit.GSE33470), coef = "CD34masmenos_DPCD3menos",
    adjust = "fdr")

topTab_GSE33470CD34masmenosDPCD3mas <- topTable(fit.GSE33470, number = nrow(fit.GSE33470), coef = "CD34masmenos_DPCD3mas",
    adjust = "fdr")

topTab_GSE33470CD34masmasCD4 <- topTable(fit.GSE33470, number = nrow(fit.GSE33470), coef = "CD34masmas_CD4",
    adjust = "fdr")

topTab_GSE33470CD34masmasDPCD3menos <- topTable(fit.GSE33470, number = nrow(fit.GSE33470), coef = "CD34masmas_DPCD3menos",
    adjust = "fdr")

topTab_GSE33470CD34masmasDPCD3mas <- topTable(fit.GSE33470, number = nrow(fit.GSE33470), coef = "CD34masmas_DPCD3mas",
    adjust = "fdr")

topTab_GSE33470CD4DPCD3menos <- topTable(fit.GSE33470, number = nrow(fit.GSE33470), coef = "CD4_DPCD3menos",
    adjust = "fdr")

topTab_GSE33470CD4DPCD3mas <- topTable(fit.GSE33470, number = nrow(fit.GSE33470), coef = "CD4_DPCD3mas",
    adjust = "fdr")

topTab_GSE33470DPCD3 <- topTable(fit.GSE33470, number = nrow(fit.GSE33470), coef = "DPCD3",
    adjust = "fdr")

topTab_GSE33470CD3CD34 <- topTable(fit.GSE33470, number = nrow(fit.GSE33470), coef = "CD3_CD34",
    adjust = "fdr")

topTab_GSE33470CD3CD4 <- topTable(fit.GSE33470, number = nrow(fit.GSE33470), coef = "CD3_CD4",
    adjust = "fdr")

topTab_GSE33470CD3DPCD3 <- topTable(fit.GSE33470, number = nrow(fit.GSE33470), coef = "CD3_DPCD3",
    adjust = "fdr")

topTab_GSE33470CD34CD4 <- topTable(fit.GSE33470, number = nrow(fit.GSE33470), coef = "CD34_CD4",
    adjust = "fdr")

topTab_GSE33470CD34DPCD3 <- topTable(fit.GSE33470, number = nrow(fit.GSE33470), coef = "CD34_DPCD3",
    adjust = "fdr")

topTab_GSE33470CD4DPCD3 <- topTable(fit.GSE33470, number = nrow(fit.GSE33470), coef = "CD4_DPCD3",
    adjust = "fdr")


                             


head(topTab_GSE33470CD34CD4)
```



```{r, warning=TRUE, error=FALSE}
(list=ls())
```


Para identificar los genes más diferencialmente expresados podemos utilizar la lista de anotaciones y añadir algunas a las topTables.

```{r, warning=TRUE, error=FALSE}
library(dplyr)
anotaTopTab <- function(topTab) {
    topTab_Anot <- topTab %>%
        mutate(PROBEID = rownames(topTab)) %>%
        merge(GSE33470_geneIds, "PROBEID") %>%
        arrange(adj.P.Val)
    return(topTab_Anot)
}
topTab_GSE33470CD3_Anot <- anotaTopTab(topTab_GSE33470CD3)


topTab_GSE33470CD34_Anot <- anotaTopTab(topTab_GSE33470CD34)


topTab_GSE33470CD34CD4_Anot <- anotaTopTab(topTab_GSE33470CD34CD4)

topTab_GSE33470CD34DPCD3_Anot <- anotaTopTab(topTab_GSE33470CD34DPCD3)


topTab_GSE33470CD34masmasCD4_Anot <- anotaTopTab(topTab_GSE33470CD34masmasCD4)

topTab_GSE33470CD34masmasDPCD3mas_Anot <- anotaTopTab(topTab_GSE33470CD34masmasDPCD3mas)


topTab_GSE33470CD34masmasDPCD3menos_Anot <- anotaTopTab(topTab_GSE33470CD34masmasDPCD3menos)


topTab_GSE33470CD34masmenosCD4_Anot <- anotaTopTab(topTab_GSE33470CD34masmenosCD4)


topTab_GSE33470CD34masmenosDPCD3mas_Anot <- anotaTopTab(topTab_GSE33470CD34masmenosDPCD3mas)


topTab_GSE33470CD34masmenosDPCD3menos_Anot <- anotaTopTab(topTab_GSE33470CD34masmenosDPCD3menos)


topTab_GSE33470CD3CD34_Anot <- anotaTopTab(topTab_GSE33470CD3CD34)

topTab_GSE33470CD3CD4_Anot <- anotaTopTab(topTab_GSE33470CD3CD4)

topTab_GSE33470CD3DPCD3_Anot <- anotaTopTab(topTab_GSE33470CD3DPCD3)


topTab_GSE33470CD3masCD4CD34masmas_Anot <- anotaTopTab(topTab_GSE33470CD3masCD4CD34masmas)


topTab_GSE33470CD3masCD4CD34masmeno_Anot <- anotaTopTab(topTab_GSE33470CD3masCD4CD34masmeno)


topTab_GSE33470CD3masCD4CD4_Anot <- anotaTopTab(topTab_GSE33470CD3masCD4CD4)


topTab_GSE33470CD3masCD4DPCD3mas_Anot <- anotaTopTab(topTab_GSE33470CD3masCD4DPCD3mas)


topTab_GSE33470CD3masCD4DPCD3menos_Anot <- anotaTopTab(topTab_GSE33470CD3masCD4DPCD3menos)

topTab_GSE33470CD3masCD8CD34masmas_Anot <- anotaTopTab(topTab_GSE33470CD3masCD8CD34masmas)


topTab_GSE33470CD3masCD8CD34masmenos_Anot <- anotaTopTab(topTab_GSE33470CD3masCD8CD34masmenos)


topTab_GSE33470CD3masCD8CD4_Anot <- anotaTopTab(topTab_GSE33470CD3masCD8CD4)


topTab_GSE33470CD3masCD8DPCD3mas_Anot <- anotaTopTab(topTab_GSE33470CD3masCD8DPCD3mas)


topTab_GSE33470CD3masCD8DPCD3menos_Anot <- anotaTopTab(topTab_GSE33470CD3masCD8DPCD3menos)

topTab_GSE33470CD4DPCD3_Anot <- anotaTopTab(topTab_GSE33470CD4DPCD3)


topTab_GSE33470CD3masCD8DPCD3mas 




topTab_GSE33470CD4DPCD3mas_Anot <- anotaTopTab(topTab_GSE33470CD4DPCD3mas)


topTab_GSE33470CD4DPCD3menos_Anot <- anotaTopTab(topTab_GSE33470CD4DPCD3menos)


topTab_GSE33470DPCD3_Anot <- anotaTopTab(topTab_GSE33470DPCD3)




head(topTab_GSE33470CD3masCD8CD34masmenos_Anot)
```

```{r, warning=TRUE, error=FALSE}
# save(topTab_GSE33470CD3_Anot , topTab_GSE33470CD34_Anot, topTab_GSE33470CD34CD4_Anot, topTab_GSE33470CD34DPCD3_Anot, topTab_GSE33470CD34masmasCD4_Anot, topTab_GSE33470CD34masmasDPCD3mas_Anot, topTab_GSE33470CD34masmasDPCD3menos_Anot, topTab_GSE33470CD34masmenosCD4_Anot, topTab_GSE33470CD34masmenosDPCD3mas_Anot, topTab_GSE33470CD34masmenosDPCD3menos_Anot, topTab_GSE33470CD3CD34_Anot, topTab_GSE33470CD3CD4_Anot, topTab_GSE33470CD3DPCD3_Anot, topTab_GSE33470CD3masCD4CD34masmas_Anot, topTab_GSE33470CD3masCD4CD34masmeno_Anot, topTab_GSE33470CD3masCD4CD4_Anot, topTab_GSE33470CD3masCD4DPCD3mas_Anot, topTab_GSE33470CD3masCD4DPCD3menos_Anot, topTab_GSE33470CD3masCD8CD34masmas_Anot, topTab_GSE33470CD3masCD8CD34masmenos_Anot, topTab_GSE33470CD3masCD8CD4_Anot, topTab_GSE33470CD3masCD8DPCD3mas_Anot, topTab_GSE33470CD3masCD8DPCD3menos_Anot, topTab_GSE33470CD3masCD8DPCD3menos_Anot, topTab_GSE33470CD4DPCD3_Anot, topTab_GSE33470CD4DPCD3mas_Anot, topTab_GSE33470CD4DPCD3menos_Anot, topTab_GSE33470DPCD3_Anot,
  # file ="C:/Users/laura/OneDrive/Documentos/Cris/GSE33470topTabs_Anot.Rda")

save(topTab_GSE33470CD3_Anot , topTab_GSE33470CD34_Anot, topTab_GSE33470CD34CD4_Anot, topTab_GSE33470CD34DPCD3_Anot, topTab_GSE33470CD34masmasCD4_Anot, topTab_GSE33470CD34masmasDPCD3mas_Anot, topTab_GSE33470CD34masmasDPCD3menos_Anot, topTab_GSE33470CD34masmenosCD4_Anot, topTab_GSE33470CD34masmenosDPCD3mas_Anot, topTab_GSE33470CD34masmenosDPCD3menos_Anot, topTab_GSE33470CD3CD34_Anot, topTab_GSE33470CD3CD4_Anot, topTab_GSE33470CD3DPCD3_Anot, topTab_GSE33470CD3masCD4CD34masmas_Anot, topTab_GSE33470CD3masCD4CD34masmeno_Anot, topTab_GSE33470CD3masCD4CD4_Anot, topTab_GSE33470CD3masCD4DPCD3mas_Anot, topTab_GSE33470CD3masCD4DPCD3menos_Anot, topTab_GSE33470CD3masCD8CD34masmas_Anot, topTab_GSE33470CD3masCD8CD34masmenos_Anot, topTab_GSE33470CD3masCD8CD4_Anot, topTab_GSE33470CD3masCD8DPCD3mas_Anot, topTab_GSE33470CD3masCD8DPCD3menos_Anot, topTab_GSE33470CD3masCD8DPCD3menos_Anot, topTab_GSE33470CD4DPCD3_Anot, topTab_GSE33470CD4DPCD3mas_Anot, topTab_GSE33470CD4DPCD3menos_Anot, topTab_GSE33470DPCD3_Anot,
  file ="C:/Users/Copito/OneDrive/Documentos/Master bioinf y bioest/TFM/datasets/GSE33470/GSE33470topTabs_Anot.Rda")


```

Comparaciones múltiples


```{r, warning=TRUE, error=FALSE}
GSE33470_res <- decideTests(fit.GSE33470, method = "separate", adjust.method = "fdr", p.value = 0.05,
    lfc = 0)
head(GSE33470_res)
```

DPCD3 está llena de NA, la quitamos...

```{r, warning=TRUE, error=FALSE}
GSE33470_res <- GSE33470_res[,-21]
```

Para resumir dicho análisis podemos contar qué filas tienen como mínimo una celda distinta de cero:



```{r, warning=TRUE, error=FALSE}
sum.GSE33470res.rows <- apply(abs(GSE33470_res), 1, sum)
GSE33470_res.selected <- GSE33470_res[sum.GSE33470res.rows != 0, ]
print(summary(GSE33470_res))
```


Si ahora visualizamos los resultados de cada comparación por separado, podemos observar como los volcano-plots concuerdan con la tabla anterior. Haremos cuatro ejemplos de los que más genes tienen.


```{r, warning=TRUE, error=FALSE}
xlimits <- c(-3, +3)
ylimits <- c(0, 8)

GSE33470_genenames <- topTab_GSE33470CD3_Anot$SYMBOL


# topTab_GSE33470CD3_Anot , topTab_GSE33470CD34_Anot, topTab_GSE33470CD34CD4_Anot, topTab_GSE33470CD34DPCD3_Anot, topTab_GSE33470CD34masmasCD4_Anot, topTab_GSE33470CD34masmasDPCD3mas_Anot, topTab_GSE33470CD34masmasDPCD3menos_Anot, topTab_GSE33470CD34masmenosCD4_Anot, topTab_GSE33470CD34masmenosDPCD3mas_Anot, topTab_GSE33470CD34masmenosDPCD3menos_Anot, topTab_GSE33470CD3CD34_Anot, topTab_GSE33470CD3CD4_Anot, topTab_GSE33470CD3DPCD3_Anot, topTab_GSE33470CD3masCD4CD34masmas_Anot, topTab_GSE33470CD3masCD4CD34masmeno_Anot, topTab_GSE33470CD3masCD4CD4_Anot, topTab_GSE33470CD3masCD4DPCD3mas_Anot, topTab_GSE33470CD3masCD4DPCD3menos_Anot, topTab_GSE33470CD3masCD8CD34masmas_Anot, topTab_GSE33470CD3masCD8CD34masmenos_Anot, topTab_GSE33470CD3masCD8CD4_Anot, topTab_GSE33470CD3masCD8DPCD3mas_Anot, topTab_GSE33470CD3masCD8DPCD3menos_Anot, topTab_GSE33470CD3masCD8DPCD3menos_Anot, topTab_GSE33470CD4DPCD3_Anot, topTab_GSE33470CD4DPCD3mas_Anot, topTab_GSE33470CD4DPCD3menos_Anot, topTab_GSE33470DPCD3_Anot



coef <- 1

par(mfrow=c(1,1))

volcanoplot(fit.GSE33470, highlight = 10, names = GSE33470_genenames, coef = coef, main = paste("DEGS en comparación ",
    colnames(cont.matrix)[coef], sep = "\n"), cex.main = 0.8, xlim = xlimits, ylim = ylimits)

abline(v = c(-1, 1))


coef <- 2

GSE33470_genenames <- topTab_GSE33470CD34_Anot$SYMBOL # 2

volcanoplot(fit.GSE33470, highlight = 10, names = GSE33470_genenames, coef = coef, main = paste("DEGS en comparación ",
    colnames(cont.matrix)[coef], sep = "\n"), cex.main = 0.8, xlim = xlimits, ylim = ylimits)

abline(v = c(-1, 1))


coef <- 3


GSE33470_genenames <- topTab_GSE33470CD34CD4_Anot$SYMBOL # 3


volcanoplot(fit.GSE33470, highlight = 10, names = GSE33470_genenames, coef = coef, main = paste("DEGS en comparación ",
    colnames(cont.matrix)[coef], sep = "\n"), cex.main = 0.8, xlim = xlimits, ylim = ylimits)

abline(v = c(-1, 1))


coef <- 4

GSE33470_genenames <- topTab_GSE33470CD34DPCD3_Anot$SYMBOL # 4


volcanoplot(fit.GSE33470, highlight = 10, names = GSE33470_genenames, coef = coef, main = paste("DEGS en comparación ",
    colnames(cont.matrix)[coef], sep = "\n"), cex.main = 0.8, xlim = xlimits, ylim = ylimits)

abline(v = c(-1, 1))

coef <- 5

GSE33470_genenames <- topTab_GSE33470CD34masmasCD4_Anot$SYMBOL # 5


volcanoplot(fit.GSE33470, highlight = 10, names = GSE33470_genenames, coef = coef, main = paste("DEGS en comparación ",
    colnames(cont.matrix)[coef], sep = "\n"), cex.main = 0.8, xlim = xlimits, ylim = ylimits)

abline(v = c(-1, 1))

coef <- 6

GSE33470_genenames <- topTab_GSE33470CD34masmasDPCD3mas_Anot$SYMBOL # 6


volcanoplot(fit.GSE33470, highlight = 10, names = GSE33470_genenames, coef = coef, main = paste("DEGS en comparación ",
    colnames(cont.matrix)[coef], sep = "\n"), cex.main = 0.8, xlim = xlimits, ylim = ylimits)

abline(v = c(-1, 1))


coef <- 7

GSE33470_genenames <- topTab_GSE33470CD34masmasDPCD3menos_Anot$SYMBOL # 7


volcanoplot(fit.GSE33470, highlight = 10, names = GSE33470_genenames, coef = coef, main = paste("DEGS en comparación ",
    colnames(cont.matrix)[coef], sep = "\n"), cex.main = 0.8, xlim = xlimits, ylim = ylimits)

abline(v = c(-1, 1))


coef <- 8

GSE33470_genenames <- topTab_GSE33470CD34masmenosCD4_Anot$SYMBOL # 8


volcanoplot(fit.GSE33470, highlight = 10, names = GSE33470_genenames, coef = coef, main = paste("DEGS en comparación ",
    colnames(cont.matrix)[coef], sep = "\n"), cex.main = 0.8, xlim = xlimits, ylim = ylimits)

abline(v = c(-1, 1))


coef <- 9

GSE33470_genenames <- topTab_GSE33470CD34masmenosDPCD3mas_Anot$SYMBOL # 9


volcanoplot(fit.GSE33470, highlight = 10, names = GSE33470_genenames, coef = coef, main = paste("DEGS en comparación ",
    colnames(cont.matrix)[coef], sep = "\n"), cex.main = 0.8, xlim = xlimits, ylim = ylimits)

abline(v = c(-1, 1))


coef <- 10

GSE33470_genenames <- topTab_GSE33470CD34masmenosDPCD3menos_Anot$SYMBOL # 10


volcanoplot(fit.GSE33470, highlight = 10, names = GSE33470_genenames, coef = coef, main = paste("DEGS en comparación ",
    colnames(cont.matrix)[coef], sep = "\n"), cex.main = 0.8, xlim = xlimits, ylim = ylimits)

abline(v = c(-1, 1))


# topTab_GSE33470CD34masmenosCD4_Anot, topTab_GSE33470CD34masmenosDPCD3mas_Anot, topTab_GSE33470CD34masmenosDPCD3menos_Anot, topTab_GSE33470CD3CD34_Anot, topTab_GSE33470CD3CD4_Anot, topTab_GSE33470CD3DPCD3_Anot, 

coef <- 11

GSE33470_genenames <- topTab_GSE33470CD3CD34_Anot$SYMBOL # 11


volcanoplot(fit.GSE33470, highlight = 10, names = GSE33470_genenames, coef = coef, main = paste("DEGS en comparación ",
    colnames(cont.matrix)[coef], sep = "\n"), cex.main = 0.8, xlim = xlimits, ylim = ylimits)

abline(v = c(-1, 1))

coef <- 12

GSE33470_genenames <- topTab_GSE33470CD3CD4_Anot$SYMBOL # 12


volcanoplot(fit.GSE33470, highlight = 10, names = GSE33470_genenames, coef = coef, main = paste("DEGS en comparación ",
    colnames(cont.matrix)[coef], sep = "\n"), cex.main = 0.8, xlim = xlimits, ylim = ylimits)

abline(v = c(-1, 1))

coef <- 13

GSE33470_genenames <- topTab_GSE33470CD3DPCD3_Anot$SYMBOL # 13


volcanoplot(fit.GSE33470, highlight = 10, names = GSE33470_genenames, coef = coef, main = paste("DEGS en comparación ",
    colnames(cont.matrix)[coef], sep = "\n"), cex.main = 0.8, xlim = xlimits, ylim = ylimits)

abline(v = c(-1, 1))

coef <- 14

GSE33470_genenames <- topTab_GSE33470CD3masCD4CD34masmas_Anot$SYMBOL # 14


volcanoplot(fit.GSE33470, highlight = 10, names = GSE33470_genenames, coef = coef, main = paste("DEGS en comparación ",
    colnames(cont.matrix)[coef], sep = "\n"), cex.main = 0.8, xlim = xlimits, ylim = ylimits)

abline(v = c(-1, 1))


coef <- 15
GSE33470_genenames <- topTab_GSE33470CD3masCD4CD34masmeno_Anot$SYMBOL # 15


volcanoplot(fit.GSE33470, highlight = 10, names = GSE33470_genenames, coef = coef, main = paste("DEGS en comparación ",
    colnames(cont.matrix)[coef], sep = "\n"), cex.main = 0.8, xlim = xlimits, ylim = ylimits)

abline(v = c(-1, 1))


coef <- 16

GSE33470_genenames <- topTab_GSE33470CD3masCD4CD4_Anot$SYMBOL # 16


volcanoplot(fit.GSE33470, highlight = 10, names = GSE33470_genenames, coef = coef, main = paste("DEGS en comparación ",
    colnames(cont.matrix)[coef], sep = "\n"), cex.main = 0.8, xlim = xlimits, ylim = ylimits)

abline(v = c(-1, 1))

# topTab_GSE33470CD3masCD4CD34masmas_Anot, topTab_GSE33470CD3masCD4CD34masmeno_Anot, topTab_GSE33470CD3masCD4CD4_Anot, topTab_GSE33470CD3masCD4DPCD3mas_Anot, topTab_GSE33470CD3masCD4DPCD3menos_Anot, topTab_GSE33470CD3masCD8CD34masmas_Anot, topTab_GSE33470CD3masCD8CD34masmenos_Anot, topTab_GSE33470CD3masCD8CD4_Anot, topTab_GSE33470CD3masCD8DPCD3mas_Anot, topTab_GSE33470CD3masCD8DPCD3menos_Anot, topTab_GSE33470CD3masCD8DPCD3menos_Anot, topTab_GSE33470CD4DPCD3_Anot, topTab_GSE33470CD4DPCD3mas_Anot, topTab_GSE33470CD4DPCD3menos_Anot, topTab_GSE33470DPCD3_Anot

coef <- 17

GSE33470_genenames <- topTab_GSE33470CD3masCD4DPCD3mas_Anot$SYMBOL # 17


volcanoplot(fit.GSE33470, highlight = 10, names = GSE33470_genenames, coef = coef, main = paste("DEGS en comparación ",
    colnames(cont.matrix)[coef], sep = "\n"), cex.main = 0.8, xlim = xlimits, ylim = ylimits)

abline(v = c(-1, 1))


coef <- 18

GSE33470_genenames <- topTab_GSE33470CD3masCD4DPCD3menos_Anot$SYMBOL # 18


volcanoplot(fit.GSE33470, highlight = 10, names = GSE33470_genenames, coef = coef, main = paste("DEGS en comparación ",
    colnames(cont.matrix)[coef], sep = "\n"), cex.main = 0.8, xlim = xlimits, ylim = ylimits)

abline(v = c(-1, 1))


coef <- 19

GSE33470_genenames <- topTab_GSE33470CD3masCD8CD34masmas_Anot$SYMBOL # 19


volcanoplot(fit.GSE33470, highlight = 10, names = GSE33470_genenames, coef = coef, main = paste("DEGS en comparación ",
    colnames(cont.matrix)[coef], sep = "\n"), cex.main = 0.8, xlim = xlimits, ylim = ylimits)

abline(v = c(-1, 1))


coef <- 20

GSE33470_genenames <- topTab_GSE33470CD3masCD8CD34masmenos_Anot$SYMBOL # 20


volcanoplot(fit.GSE33470, highlight = 10, names = GSE33470_genenames, coef = coef, main = paste("DEGS en comparación ",
    colnames(cont.matrix)[coef], sep = "\n"), cex.main = 0.8, xlim = xlimits, ylim = ylimits)

abline(v = c(-1, 1))


coef <- 21
GSE33470_genenames <- topTab_GSE33470CD3masCD8CD4_Anot$SYMBOL # 21


volcanoplot(fit.GSE33470, highlight = 10, names = GSE33470_genenames, coef = coef, main = paste("DEGS en comparación ",
    colnames(cont.matrix)[coef], sep = "\n"), cex.main = 0.8, xlim = xlimits, ylim = ylimits)

abline(v = c(-1, 1))

coef <- 22
GSE33470_genenames <- topTab_GSE33470CD3masCD8DPCD3mas_Anot$SYMBOL # 22


volcanoplot(fit.GSE33470, highlight = 10, names = GSE33470_genenames, coef = coef, main = paste("DEGS en comparación ",
    colnames(cont.matrix)[coef], sep = "\n"), cex.main = 0.8, xlim = xlimits, ylim = ylimits)

abline(v = c(-1, 1))


# topTab_GSE33470CD3masCD8CD34masmenos_Anot, topTab_GSE33470CD3masCD8CD4_Anot, topTab_GSE33470CD3masCD8DPCD3mas_Anot, topTab_GSE33470CD3masCD8DPCD3menos_Anot, topTab_GSE33470CD4DPCD3_Anot, topTab_GSE33470CD4DPCD3mas_Anot, topTab_GSE33470CD4DPCD3menos_Anot, topTab_GSE33470DPCD3_Anot

coef <- 23
GSE33470_genenames <- topTab_GSE33470CD3masCD8DPCD3menos_Anot$SYMBOL # 23


volcanoplot(fit.GSE33470, highlight = 10, names = GSE33470_genenames, coef = coef, main = paste("DEGS en comparación ",
    colnames(cont.matrix)[coef], sep = "\n"), cex.main = 0.8, xlim = xlimits, ylim = ylimits)

abline(v = c(-1, 1))

coef <- 24
GSE33470_genenames <- topTab_GSE33470CD4DPCD3_Anot$SYMBOL # 24


volcanoplot(fit.GSE33470, highlight = 10, names = GSE33470_genenames, coef = coef, main = paste("DEGS en comparación ",
    colnames(cont.matrix)[coef], sep = "\n"), cex.main = 0.8, xlim = xlimits, ylim = ylimits)

abline(v = c(-1, 1))


coef <- 25
GSE33470_genenames <- topTab_GSE33470CD4DPCD3mas_Anot$SYMBOL # 25


volcanoplot(fit.GSE33470, highlight = 10, names = GSE33470_genenames, coef = coef, main = paste("DEGS en comparación ",
    colnames(cont.matrix)[coef], sep = "\n"), cex.main = 0.8, xlim = xlimits, ylim = ylimits)

abline(v = c(-1, 1))

coef <- 26
GSE33470_genenames <- topTab_GSE33470CD4DPCD3menos_Anot$SYMBOL # 26


volcanoplot(fit.GSE33470, highlight = 10, names = GSE33470_genenames, coef = coef, main = paste("DEGS en comparación ",
    colnames(cont.matrix)[coef], sep = "\n"), cex.main = 0.8, xlim = xlimits, ylim = ylimits)

abline(v = c(-1, 1))

coef <- 27
GSE33470_genenames <- topTab_GSE33470DPCD3_Anot$SYMBOL # 27


volcanoplot(fit.GSE33470, highlight = 10, names = GSE33470_genenames, coef = coef, main = paste("DEGS en comparación ",
    colnames(cont.matrix)[coef], sep = "\n"), cex.main = 0.8, xlim = xlimits, ylim = ylimits)

abline(v = c(-1, 1))

```

```{r, warning=TRUE, error=FALSE}
GSE33470_genenames <- c(topTab_GSE33470CD3_Anot , topTab_GSE33470CD34_Anot, topTab_GSE33470CD34CD4_Anot, topTab_GSE33470CD34DPCD3_Anot, topTab_GSE33470CD34masmasCD4_Anot, topTab_GSE33470CD34masmasDPCD3mas_Anot, topTab_GSE33470CD34masmasDPCD3menos_Anot, topTab_GSE33470CD34masmenosCD4_Anot, topTab_GSE33470CD34masmenosDPCD3mas_Anot, topTab_GSE33470CD34masmenosDPCD3menos_Anot, topTab_GSE33470CD3CD34_Anot, topTab_GSE33470CD3CD4_Anot, topTab_GSE33470CD3DPCD3_Anot, topTab_GSE33470CD3masCD4CD34masmas_Anot, topTab_GSE33470CD3masCD4CD34masmeno_Anot, topTab_GSE33470CD3masCD4CD4_Anot, topTab_GSE33470CD3masCD4DPCD3mas_Anot, topTab_GSE33470CD3masCD4DPCD3menos_Anot, topTab_GSE33470CD3masCD8CD34masmas_Anot, topTab_GSE33470CD3masCD8CD34masmenos_Anot, topTab_GSE33470CD3masCD8CD4_Anot, topTab_GSE33470CD3masCD8DPCD3mas_Anot, topTab_GSE33470CD3masCD8DPCD3menos_Anot, topTab_GSE33470CD3masCD8DPCD3menos_Anot, topTab_GSE33470CD4DPCD3_Anot, topTab_GSE33470CD4DPCD3mas_Anot, topTab_GSE33470CD4DPCD3menos_Anot, topTab_GSE33470DPCD3_Anot) 

xlimits <- c(-3, +3)
ylimits <- c(0, 8)

volcanoplot(fit.GSE33470, highlight = 10, names = GSE33470_genenames, coef = 27, main = 'GSE33470', cex.main = 0.8, xlim = xlimits, ylim = ylimits)

abline(v = c(-1, 1))
union(topTab_GSE33470DPCD3_Anot$SYMBOL, topTab_GSE33470CD4DPCD3menos_Anot$SYMBOL)



```


Visualización de los perfiles de expresión



```{r, warning=TRUE, error=FALSE}
eset_GSE33470_Filtered
require(illuminaHumanv4.db)
```


```{r, warning=TRUE, error=FALSE}


                                 
probeNames <- rownames(GSE33470_res)
probeNames.selected <- probeNames[sum.GSE33470res.rows != 0]
exprs2cluster <- exprs(eset_GSE33470_Filtered)[probeNames.selected, ]
symbols <- AnnotationDbi::select(illuminaHumanv4.db, probeNames.selected,
    columns = "SYMBOL")[, 2]
colnames(exprs2cluster) <- GSE33470_sampleNames
rownames(exprs2cluster) <- symbols


color.map <- function(GSE33470_grupos) {
  
  if (GSE33470_grupos == "CD3+CD4+") {c <- "tan3"}
  
  else if (GSE33470_grupos == "CD3+CD8+") {c <- "red"}
  
  else if (GSE33470_grupos == "CD34+CD1a-") {c <- "blue"}
  
  else if (GSE33470_grupos == "CD34+CD1a+") {c <- "coral2"}
  
  else if (GSE33470_grupos == "CD4ISP") {c <- "yellow3"}
  
  else if (GSE33470_grupos == "DPCD3-") {c <- "thistle2"}
  
  else { # DPCD3+ 
    c <- "springgreen2"}

    return(c)
}

```


```{r, warning=TRUE, error=TRUE}
grupColors <- unlist(lapply(GSE33470_grupos, color.map))
heatmap(exprs2cluster, col = rainbow(100), ColSideColors = grupColors, cexCol = 0.9)

```



Mapa de colores basado en los genes seleccionados por estar diferencialmente expresados.

```{r, warning=TRUE, error=TRUE}
grupColors <- unlist(lapply(GSE33470_grupos, color.map))
library("gplots")
heatmap.2(exprs2cluster, col=topo.colors(75), scale="none", ColSideColors=grupColors,
          key=TRUE, symkey=FALSE, density.info="none", trace="none", cexRow=0.5)
```



# GSE37389


## Selección de genes diferencialmente expresados


```{r, warning=TRUE, error=FALSE}
setwd('C:/Users/Copito/OneDrive/Documentos/Master bioinf y bioest/TFM/datasets/GSE37389/')
load(file = './GSE37389datos.normalizados.Rda')
require(Biobase)
datadir <- "C:/Users/Copito/OneDrive/Documentos/Master bioinf y bioest/TFM/datasets/"



# setwd('C:/Users/laura/OneDrive/Documentos/Cris/')
# library("readxl")
# read_excel("C:/Users/laura/OneDrive/Documentos/Cris/GSE37389_geneIds.xlsx")
# load(file = './GSE37389datos.normalizados.Rda')
# require(Biobase)
# datadir <- "C:/Users/laura/OneDrive/Documentos/Cris/"

```



```{r, warning=TRUE, error=FALSE}
library(GEOquery)

# GSE37389_getGEO <- getGEO("GSE37389", GSEMatrix =TRUE, AnnotGPL=TRUE, destdir = "C:/Users/Copito/OneDrive/Documentos/Master bioinf y bioest/TFM/datasets/GSE37389/" )

# GSE37389_getGEO<-GSE37389_getGEO[[1]]


# GSE37389_sampleNames <- GSE37389_getGEO@phenoData@data[["title"]]

# GSE37389_grupos<-GSE37389_getGEO@phenoData@data[["characteristics_ch1"]]


GSE37389_getGEO <- getGEO("GSE37389", GSEMatrix =TRUE, AnnotGPL=TRUE, destdir = datadir )

GSE37389_getGEO<-GSE37389_getGEO[[1]]


GSE37389_sampleNames <- GSE37389_getGEO@phenoData@data[["title"]]
GSE37389_grupos<-GSE37389_getGEO@phenoData@data[["characteristics_ch1"]]


d<- substring(GSE37389_getGEO@phenoData@data[["title"]], 5, 10)

cols=c()

for (valor in d){
  if (valor=="TCR-AB"){cols=append(cols, 'red')}
  else if (valor=="TCR-GD"){cols=append(cols, 'blue')}
  else {cols=append(cols, 'goldenrod1')}
}
 
GSE37389_grupos <- d


```


```{r, warning=TRUE, error=FALSE}


GSE37389_design <- model.matrix(~0 + as.factor(GSE37389_grupos))
rownames(GSE37389_design) <- GSE37389_sampleNames

colnames(GSE37389_design) <- c('TCR_AB', 'TCR_GD')
head(GSE37389_design)

```

Los grupos son TCR_AB y TCR_GD.

La comparación que nos interesa es:

-¿Existe desregulación de las RBP entre grupos? No hay interacciones

TCR_AB - TCR_GD

```{r, warning=TRUE, error=FALSE}

library(limma)
cont.matrix <- makeContrasts(gruposTCR = TCR_AB - TCR_GD,

                             levels = GSE37389_design)


print(cont.matrix)

```

Ahora estimaremos el modelo. Una vez definida la matriz de diseño y los contrastes podemos pasar a estimar el modelo, estimar los contrastes y realizar las pruebas de significación que nos indiquen, para cada gen y cada comparación, si puede considerarse diferencialmente expresado.


```{r, warning=TRUE, error=FALSE}
# save(GSE8879_Filtered, eset_GSE8879_Filtered,
     # GSE8879_geneIds, file =
       # "C:/Users/Copito/OneDrive/Documentos/Master bioinf y bioest/TFM/datasets/GSE8879/datos.normalizados.Rda")

library(limma)
fit <- lmFit(eset_GSE37389_Filtered, GSE37389_design)
fit.GSE37389 <- contrasts.fit(fit, cont.matrix)
fit.GSE37389 <- eBayes(fit.GSE37389)
head(rownames(fit.GSE37389))

```

La función se ejecutó y le dio resultados, pero uno de los parámetros que generalmente se estima a partir de los datos no era estimable, por lo que usó un valor predeterminado.


La función topTable genera para cada contraste una lista de genes ordenados de mas a menos diferencialmente expresados.



```{r, warning=TRUE, error=FALSE}
topTab_GSE37389 <- topTable(fit.GSE37389, number = nrow(fit.GSE37389), coef = "gruposTCR",
    adjust = "fdr")


head(topTab_GSE37389)
```



```{r, warning=TRUE, error=FALSE}
(list=ls())
```


Para identificar los genes más diferencialmente expresados podemos utilizar la lista de anotaciones y añadir algunas a las topTables.

```{r, warning=TRUE, error=FALSE}
library(dplyr)
anotaTopTab <- function(topTab) {
    topTab_Anot <- topTab %>%
        mutate(PROBEID = rownames(topTab)) %>%
        merge(GSE37389_geneIds, "PROBEID") %>%
        arrange(adj.P.Val)
    return(topTab_Anot)
}
topTab_GSE37389_Anot <- anotaTopTab(topTab_GSE37389)



head(topTab_GSE37389_Anot)
```

```{r, warning=TRUE, error=FALSE}
# save(topTab_GSE37389_Anot,
  # file ="C:/Users/laura/OneDrive/Documentos/Cris/GSE37389topTab_Anot.Rda")

save(topTab_GSE37389_Anot,
  file ="C:/Users/Copito/OneDrive/Documentos/Master bioinf y bioest/TFM/datasets/GSE37389/GSE37389topTab_Anot.Rda")


```

Comparaciones múltiples


```{r, warning=TRUE, error=FALSE}
GSE37389_res <- decideTests(fit.GSE37389, method = "separate", adjust.method = "fdr", p.value = 0.05,
    lfc = 0)
table(GSE37389_res)
```

No hay genes...

Para resumir dicho análisis podemos contar qué filas tienen como mínimo una celda distinta de cero:



```{r, warning=TRUE, error=FALSE}
sum.GSE37389res.rows <- apply(abs(GSE37389_res), 1, sum)
GSE37389_res.selected <- GSE37389_res[sum.GSE37389res.rows != 0, ]
print(summary(GSE37389_res))
```

No hay genes significativos.......

```{r, warning=TRUE, error=FALSE}
xlimits <- c(-3, +3)
ylimits <- c(0, 3)
genenames <- topTab_GSE37389_Anot$SYMBOL
coef <- 1
volcanoplot(fit.GSE37389, highlight = 10, names = genenames, coef = coef, main = paste("DEGS en comparación ",                                                 colnames(cont.matrix)[coef], sep = "\n"), cex.main = 0.8, xlim = xlimits, ylim = ylimits)
abline(v = c(-1, 1))

abline(h=(-log10(0.05)), col="blue")

```


```{r, warning=TRUE, error=FALSE}
library(hgug4112a.db)

probeNames <- rownames(GSE37389_res)
probeNames.selected <- probeNames[sum.GSE37389res.rows != 0]
(exprs2cluster <- exprs(eset_GSE37389_Filtered)[probeNames.selected, ])

symbols <- AnnotationDbi::select(hgug4112a.db, probeNames.selected,
    columns = "SYMBOL")[, 2]

char<-GSE37389_getGEO@phenoData@data[["characteristics_ch1"]] 

shortNames <- GSE37389_getGEO@phenoData@data[["title"]]

# TCR-GD indica TCR gamma delta T-ALL. TCR-AB es alfa beta

(GSE37389_getGEO@phenoData@data[["characteristics_ch1"]]) 

d<- substring(GSE37389_getGEO@phenoData@data[["title"]], 5, 10)

cols=c()

for (valor in d){
  if (valor=="TCR-AB"){cols=append(cols, 'red')}
  else if (valor=="TCR-GD"){cols=append(cols, 'blue')}
  else {cols=append(cols, 'goldenrod1')}
}
 

grup <- d


colnames(exprs2cluster) <- shortNames
rownames(exprs2cluster) <- symbols


```


```{r, warning=TRUE, error=TRUE}

color.map <- function(grup) {
  
  if (grup == "TCR-AB") {c <- "red"}
  
  else if (grup == "TCR-GD") {c <- "blue"}

  else { # DPCD3+ 
    c <- "springgreen2"}

    return(c)
}


grupColors <- unlist(lapply(grup, color.map))
heatmap(exprs2cluster, col = rainbow(100), ColSideColors = grupColors, cexCol = 0.9)

```

# GSE56488

## Selección de genes diferencialmente expresados


```{r, warning=TRUE, error=FALSE}
setwd('C:/Users/Copito/OneDrive/Documentos/Master bioinf y bioest/TFM/datasets/GSE56488/')
load(file = './datos.normalizados.Rda')
require(Biobase)
datadir <- "C:/Users/Copito/OneDrive/Documentos/Master bioinf y bioest/TFM/datasets/GSE56488/"

library("readxl")
read_excel('./GSE56488_geneIds.xlsx')



# setwd('C:/Users/laura/OneDrive/Documentos/Cris/')
# library("readxl")
# read_excel("C:/Users/laura/OneDrive/Documentos/Cris/GSE56488_geneIds.xlsx")
# load(file = './GSE56488datos.normalizados.Rda')
# require(Biobase)
# datadir <- "C:/Users/laura/OneDrive/Documentos/Cris/"

```



```{r, warning=TRUE, error=FALSE}
library(GEOquery)

GSE56488_getGEO <- getGEO("GSE56488", GSEMatrix =TRUE, AnnotGPL=TRUE, destdir = "C:/Users/Copito/OneDrive/Documentos/Master bioinf y bioest/TFM/datasets/GSE56488/" )

GSE56488_getGEO<-GSE56488_getGEO[[1]]


GSE56488_sampleNames <- GSE56488_getGEO@phenoData@data[["title"]]

GSE56488_grupos<-GSE56488_getGEO@phenoData@data[["characteristics_ch1"]]

#---

# GSE56488_getGEO <- getGEO("GSE56488", GSEMatrix =TRUE, AnnotGPL=TRUE, destdir = datadir )

# GSE56488_getGEO<-GSE56488_getGEO[[1]]


GSE56488_sampleNames <- GSE56488_getGEO@phenoData@data[["title"]]


d=substring(GSE56488_getGEO@phenoData@data[["characteristics_ch1.1"]], 23, 27)


GSE56488_grupos<-d

```


```{r, warning=TRUE, error=FALSE}


GSE56488_design <- model.matrix(~0 + as.factor(GSE56488_grupos))
rownames(GSE56488_design) <- GSE56488_sampleNames

colnames(GSE56488_design) <- c('long', 'short')
head(GSE56488_design)

```

Los grupos son long y short. Hacen referencia a "engraftment kinetics: short", y  "engraftment kinetics: long". O sea, la cinética del injerto. Vamos a comparar ambos grupos aunque tengan que ver con el tratamiento de la enfermedad, que no nos interesa...



-¿Existe desregulación de las RBP entre grupos? No hay interacciones

long  - short

```{r, warning=TRUE, error=FALSE}

library(limma)
cont.matrix <- makeContrasts(gruposkinetics = long - short,

                             levels = GSE56488_design)


print(cont.matrix)

```

Ahora estimaremos el modelo. Una vez definida la matriz de diseño y los contrastes podemos pasar a estimar el modelo, estimar los contrastes y realizar las pruebas de significación que nos indiquen, para cada gen y cada comparación, si puede considerarse diferencialmente expresado.


```{r, warning=TRUE, error=FALSE}
# save(GSE56488_Filtered, eset_GSE56488_Filtered,
     # GSE56488_geneIds, file =
       # "C:/Users/Copito/OneDrive/Documentos/Master bioinf y bioest/TFM/datasets/GSE56488/datos.normalizados.Rda")

library(limma)
fit <- lmFit(eset_GSE56488_Filtered, GSE56488_design)
fit.GSE56488 <- contrasts.fit(fit, cont.matrix)
fit.GSE56488 <- eBayes(fit.GSE56488)
head(rownames(fit.GSE56488))

```

La función se ejecutó y le dio resultados, pero uno de los parámetros que generalmente se estima a partir de los datos no era estimable, por lo que usó un valor predeterminado.


La función topTable genera para cada contraste una lista de genes ordenados de mas a menos diferencialmente expresados.



```{r, warning=TRUE, error=FALSE}
topTab_GSE56488 <- topTable(fit.GSE56488, number = nrow(fit.GSE56488), coef = "gruposkinetics",
    adjust = "fdr")


head(topTab_GSE56488)
```


Para identificar los genes más diferencialmente expresados podemos utilizar la lista de anotaciones y añadir algunas a las topTables.

```{r, warning=TRUE, error=FALSE}
library(dplyr)
anotaTopTab <- function(topTab) {
    topTab_Anot <- topTab %>%
        mutate(PROBEID = rownames(topTab)) %>%
        merge(GSE56488_geneIds, "PROBEID") %>%
        arrange(adj.P.Val)
    return(topTab_Anot)
}
topTab_GSE56488_Anot <- anotaTopTab(topTab_GSE56488)



head(topTab_GSE56488_Anot)
```

```{r, warning=TRUE, error=FALSE}
# save(topTab_GSE37389_Anot,
  # file ="C:/Users/laura/OneDrive/Documentos/Cris/GSE56488topTab_Anot.Rda")

save(topTab_GSE56488_Anot,
  file ="C:/Users/Copito/OneDrive/Documentos/Master bioinf y bioest/TFM/GSE56488topTab_Anot.Rda")

```

Comparaciones múltiples


```{r, warning=TRUE, error=FALSE}
GSE56488_res <- decideTests(fit.GSE56488, method = "separate", adjust.method = "fdr", p.value = 0.05,
    lfc = 0)
table(GSE56488_res)
```

No hay genes diferencialmente expresados...

Para resumir dicho análisis podemos contar qué filas tienen como mínimo una celda distinta de cero:



```{r, warning=TRUE, error=FALSE}
sum.GSE56488res.rows <- apply(abs(GSE56488_res), 1, sum)
GSE56488_res.selected <- GSE56488_res[sum.GSE56488res.rows != 0, ]
print(summary(GSE56488_res))
```

Claro, los grupos no se diferencian entre sí significativamente, ya que tienen que ver con grupos de injertos, y no con algo referente al tipo o etapa de la enfermedad.

```{r, warning=TRUE, error=FALSE}
par(mfrow = c(1, 1))
xlimits <- c(-2.5, +2.5)
ylimits <- c(0, 4)
GSE56488_genenames <- topTab_GSE56488_Anot$SYMBOL # Immature_MLL
coef <- 1

volcanoplot(fit.GSE56488, highlight = 10, names = GSE56488_genenames, coef = coef, main = paste("DEGS en comparación ",
    colnames(cont.matrix)[coef], sep = "\n"), cex.main = 0.8, xlim = xlimits, ylim = ylimits)
abline(v = c(-1, 1))


par(mfrow = c(1, 1))


```



# GSE62156



## Selección de genes diferencialmente expresados


```{r, warning=TRUE, error=FALSE}
setwd('C:/Users/Copito/OneDrive/Documentos/Master bioinf y bioest/TFM/datasets/GSE62156/')
# setwd('C:/Users/laura/OneDrive/Documentos/Cris/')
load(file = './GSE62156datos.normalizados.Rda')
require(Biobase)
datadir <- "C:/Users/Copito/OneDrive/Documentos/Master bioinf y bioest/TFM/datasets/GSE62156/"
# datadir <- "C:/Users/laura/OneDrive/Documentos/Cris/"
```



```{r, warning=TRUE, error=FALSE}
library(GEOquery)

GSE62156_getGEO <- getGEO("GSE62156", GSEMatrix =TRUE, AnnotGPL=TRUE, destdir = datadir )

GSE62156_getGEO<-GSE62156_getGEO[[1]]


GSE62156_sampleNames <- substring(GSE62156_getGEO@phenoData@data[["title"]], 1, 7)
GSE62156_grupos<-c('TAL-R', 'immature', 'TLX3', 'immature', 'immature', 'CALM-AF10', 'immature', 'TAL-R', 'TLX3', 'TLX3', 'MLL-t', 'TAL-R', 'TAL-R', 'HOX', 'TAL-R', 'TAL-R', 'immature', 'immature, HOXA13-t', 'TLX3', 'immature', 'TAL-R', 'immature', 'HOXA of unknown mechanism', 'TAL-R', 'TAL-R', 'TLX3', 'immature', 'TLX3', 'immature', 'immature', 'TLX1', 'TAL-R', 'immature', 'TAL-R', 'MLL-t', 'TAL-R', 'TLX1', 'immature', 'TLX3', 'unknown', 'TAL-R', 'TAL-R', 'TAL-R', 'TAL-R', 'TLX3', 'immature', rep('TAL-R', 8), 'TLX1', 'TLX1', 'TLX3', 'TLX3', 'TLX3', 'TLX1', 'MLL-t', 'TLX3', 'immature, HOXA13-t', 'TAL-R') 



cols=c()

for (valor in GSE62156_grupos){
  if (valor=="CALM-AF10"){cols=append(cols, 'red')}
  else if (valor=="HOX"){cols=append(cols, 'blue')}
  else if (valor=="HOXA of unknown mechanism"){cols=append(cols, 'black')}
  else if (valor=="immature"){cols=append(cols, 'purple')}
  else if (valor=="immature, HOXA13-t"){cols=append(cols, 'green')}
  else if (valor=="MLL-t"){cols=append(cols, 'pink')}
  else if (valor=="TAL-R"){cols=append(cols, 'lightgoldenrod2')}
  else if (valor=="TLX1"){cols=append(cols, 'forestgreen')}
  else if (valor=="TLX3"){cols=append(cols, 'gray3')}
  else if (valor=="unknown"){cols=append(cols, 'azure4')}
  else {cols=append(cols, 'goldenrod1')}
}
 

GSE62156_colores <- cols
```


```{r, warning=TRUE, error=FALSE}
GSE62156_design <- model.matrix(~0 + as.factor(GSE62156_grupos))
rownames(GSE62156_design) <- GSE62156_sampleNames

colnames(GSE62156_design) <- c("CALM_AF10", 'HOX',
                               'HOXA_of_Unknown_Mechanism',
                               'Immature',
                               'Immature_HOXA13_t', 'MLL_t',
                               'TAL_R', 'TLX1', 'TLX3',
                               "unknown")
head(GSE62156_design)

```

Las comparaciones que nos interesan son:

-¿Existe desregulación de las RBP entre grupos? No hay interacciones

CALM_AF10 - HOX, CALM_AF10 - HOXA_of_Unknown_Mechanism, CALM_AF10 - Immature, CALM_AF10 - Immature_HOXA13_t, CALM_AF10 - MLL_t, CALM_AF10 - TAL_R, CALM_AF10 - TLX1, CALM_AF10 - TLX3

HOXA_of_Unknown_Mechanism - Immature, HOXA_of_Unknown_Mechanism - Immature_HOXA13_t, HOXA_of_Unknown_Mechanism - MLL_t, HOXA_of_Unknown_Mechanism - TAL_R, HOXA_of_Unknown_Mechanism - TLX1, HOXA_of_Unknown_Mechanism - TLX3

HOX - HOXA_of_Unknown_Mechanism, HOX - Immature, HOX - Immature_HOXA13_t, HOX - MLL_t, HOX - TAL_R, HOX - TLX1, HOX - TLX3

Immature - Immature_HOXA13_t, Immature - MLL_t, Immature - TAL_R, Immature - TLX1, Immature - TLX3

HOXA_of_Unknown_Mechanism - Immature, HOXA_of_Unknown_Mechanism - Immature_HOXA13_t, HOXA_of_Unknown_Mechanism - MLL_t, HOXA_of_Unknown_Mechanism - TAL_R, HOXA_of_Unknown_Mechanism - TLX1, HOXA_of_Unknown_Mechanism - TLX3

Immature_HOXA13_t - MLL_t, Immature_HOXA13_t - TAL_R, Immature_HOXA13_t - TLX1, Immature_HOXA13_t - TLX3


MLL_t - TAL_R, MLL_t - TLX1, MLL_t - TLX3

TAL_R - TLX1, TAL_R - TLX3

TLX1 - TLX3

-¿Existe desregulación de las RBP entre conjuntos de grupos? No hay interacciones


(HOX + HOXA_of_Unknown_Mechanism) - CALM_AF10, (HOX + HOXA_of_Unknown_Mechanism) - Immature, (HOX + HOXA_of_Unknown_Mechanism) - Immature_HOXA13_t, (HOX + HOXA_of_Unknown_Mechanism) - MLL_t, (HOX + HOXA_of_Unknown_Mechanism) - TAL_R, (HOX + HOXA_of_Unknown_Mechanism) - - TLX1, (HOX + HOXA_of_Unknown_Mechanism) - TLX3

(HOX + HOXA_of_Unknown_Mechanism) - (Immature + Immature_HOXA13_t)

(HOX + HOXA_of_Unknown_Mechanism) - (TLX1 + TLX3)

(Immature + Immature_HOXA13_t) - HOX, (Immature + Immature_HOXA13_t) - HOXA_of_Unknown_Mechanism, (Immature + Immature_HOXA13_t) - CALM_AF10, (Immature + Immature_HOXA13_t) - MLL_t, (Immature + Immature_HOXA13_t) - TAL_R, (Immature + Immature_HOXA13_t) - TLX1, (Immature + Immature_HOXA13_t) - TLX3,

(Immature + Immature_HOXA13_t) - (TLX1 + TLX3)


```{r, warning=TRUE, error=FALSE}

library(limma)
cont.matrix <- makeContrasts(CALMAF10_CALMHOX = CALM_AF10 - HOX,
                             CALMAF10_CALMHOXAUnk = CALM_AF10 - HOXA_of_Unknown_Mechanism,
                             CALMAF10_CALMImmature = CALM_AF10 - Immature,
                             CALMAF10_CALMImmatureHOXA = CALM_AF10 - Immature_HOXA13_t,
                             CALMAF10_CALMMLL = CALM_AF10 - MLL_t,
                             CALMAF10_CALMTAL = CALM_AF10 - TAL_R,
                             CALMAF10_CALMTLX1 = CALM_AF10 - TLX1,
                             CALMAF10_CALMTLX3 = CALM_AF10 - TLX3,
                             
                             HOX_HOXA = HOX - HOXA_of_Unknown_Mechanism,
                             HOX_Immature = HOX - Immature, #10
                             HOX_ImmHOXA = HOX - Immature_HOXA13_t,
                             HOX_MLL = HOX - MLL_t,
                             HOX_TAL = HOX - TAL_R,
                             HOX_TLX1 = HOX - TLX1,
                             HOX_TLX3 = HOX - TLX3, #15

                             HOXAUnk_Imm = HOXA_of_Unknown_Mechanism - Immature,
                             HOXAUnk_HOX = HOXA_of_Unknown_Mechanism - Immature_HOXA13_t,
                             HOXAUnk_ImmHOXA = HOXA_of_Unknown_Mechanism - MLL_t,
                             HOXAUnk_MLL = HOXA_of_Unknown_Mechanism - TAL_R,#19
                             HOXAUnk_TLX1 = HOXA_of_Unknown_Mechanism - TLX1,
                             HOXAUnk_TLX3 = HOXA_of_Unknown_Mechanism - TLX3,

                             Immature_ImmHOXA = Immature - Immature_HOXA13_t,
                             Immature_MLL = Immature - MLL_t, #23
                             Immature_TAL = Immature - TAL_R,
                             Immature_TLX1 = Immature - TLX1,
                             Immature_TLX3 = Immature - TLX3, #26
                             
                             ImmHOXA_MLL = Immature_HOXA13_t - MLL_t,
                             ImmHOXA_TAL = Immature_HOXA13_t - TAL_R,#28
                             ImmHOXA_TLX1 = Immature_HOXA13_t - TLX1,
                             ImmHOXA_TLX3 = Immature_HOXA13_t - TLX3,
                             

                             MLL_TAL = MLL_t - TAL_R,#31
                             MLL_TLX1 = MLL_t - TLX1,
                             MLL_TLX3 = MLL_t - TLX3,
                             
                             TLX = TLX1 - TLX3, #34
                             
                             HOX_CALM = (HOX + HOXA_of_Unknown_Mechanism)/2 - CALM_AF10,
                             HOX_Imm = (HOX + HOXA_of_Unknown_Mechanism)/2 - Immature,
                             HOX_ImHOXA = (HOX + HOXA_of_Unknown_Mechanism)/2 - Immature_HOXA13_t, #37
                             HOXs_MLL = (HOX + HOXA_of_Unknown_Mechanism)/2 - MLL_t,
                             HOXs_TAL = (HOX + HOXA_of_Unknown_Mechanism)/2 - TAL_R,
                             HOXs_TLX1 = (HOX + HOXA_of_Unknown_Mechanism)/2 - TLX1, #40
                             HOXs_TLX3 = (HOX + HOXA_of_Unknown_Mechanism)/2 - TLX3,
                             
                             HOX_Imms = (HOX + HOXA_of_Unknown_Mechanism)/2 - (Immature + Immature_HOXA13_t)/2, #42
                             
                             HOX_TLX = (HOX + HOXA_of_Unknown_Mechanism)/2 - (TLX1 + TLX3)/2,
                             
                             Imm_HOX =  (Immature + Immature_HOXA13_t)/2 - HOX,
                             Imm_HOXAUnk =  (Immature + Immature_HOXA13_t)/2 - HOXA_of_Unknown_Mechanism, #45
                             Imm_CALM =  (Immature + Immature_HOXA13_t)/2 - CALM_AF10,
                             Imm_MLL =  (Immature + Immature_HOXA13_t)/2 - MLL_t,
                             Imm_TAL =  (Immature + Immature_HOXA13_t)/2 - TAL_R, #48
                             Imm_TLX1 =  (Immature + Immature_HOXA13_t)/2 - TLX1,
                             Imm_TLX3 =  (Immature + Immature_HOXA13_t)/2 - TLX3,
                             
                             Imm_TLX = (Immature + Immature_HOXA13_t)/2 - (TLX1 + TLX3)/2, #51
                             levels = GSE62156_design)
print(cont.matrix)

```


```{r, warning=TRUE, error=FALSE}
# save(GSE8879_Filtered, eset_GSE8879_Filtered,
     # GSE8879_geneIds, file =
       # "C:/Users/Copito/OneDrive/Documentos/Master bioinf y bioest/TFM/datasets/GSE8879/datos.normalizados.Rda")

library(limma)
fit <- lmFit(eset_GSE62156_Filtered, GSE62156_design)
fit.GSE62156 <- contrasts.fit(fit, cont.matrix)
fit.GSE62156 <- eBayes(fit.GSE62156)
head(rownames(fit.GSE62156))

```

La función topTable genera para cada contraste una lista de genes ordenados de mas a menos diferencialmente expresados.

CALMAF10_CALMHOX, CALMAF10_CALMHOXAUnk, CALMAF10_CALMImmature, CALMAF10_CALMImmatureHOXA, CALMAF10_CALMMLL, CALMAF10_CALMTAL, CALMAF10_CALMTLX1, CALMAF10_CALMTLX3, HOX_HOXA, HOX_Immature, HOX_ImmHOXA, HOX_MLL, HOX_TAL, HOX_TLX1, HOX_TLX3, HOXAUnk_Imm, HOXAUnk_HOX, HOXAUnk_ImmHOXA, HOXAUnk_MLL, HOXAUnk_TLX1, HOXAUnk_TLX3, Immature_ImmHOXA, Immature_MLL, Immature_TAL, Immature_TLX1, Immature_TLX3, ImmHOXA_MLL, ImmHOXA_TAL, ImmHOXA_TLX1, ImmHOXA_TLX3, MLL_TAL, MLL_TLX1, MLL_TLX3, TLX (34), HOX_CALM, HOX_Imm, HOX_ImHOXA, HOXs_MLL, HOXs_TAL, HOXs_TLX1, HOXs_TLX3, HOX_Imms, HOX_TLX, Imm_HOX, Imm_HOXAUnk, Imm_CALM, Imm_MLL, Imm_TAL, Imm_TLX1, Imm_TLX3, Imm_TLX

```{r, warning=TRUE, error=FALSE}
topTab_GSE62156_1 <- topTable(fit.GSE62156, number = nrow(fit.GSE62156), coef = "CALMAF10_CALMHOX",
    adjust = "fdr")
topTab_GSE62156_2 <- topTable(fit.GSE62156, number = nrow(fit.GSE62156), coef = "CALMAF10_CALMHOXAUnk",
    adjust = "fdr")
topTab_GSE62156_3 <- topTable(fit.GSE62156, number = nrow(fit.GSE62156), coef = "CALMAF10_CALMImmature",
    adjust = "fdr")
topTab_GSE62156_4 <- topTable(fit.GSE62156, number = nrow(fit.GSE62156), coef = "CALMAF10_CALMImmatureHOXA",
    adjust = "fdr")
topTab_GSE62156_5 <- topTable(fit.GSE62156, number = nrow(fit.GSE62156), coef = "CALMAF10_CALMMLL",
    adjust = "fdr")

topTab_GSE62156_6 <- topTable(fit.GSE62156, number = nrow(fit.GSE62156), coef = "CALMAF10_CALMTAL",
    adjust = "fdr")
topTab_GSE62156_7 <- topTable(fit.GSE62156, number = nrow(fit.GSE62156), coef = "CALMAF10_CALMTLX1",
    adjust = "fdr")
topTab_GSE62156_8 <- topTable(fit.GSE62156, number = nrow(fit.GSE62156), coef = "CALMAF10_CALMTLX3",
    adjust = "fdr")

topTab_GSE62156_9REAL <- topTable(fit.GSE62156, number = nrow(fit.GSE62156), coef = "HOX_HOXA",
    adjust = "fdr")

topTab_GSE62156_9 <- topTable(fit.GSE62156, number = nrow(fit.GSE62156), coef = "HOX_Immature",
    adjust = "fdr")
topTab_GSE62156_10 <- topTable(fit.GSE62156, number = nrow(fit.GSE62156), coef = "HOX_ImmHOXA",
    adjust = "fdr")
topTab_GSE62156_11 <- topTable(fit.GSE62156, number = nrow(fit.GSE62156), coef = "HOX_MLL",
    adjust = "fdr")
topTab_GSE62156_12 <- topTable(fit.GSE62156, number = nrow(fit.GSE62156), coef = "HOX_TAL",
    adjust = "fdr")
topTab_GSE62156_13 <- topTable(fit.GSE62156, number = nrow(fit.GSE62156), coef = "HOX_TLX1",
    adjust = "fdr")
topTab_GSE62156_14 <- topTable(fit.GSE62156, number = nrow(fit.GSE62156), coef = "HOX_TLX3",
                            adjust = "fdr")


# HOX_TLX3, HOXAUnk_Imm, HOXAUnk_HOX, HOXAUnk_ImmHOXA, HOXAUnk_MLL, HOXAUnk_TLX1, HOXAUnk_TLX3, Immature_ImmHOXA, Immature_MLL, Immature_TAL, Immature_TLX1, Immature_TLX3, ImmHOXA_MLL, ImmHOXA_TAL, ImmHOXA_TLX1, ImmHOXA_TLX3, 

topTab_GSE62156_15 <- topTable(fit.GSE62156, number = nrow(fit.GSE62156), coef = "HOXAUnk_Imm",
    adjust = "fdr")
topTab_GSE62156_16 <- topTable(fit.GSE62156, number = nrow(fit.GSE62156), coef = "HOXAUnk_HOX",
    adjust = "fdr")
topTab_GSE62156_17 <- topTable(fit.GSE62156, number = nrow(fit.GSE62156), coef = "HOXAUnk_ImmHOXA",
    adjust = "fdr")
topTab_GSE62156_18 <- topTable(fit.GSE62156, number = nrow(fit.GSE62156), coef = "HOXAUnk_MLL",
    adjust = "fdr")
topTab_GSE62156_19 <- topTable(fit.GSE62156, number = nrow(fit.GSE62156), coef = "HOXAUnk_TLX1",
    adjust = "fdr")
topTab_GSE62156_20 <- topTable(fit.GSE62156, number = nrow(fit.GSE62156), coef = "HOXAUnk_TLX3",
    adjust = "fdr")
topTab_GSE62156_21 <- topTable(fit.GSE62156, number = nrow(fit.GSE62156), coef = "Immature_ImmHOXA",
    adjust = "fdr")
topTab_GSE62156_22 <- topTable(fit.GSE62156, number = nrow(fit.GSE62156), coef = "Immature_MLL",
    adjust = "fdr")
topTab_GSE62156_23 <- topTable(fit.GSE62156, number = nrow(fit.GSE62156), coef = "Immature_TAL",
    adjust = "fdr")
topTab_GSE62156_24 <- topTable(fit.GSE62156, number = nrow(fit.GSE62156), coef = "Immature_TLX1",
    adjust = "fdr")
topTab_GSE62156_25 <- topTable(fit.GSE62156, number = nrow(fit.GSE62156), coef = "Immature_TLX3",
    adjust = "fdr")
topTab_GSE62156_26 <- topTable(fit.GSE62156, number = nrow(fit.GSE62156), coef = "ImmHOXA_MLL",
    adjust = "fdr")
topTab_GSE62156_27 <- topTable(fit.GSE62156, number = nrow(fit.GSE62156), coef = "ImmHOXA_TAL",
    adjust = "fdr")
topTab_GSE62156_28 <- topTable(fit.GSE62156, number = nrow(fit.GSE62156), coef = "ImmHOXA_TLX1",
    adjust = "fdr")
topTab_GSE62156_29 <- topTable(fit.GSE62156, number = nrow(fit.GSE62156), coef = "ImmHOXA_TLX3",
    adjust = "fdr")
topTab_GSE62156_30 <- topTable(fit.GSE62156, number = nrow(fit.GSE62156), coef = "MLL_TAL",
    adjust = "fdr")
topTab_GSE62156_31 <- topTable(fit.GSE62156, number = nrow(fit.GSE62156), coef = "MLL_TLX1",
    adjust = "fdr")
topTab_GSE62156_32 <- topTable(fit.GSE62156, number = nrow(fit.GSE62156), coef = "MLL_TLX3",
    adjust = "fdr")
topTab_GSE62156_33 <- topTable(fit.GSE62156, number = nrow(fit.GSE62156), coef = "TLX",
    adjust = "fdr")
topTab_GSE62156_34 <- topTable(fit.GSE62156, number = nrow(fit.GSE62156), coef = "HOX_CALM",
    adjust = "fdr")

# MLL_TAL, MLL_TLX1, MLL_TLX3, TLX (34), HOX_CALM, HOX_Imm (36), HOX_ImHOXA, HOXs_MLL, HOXs_TAL, HOXs_TLX1, HOXs_TLX3, HOX_Imms, HOX_TLX, Imm_HOX, Imm_HOXAUnk, Imm_CALM, Imm_MLL, Imm_TAL, Imm_TLX1, Imm_TLX3, Imm_TLX

topTab_GSE62156_35 <- topTable(fit.GSE62156, number = nrow(fit.GSE62156), coef = "HOX_ImHOXA",
    adjust = "fdr")
topTab_GSE62156_36 <- topTable(fit.GSE62156, number = nrow(fit.GSE62156), coef = "HOXs_MLL",
    adjust = "fdr")

topTab_GSE62156_36REAL <- topTable(fit.GSE62156, number = nrow(fit.GSE62156), coef = "HOX_Imm",
    adjust = "fdr")

topTab_GSE62156_37 <- topTable(fit.GSE62156, number = nrow(fit.GSE62156), coef = "HOXs_TAL",
    adjust = "fdr")
topTab_GSE62156_38 <- topTable(fit.GSE62156, number = nrow(fit.GSE62156), coef = "HOXs_TLX1",
    adjust = "fdr")
topTab_GSE62156_39 <- topTable(fit.GSE62156, number = nrow(fit.GSE62156), coef = "HOXs_TLX3",
    adjust = "fdr")
topTab_GSE62156_ <- topTable(fit.GSE62156, number = nrow(fit.GSE62156), coef = "HOX_Imms",
    adjust = "fdr")
topTab_GSE62156_40 <- topTable(fit.GSE62156, number = nrow(fit.GSE62156), coef = "HOX_TLX",
    adjust = "fdr")
topTab_GSE62156_41 <- topTable(fit.GSE62156, number = nrow(fit.GSE62156), coef = "Imm_HOX",
    adjust = "fdr")
topTab_GSE62156_42 <- topTable(fit.GSE62156, number = nrow(fit.GSE62156), coef = "Imm_HOXAUnk",
    adjust = "fdr")
topTab_GSE62156_43 <- topTable(fit.GSE62156, number = nrow(fit.GSE62156), coef = "Imm_CALM",
    adjust = "fdr")
topTab_GSE62156_44 <- topTable(fit.GSE62156, number = nrow(fit.GSE62156), coef = "Imm_MLL",
    adjust = "fdr")
topTab_GSE62156_45 <- topTable(fit.GSE62156, number = nrow(fit.GSE62156), coef = "Imm_TAL",
    adjust = "fdr")
topTab_GSE62156_46 <- topTable(fit.GSE62156, number = nrow(fit.GSE62156), coef = "Imm_TLX1",
    adjust = "fdr")
topTab_GSE62156_47 <- topTable(fit.GSE62156, number = nrow(fit.GSE62156), coef = "Imm_TLX3",
    adjust = "fdr")
topTab_GSE62156_48 <- topTable(fit.GSE62156, number = nrow(fit.GSE62156), coef = "Imm_TLX",
    adjust = "fdr")




head(topTab_GSE62156_24)
```


Para identificar los genes más diferencialmente expresados podemos utilizar la lista de anotaciones y añadir algunas a las topTables.

```{r, warning=TRUE, error=FALSE}
library(dplyr)
anotaTopTab <- function(topTab) {
    topTab_Anot <- topTab %>%
        mutate(PROBEID = rownames(topTab)) %>%
        merge(GSE62156_geneIds, "PROBEID") %>%
        arrange(adj.P.Val)
    return(topTab_Anot)
}


topTab_GSE62156_1_Anot<-anotaTopTab(topTab_GSE62156_1)
topTab_GSE62156_2_Anot<-anotaTopTab(topTab_GSE62156_2)
topTab_GSE62156_3_Anot<-anotaTopTab(topTab_GSE62156_3)
topTab_GSE62156_4_Anot<-anotaTopTab(topTab_GSE62156_4)
topTab_GSE62156_5_Anot<-anotaTopTab(topTab_GSE62156_5)
topTab_GSE62156_6_Anot<-anotaTopTab(topTab_GSE62156_6)
topTab_GSE62156_7_Anot<-anotaTopTab(topTab_GSE62156_7)
topTab_GSE62156_8_Anot<-anotaTopTab(topTab_GSE62156_8)
topTab_GSE62156_9_Anot<-anotaTopTab(topTab_GSE62156_9)
topTab_GSE62156_9REAL_Anot<-anotaTopTab(topTab_GSE62156_9REAL)
topTab_GSE62156_10_Anot<-anotaTopTab(topTab_GSE62156_10)
topTab_GSE62156_11_Anot<-anotaTopTab(topTab_GSE62156_11)
topTab_GSE62156_12_Anot<-anotaTopTab(topTab_GSE62156_12)
topTab_GSE62156_13_Anot<-anotaTopTab(topTab_GSE62156_13)
topTab_GSE62156_14_Anot<-anotaTopTab(topTab_GSE62156_14)
topTab_GSE62156_15_Anot<-anotaTopTab(topTab_GSE62156_15)
topTab_GSE62156_16_Anot<-anotaTopTab(topTab_GSE62156_16)
topTab_GSE62156_17_Anot<-anotaTopTab(topTab_GSE62156_17)
topTab_GSE62156_18_Anot<-anotaTopTab(topTab_GSE62156_18)
topTab_GSE62156_19_Anot<-anotaTopTab(topTab_GSE62156_19)
topTab_GSE62156_20_Anot<-anotaTopTab(topTab_GSE62156_20)
topTab_GSE62156_21_Anot<-anotaTopTab(topTab_GSE62156_21)
topTab_GSE62156_22_Anot<-anotaTopTab(topTab_GSE62156_22)
topTab_GSE62156_23_Anot<-anotaTopTab(topTab_GSE62156_23)
topTab_GSE62156_24_Anot<-anotaTopTab(topTab_GSE62156_24)
topTab_GSE62156_25_Anot<-anotaTopTab(topTab_GSE62156_25)
topTab_GSE62156_26_Anot<-anotaTopTab(topTab_GSE62156_26)
topTab_GSE62156_27_Anot<-anotaTopTab(topTab_GSE62156_27)
topTab_GSE62156_28_Anot<-anotaTopTab(topTab_GSE62156_28)
topTab_GSE62156_29_Anot<-anotaTopTab(topTab_GSE62156_29)
topTab_GSE62156_30_Anot<-anotaTopTab(topTab_GSE62156_30)
topTab_GSE62156_31_Anot<-anotaTopTab(topTab_GSE62156_31)
topTab_GSE62156_32_Anot<-anotaTopTab(topTab_GSE62156_32)
topTab_GSE62156_33_Anot<-anotaTopTab(topTab_GSE62156_33)
topTab_GSE62156_34_Anot<-anotaTopTab(topTab_GSE62156_34)
topTab_GSE62156_35_Anot<-anotaTopTab(topTab_GSE62156_35)
topTab_GSE62156_36_Anot<-anotaTopTab(topTab_GSE62156_36)
topTab_GSE62156_36REAL_Anot<-anotaTopTab(topTab_GSE62156_36REAL)
topTab_GSE62156_37_Anot<-anotaTopTab(topTab_GSE62156_37)
topTab_GSE62156_38_Anot<-anotaTopTab(topTab_GSE62156_38)
topTab_GSE62156_39_Anot<-anotaTopTab(topTab_GSE62156_39)
topTab_GSE62156_40_Anot<-anotaTopTab(topTab_GSE62156_40)
topTab_GSE62156_41_Anot<-anotaTopTab(topTab_GSE62156_41)
topTab_GSE62156_42_Anot<-anotaTopTab(topTab_GSE62156_42)
topTab_GSE62156_43_Anot<-anotaTopTab(topTab_GSE62156_43)
topTab_GSE62156_44_Anot<-anotaTopTab(topTab_GSE62156_44)
topTab_GSE62156_45_Anot<-anotaTopTab(topTab_GSE62156_45)
topTab_GSE62156_46_Anot<-anotaTopTab(topTab_GSE62156_46)
topTab_GSE62156_47_Anot<-anotaTopTab(topTab_GSE62156_47)
topTab_GSE62156_48_Anot<-anotaTopTab(topTab_GSE62156_48)




head(topTab_GSE62156_45_Anot)
```

```{r, warning=TRUE, error=FALSE}
# save(topTab_GSE62156_1_Anot, topTab_GSE62156_2_Anot, topTab_GSE62156_3_Anot, topTab_GSE62156_4_Anot, topTab_GSE62156_5_Anot, topTab_GSE62156_6_Anot, topTab_GSE62156_7_Anot, topTab_GSE62156_8_Anot, topTab_GSE62156_9_Anot, topTab_GSE62156_10_Anot, topTab_GSE62156_11_Anot, topTab_GSE62156_12_Anot, topTab_GSE62156_13_Anot, topTab_GSE62156_14_Anot, topTab_GSE62156_15_Anot, topTab_GSE62156_16_Anot, topTab_GSE62156_17_Anot, topTab_GSE62156_18_Anot, topTab_GSE62156_19_Anot, topTab_GSE62156_20_Anot, topTab_GSE62156_21_Anot, topTab_GSE62156_22_Anot, topTab_GSE62156_23_Anot, topTab_GSE62156_24_Anot, topTab_GSE62156_25_Anot, topTab_GSE62156_26_Anot, topTab_GSE62156_27_Anot, topTab_GSE62156_28_Anot, topTab_GSE62156_29_Anot, topTab_GSE62156_30_Anot, topTab_GSE62156_31_Anot, topTab_GSE62156_32_Anot, topTab_GSE62156_33_Anot, topTab_GSE62156_34_Anot, topTab_GSE62156_35_Anot, topTab_GSE62156_36_Anot, topTab_GSE62156_37_Anot, topTab_GSE62156_38_Anot, topTab_GSE62156_39_Anot, topTab_GSE62156_40_Anot, topTab_GSE62156_41_Anot, topTab_GSE62156_42_Anot, topTab_GSE62156_43_Anot, topTab_GSE62156_44_Anot, topTab_GSE62156_45_Anot, topTab_GSE62156_46_Anot, topTab_GSE62156_47_Anot, topTab_GSE62156_48_Anot,
  # file ="C:/Users/laura/OneDrive/Documentos/Cris/GSE62156topTab_Anot.Rda")

save(topTab_GSE62156_1_Anot, topTab_GSE62156_2_Anot, topTab_GSE62156_3_Anot, topTab_GSE62156_4_Anot, topTab_GSE62156_5_Anot, topTab_GSE62156_6_Anot, topTab_GSE62156_7_Anot, topTab_GSE62156_8_Anot, topTab_GSE62156_9_Anot, topTab_GSE62156_9REAL_Anot, topTab_GSE62156_10_Anot, topTab_GSE62156_11_Anot, topTab_GSE62156_12_Anot, topTab_GSE62156_13_Anot, topTab_GSE62156_14_Anot, topTab_GSE62156_15_Anot, topTab_GSE62156_16_Anot, topTab_GSE62156_17_Anot, topTab_GSE62156_18_Anot, topTab_GSE62156_19_Anot, topTab_GSE62156_20_Anot, topTab_GSE62156_21_Anot, topTab_GSE62156_22_Anot, topTab_GSE62156_23_Anot, topTab_GSE62156_24_Anot, topTab_GSE62156_25_Anot, topTab_GSE62156_26_Anot, topTab_GSE62156_27_Anot, topTab_GSE62156_28_Anot, topTab_GSE62156_29_Anot, topTab_GSE62156_30_Anot, topTab_GSE62156_31_Anot, topTab_GSE62156_32_Anot, topTab_GSE62156_33_Anot, topTab_GSE62156_34_Anot, topTab_GSE62156_35_Anot, topTab_GSE62156_36_Anot, topTab_GSE62156_36REAL_Anot, topTab_GSE62156_37_Anot, topTab_GSE62156_38_Anot, topTab_GSE62156_39_Anot, topTab_GSE62156_40_Anot, topTab_GSE62156_41_Anot, topTab_GSE62156_42_Anot, topTab_GSE62156_43_Anot, topTab_GSE62156_44_Anot, topTab_GSE62156_45_Anot, topTab_GSE62156_46_Anot, topTab_GSE62156_47_Anot, topTab_GSE62156_48_Anot,
  file ="C:/Users/Copito/OneDrive/Documentos/Master bioinf y bioest/TFM/datasets/GSE62156/GSE62156topTab_Anot.Rda")





```

Comparaciones múltiples


```{r, warning=TRUE, error=FALSE}
GSE62156_res <- decideTests(fit.GSE62156, method = "separate", adjust.method = "fdr", p.value = 0.05,
    lfc = 0)
```

Para resumir dicho análisis podemos contar qué filas tienen como mínimo una celda distinta de cero:



```{r, warning=TRUE, error=FALSE}
sum.GSE62156res.rows <- apply(abs(GSE62156_res), 1, sum)
GSE62156_res.selected <- GSE62156_res[sum.GSE62156res.rows != 0, ]
print(summary(GSE62156_res))
```


Si ahora visualizamos los resultados de cada las comparaciones más importantes.


```{r, warning=TRUE, error=FALSE}
xlimits <- c(-3, +3)
ylimits <- c(0, 8)
GSE62156_genenames <- topTab_GSE62156_22_Anot$SYMBOL # Immature_MLL
coef <- 1

par(mfrow = c(1, 2))
volcanoplot(fit.GSE62156, highlight = 10, names = GSE62156_genenames, coef = coef, main = paste("DEGS en comparación ",
    colnames(cont.matrix)[coef], sep = "\n"), cex.main = 0.8, xlim = xlimits, ylim = ylimits)
abline(v = c(-1, 1))


GSE62156_genenames <- topTab_GSE62156_23_Anot$SYMBOL
volcanoplot(fit.GSE62156, highlight = 10, names = GSE62156_genenames, coef = coef, main = paste("DEGS en comparación ",
    colnames(cont.matrix)[coef], sep = "\n"), cex.main = 0.8, xlim = xlimits, ylim = ylimits)
abline(v = c(-1, 1))



volcanoplot(fit.GSE62156, highlight = 10, names = GSE62156_genenames, coef = coef, main = paste("DEGS en comparación ",
    colnames(cont.matrix)[coef], sep = "\n"), cex.main = 0.8, xlim = xlimits, ylim = ylimits)
abline(v = c(-1, 1))


GSE62156_genenames <- topTab_GSE62156_23_Anot$SYMBOL
volcanoplot(fit.GSE62156, highlight = 10, names = GSE62156_genenames, coef = coef, main = paste("DEGS en comparación ",
    colnames(cont.matrix)[coef], sep = "\n"), cex.main = 0.8, xlim = xlimits, ylim = ylimits)
abline(v = c(-1, 1))


par(mfrow = c(1, 1))


```


```{r, warning=TRUE, error=FALSE}
xlimits <- c(-7, +10)
ylimits <- c(0, 6)
GSE62156_genenames <- c(topTab_GSE62156_1_Anot$SYMBOL, topTab_GSE62156_2_Anot$SYMBOL, topTab_GSE62156_3_Anot$SYMBOL, topTab_GSE62156_4_Anot$SYMBOL, topTab_GSE62156_5_Anot$SYMBOL, topTab_GSE62156_6_Anot$SYMBOL, topTab_GSE62156_7_Anot$SYMBOL, topTab_GSE62156_8_Anot$SYMBOL, topTab_GSE62156_9_Anot$SYMBOL, topTab_GSE62156_10_Anot$SYMBOL, topTab_GSE62156_11_Anot$SYMBOL, topTab_GSE62156_12_Anot$SYMBOL, topTab_GSE62156_13_Anot$SYMBOL, topTab_GSE62156_14_Anot$SYMBOL, topTab_GSE62156_15_Anot$SYMBOL, topTab_GSE62156_16_Anot$SYMBOL, topTab_GSE62156_17_Anot$SYMBOL, topTab_GSE62156_18_Anot$SYMBOL, topTab_GSE62156_19_Anot$SYMBOL, topTab_GSE62156_20_Anot$SYMBOL, topTab_GSE62156_21_Anot$SYMBOL, topTab_GSE62156_22_Anot$SYMBOL, topTab_GSE62156_23_Anot$SYMBOL, topTab_GSE62156_24_Anot$SYMBOL, topTab_GSE62156_25_Anot$SYMBOL, topTab_GSE62156_26_Anot$SYMBOL, topTab_GSE62156_27_Anot$SYMBOL, topTab_GSE62156_28_Anot$SYMBOL, topTab_GSE62156_29_Anot$SYMBOL, topTab_GSE62156_30_Anot$SYMBOL, topTab_GSE62156_31_Anot$SYMBOL, topTab_GSE62156_32_Anot$SYMBOL, topTab_GSE62156_33_Anot$SYMBOL, topTab_GSE62156_34_Anot$SYMBOL, topTab_GSE62156_35_Anot$SYMBOL, topTab_GSE62156_36_Anot$SYMBOL, topTab_GSE62156_37_Anot$SYMBOL, topTab_GSE62156_38_Anot$SYMBOL, topTab_GSE62156_39_Anot$SYMBOL, topTab_GSE62156_40_Anot$SYMBOL, topTab_GSE62156_41_Anot$SYMBOL, topTab_GSE62156_42_Anot$SYMBOL, topTab_GSE62156_43_Anot$SYMBOL, topTab_GSE62156_44_Anot$SYMBOL, topTab_GSE62156_45_Anot$SYMBOL, topTab_GSE62156_46_Anot$SYMBOL, topTab_GSE62156_47_Anot$SYMBOL, topTab_GSE62156_48_Anot$SYMBOL)


volcanoplot(fit.GSE62156, highlight = 10, names = GSE62156_genenames, main = 'GSE62156', cex.main = 0.8, xlim = xlimits, ylim = ylimits)
abline(v = c(-1, 1))

```




Visualización de los perfiles de expresión



```{r, warning=TRUE, error=FALSE}
eset_GSE62156_Filtered
require(hgu133plus2.db)
```


```{r, warning=TRUE, error=FALSE}
probeNames <- rownames(GSE62156_res)
probeNames.selected <- probeNames[sum.GSE62156res.rows != 0]
exprs2cluster <- exprs(eset_GSE62156_Filtered)[probeNames.selected, ]
symbols <- AnnotationDbi::select(hgu133plus2.db, probeNames.selected,
    columns = "SYMBOL")[, 2]
colnames(exprs2cluster) <- GSE62156_sampleNames
rownames(exprs2cluster) <- symbols

```


```{r, warning=TRUE, error=FALSE}

heatmap(exprs2cluster, col = rainbow(100), ColSideColors = GSE62156_colores, cexCol = 0.9)

```


Mapa de colores basado en los genes seleccionados por estar diferencialmente expresados.

```{r, warning=TRUE, error=FALSE}
library("gplots")
heatmap.2(exprs2cluster, col=topo.colors(75), scale="none", ColSideColors=GSE62156_colores,
          key=TRUE, symkey=FALSE, density.info="none", trace="none", cexRow=0.5)
```



# GSE110633

## Análisis de expresión diferencial

El objetivo del análisis de expresión diferencial es seleccionar genes cuya expresión difiere entre grupos.

Selección de genes usando paquete edgeR

El análisis con edgeR es similar al de limma-Voom (se originan en el mismo equipo de investigación) pero la modelización es distinta.

El análisis utiliza un GLM pero, en una forma que recuerda a lo que se hace con limma, realiza un paso adicional,en el que se calcula una estimación mejorada de la dispersión (variabilidad) de las muestras que integra las estimaciones individuales y la global mediante estimación Bayes empírica.

```{r, include=TRUE, message=TRUE}
# load('C:/Users/Copito/OneDrive/Documentos/Master bioinf y bioest/TFM/datasets/GSE110633/GSE110633_objetos.Rda')

load('C:/Users/laura/OneDrive/Documentos/Cris/GSE110633_objetos.Rda')

```

Matriz de diseño y de contrastes

Utilizando la variable group podemos definir una matriz de diseño y, sobre ésta, los contrastes que nos interesan.


```{r, include=TRUE, message=TRUE}
library(edgeR)
group = as.factor(GSE110633_dgeObjnorm$samples$group)
design = model.matrix(~0 + group)
colnames(design) = gsub("group", "", colnames(design))
row.names(design) = GSE110633_dgeObjnorm[["samples"]][["samples"]]
head(design)
```


group
HOXA  IMM  TAL  TLX 

```{r, include=TRUE, message=TRUE}
cont.matrix = makeContrasts(HOXA_IMM = HOXA - IMM,
                            HOXA_TAL = HOXA - TAL,
                            HOXA_TLX = HOXA - TLX,
                            
                            IMM_TAL = IMM - TAL,
                            IMM_TLX = IMM - TLX,
                            
                            TAL_TLX = TAL - TLX,
                            
                            
                            levels = colnames(design))
cont.matrix
```




```{r, include=TRUE, message=TRUE}
require(statmod)
y = estimateDisp(GSE110633_dgeObjnorm, design, robust = TRUE)
plotBCV(y)
```

Con este objeto, que añade a los contajes normalizados los estimadores mejorados de dispersión, se ajusta un modelo lineal generalizado con distribución binomial para los errores.

Ajuste del modelo

```{r, include=TRUE, message=TRUE}
fit <- glmQLFit(y, design, robust = TRUE)
```

Una vez ajustado el modelo se procede a construir el contraste y realizar el test.

De hecho podemos usar la matriz de contrastes que construímos para limma voom, en la misma forma que hemos reutilizado la de diseño.


```{r, include=TRUE, message=TRUE}
GSE110633_res <- glmQLFTest(fit, contrast = cont.matrix)
```

Los resultados se almacenan en un objeto similar a la ’ topTable’ de limma.

```{r, include=TRUE, message=TRUE}
topTags_edge <- topTags(GSE110633_res, n = dim(GSE110633_log2countnorm)[1])  # todos los genes

head(topTags_edge)
```

Podemos seleccionar los genes más diferencialmente expresados de la misma forma que haríamos con limma-voom.

```{r, include=TRUE, message=TRUE}
topGenes_edge1 <- rownames(subset(topTags_edge[["table"]], (abs(topTags_edge[["table"]][["logFC.HOXA_IMM"]]) > 2) & (topTags_edge[["table"]][["FDR"]] < 0.01)))
# topGenes_edge <- rownames(subset(topTags_edge$table, (abs(logFC) > 2) & (FDR < 0.01)))

topGenes_edge2 <- rownames(subset(topTags_edge[["table"]], (abs(topTags_edge[["table"]][["logFC.HOXA_TAL"]]) > 2) & (topTags_edge[["table"]][["FDR"]] < 0.01)))


topGenes_edge3 <- rownames(subset(topTags_edge[["table"]], (abs(topTags_edge[["table"]][["logFC.HOXA_TLX"]]) > 2) & (topTags_edge[["table"]][["FDR"]] < 0.01)))


topGenes_edge4 <- rownames(subset(topTags_edge[["table"]], (abs(topTags_edge[["table"]][["logFC.IMM_TAL"]]) > 2) & (topTags_edge[["table"]][["FDR"]] < 0.01)))


topGenes_edge5 <- rownames(subset(topTags_edge[["table"]], (abs(topTags_edge[["table"]][["logFC.IMM_TLX"]]) > 2) & (topTags_edge[["table"]][["FDR"]] < 0.01)))

topGenes_edge6 <- rownames(subset(topTags_edge[["table"]], (abs(topTags_edge[["table"]][["logFC.TAL_TLX"]]) > 2) & (topTags_edge[["table"]][["FDR"]] < 0.01)))
length(topGenes_edge3)
```

La lista de genes seleccionados es muy similar en ambos casos. Vamos a hacerlo también con otras ecuaciones.


Transformación de los contajes, selección de genes diferencialmente expresados y top tables

```{r, include=TRUE, message=TRUE}
voomObj <- voom(GSE110633_dgeObjnorm, design)
voomObj
fit <- lmFit(voomObj)
fit.cont <- contrasts.fit(fit, cont.matrix)
fit.cont <- eBayes(fit.cont)
toptab1 <- topTable(fit.cont, coef = 1, sort.by = "p", number = nrow(fit.cont))
toptab2 <- topTable(fit.cont, coef = 2, sort.by = "p", number = nrow(fit.cont))
toptab3 <- topTable(fit.cont, coef = 3, sort.by = "p", number = nrow(fit.cont))
toptab4 <- topTable(fit.cont, coef = 4, sort.by = "p", number = nrow(fit.cont))
toptab5 <- topTable(fit.cont, coef = 5, sort.by = "p", number = nrow(fit.cont))
toptab6 <- topTable(fit.cont, coef = 'TAL_TLX', sort.by = "p", number = nrow(fit.cont))
# o bien toptab6 <- topTable(fit.cont, coef = 6, sort.by = "p", number = nrow(fit.cont))


head(toptab4)
```

Visualización de los resultados. De todos en conjunto.


```{r, include=TRUE, message=TRUE}
volcanoplot(fit.cont, coef = 1, highlight = 100, main = "GSE110633")
abline(v = c(-1, 1))
```



Con el fin de observar si existen perfiles de expresión diferenciados podemo realizar un mapa de colores con los genes más diferencialmente expresados.

Es decir, fijamos un criterio de selección de genes y retenemos aquellos componentes de la tabla de resultados que lo cumplen. Por ejemplo: Genes con un p-balor ajustado inferior a 0.001 y un `fold-change’ superior a 2.

```{r, include=TRUE, message=TRUE}
topGenesBas1 <- rownames(subset(toptab1, (abs(toptab1$logFC) > 2) & (toptab1$P.Value < 0.05)))

topGenesBas2 <- rownames(subset(toptab2, (abs(toptab2$logFC) > 2) & (toptab2$P.Value < 0.05)))

topGenesBas3 <- rownames(subset(toptab3, (abs(toptab3$logFC) > 2) & (toptab3$P.Value < 0.05)))

topGenesBas4 <- rownames(subset(toptab4, (abs(toptab4$logFC) > 2) & (toptab4$P.Value < 0.05)))

topGenesBas5 <- rownames(subset(toptab5, (abs(toptab5$logFC) > 2) & (toptab5$P.Value < 0.05)))

topGenesBas6 <- rownames(subset(toptab6, (abs(toptab6$logFC) > 2) & (toptab6$P.Value < 0.05)))
length(topGenesBas6)
```

No hay genes con un p valor ajustado inferior a 0.001 y un fold change superior a 2 usando el adj.P.Val< 0.01... usamos el p valor < 0.05.

```{r, include=TRUE, message=TRUE}
library(pheatmap)
mat <- GSE110633_log2countnorm[topGenesBas1, ]
mat <- mat - rowMeans(mat)
pheatmap(mat, main = 'HOXA_IMM')
mat <- GSE110633_log2countnorm[topGenesBas2, ]
mat <- mat - rowMeans(mat)
pheatmap(mat, main = 'HOXA_TAL')
mat <- GSE110633_log2countnorm[topGenesBas3, ]
mat <- mat - rowMeans(mat)
pheatmap(mat, main = 'HOXA_TLX')
mat <- GSE110633_log2countnorm[topGenesBas4, ]
mat <- mat - rowMeans(mat)
pheatmap(mat, main = 'IMM_TAL')
mat <- GSE110633_log2countnorm[topGenesBas5, ]
mat <- mat - rowMeans(mat)
pheatmap(mat, main = 'IMM_TLX')
mat <- GSE110633_log2countnorm[topGenesBas6, ]
mat <- mat - rowMeans(mat)
pheatmap(mat, main = 'TAL_TLX')

```

```{r, include=TRUE, message=TRUE}
topGenes1 <- union(topGenesBas1, topGenes_edge1)

topGenes2 <- union(topGenesBas2, topGenes_edge2)

topGenes3 <- union(topGenesBas3, topGenes_edge3)

topGenes4 <- union(topGenesBas4, topGenes_edge4)

topGenes5 <- union(topGenesBas5, topGenes_edge5)

topGenes6 <- union(topGenesBas6, topGenes_edge6)

length(topGenes4)
```


```{r, include=TRUE, message=TRUE}
universe1 <- rownames(toptab1)
universe2 <- rownames(toptab2)
universe3 <- rownames(toptab3)
universe4 <- rownames(toptab4)
universe5 <- rownames(toptab5)
universe6 <- rownames(toptab6)
length(universe4)
```

```{r, include=TRUE, message=TRUE}
save(toptab1, toptab2, toptab3, toptab4, toptab5, toptab6,
     universe1, universe2, universe3, universe4, universe5,
     universe6, topGenes, topGenesBas1, topGenes_edge1,
     topGenesBas2, topGenes_edge2,
     topGenesBas3, topGenes_edge3,
     topGenesBas4, topGenes_edge4,
     topGenesBas5, topGenes_edge5,
     topGenesBas6, topGenes_edge6,
     
     file='C:/Users/Copito/OneDrive/Documentos/Master bioinf y bioest/TFM/datasets/GSE110633_Toptabs&Universe.Rda')

# save(toptab1, toptab2, toptab3, toptab4, toptab5, toptab6,
     # universe1, universe2, universe3, universe4, universe5,
     # universe6, topGenes, topGenesBas, topGenes_edge,
     # file='C:/Users/crist/Documents/TFM/GSE110633_Toptabs&Universe.Rda')
```




# GSE110636


## Análisis de expresión diferencial


```{r, include=TRUE, message=TRUE}
load('C:/Users/Copito/OneDrive/Documentos/Master bioinf y bioest/TFM/datasets/GSE110636/GSE110636_objetos.Rda')
```

Matriz de diseño y de contrastes


```{r, include=TRUE, message=TRUE}

group = as.factor(GSE110636_dgeObjnorm$samples$group)
design = model.matrix(~0 + group)
colnames(design) = gsub("group", "", colnames(design))
row.names(design) = GSE110636_dgeObjnorm[["samples"]][["samples"]]
head(design)
```


Igual que la anterior, los grupos son:

HOXA  IMM  TAL  TLX 

```{r, include=TRUE, message=TRUE}
cont.matrix = makeContrasts(HOXA_IMM = HOXA - IMM,
                            HOXA_TAL = HOXA - TAL,
                            HOXA_TLX = HOXA - TLX,
                            
                            IMM_TAL = IMM - TAL,
                            IMM_TLX = IMM - TLX,
                            
                            TAL_TLX = TAL - TLX,
                            
                            
                            levels = colnames(design))
cont.matrix
```




```{r, include=TRUE, message=TRUE}
y = estimateDisp(GSE110636_dgeObjnorm, design, robust = TRUE)
plotBCV(y)
```


Ajuste del modelo

```{r, include=TRUE, message=TRUE}
fit <- glmQLFit(y, design, robust = TRUE)
```

Una vez ajustado el modelo se procede a construir el contraste y realizar el test.


```{r, include=TRUE, message=TRUE}
GSE110636_res <- glmQLFTest(fit, contrast = cont.matrix)
```

Los resultados se almacenan en un objeto similar a la ’ topTable’ de limma.

```{r, include=TRUE, message=TRUE}
topTags_edge <- topTags(GSE110636_res, n = dim(GSE110636_log2countnorm)[1])  # todos los genes

head(topTags_edge)
```

Podemos seleccionar los genes más diferencialmente expresados.

```{r, include=TRUE, message=TRUE}
topGenes_edge1 <- rownames(subset(topTags_edge[["table"]], (abs(topTags_edge[["table"]][["logFC.HOXA_IMM"]]) > 2) & (topTags_edge[["table"]][["FDR"]] < 0.01)))
# topGenes_edge <- rownames(subset(topTags_edge$table, (abs(logFC) > 2) & (FDR < 0.01)))

topGenes_edge2 <- rownames(subset(topTags_edge[["table"]], (abs(topTags_edge[["table"]][["logFC.HOXA_TAL"]]) > 2) & (topTags_edge[["table"]][["FDR"]] < 0.01)))


topGenes_edge3 <- rownames(subset(topTags_edge[["table"]], (abs(topTags_edge[["table"]][["logFC.HOXA_TLX"]]) > 2) & (topTags_edge[["table"]][["FDR"]] < 0.01)))


topGenes_edge4 <- rownames(subset(topTags_edge[["table"]], (abs(topTags_edge[["table"]][["logFC.IMM_TAL"]]) > 2) & (topTags_edge[["table"]][["FDR"]] < 0.01)))


topGenes_edge5 <- rownames(subset(topTags_edge[["table"]], (abs(topTags_edge[["table"]][["logFC.IMM_TLX"]]) > 2) & (topTags_edge[["table"]][["FDR"]] < 0.01)))

topGenes_edge6 <- rownames(subset(topTags_edge[["table"]], (abs(topTags_edge[["table"]][["logFC.TAL_TLX"]]) > 2) & (topTags_edge[["table"]][["FDR"]] < 0.01)))
length(topGenes_edge3)
```

La lista de genes seleccionados es muy similar en ambos casos. Vamos a hacerlo también con otras ecuaciones.


Transformación de los contajes, selección de genes diferencialmente expresados y top tables

```{r, include=TRUE, message=TRUE}
voomObj <- voom(GSE110636_dgeObjnorm, design)
voomObj
fit <- lmFit(voomObj)
fit.cont <- contrasts.fit(fit, cont.matrix)
fit.cont <- eBayes(fit.cont)
toptab1 <- topTable(fit.cont, coef = 1, sort.by = "p", number = nrow(fit.cont))
toptab2 <- topTable(fit.cont, coef = 2, sort.by = "p", number = nrow(fit.cont))
toptab3 <- topTable(fit.cont, coef = 3, sort.by = "p", number = nrow(fit.cont))
toptab4 <- topTable(fit.cont, coef = 4, sort.by = "p", number = nrow(fit.cont))
toptab5 <- topTable(fit.cont, coef = 5, sort.by = "p", number = nrow(fit.cont))
toptab6 <- topTable(fit.cont, coef = 'TAL_TLX', sort.by = "p", number = nrow(fit.cont))
# o bien toptab6 <- topTable(fit.cont, coef = 6, sort.by = "p", number = nrow(fit.cont))


head(toptab4)
```

Visualización de los resultados. De todos en conjunto.


```{r, include=TRUE, message=TRUE}
volcanoplot(fit.cont, coef = 1, highlight = 100, main = "GSE110636")
abline(v = c(-1, 1))
```

Con el fin de observar si existen perfiles de expresión diferenciados podemo realizar un mapa de colores con los genes más diferencialmente expresados.

Es decir, fijamos un criterio de selección de genes y retenemos aquellos componentes de la tabla de resultados que lo cumplen. Por ejemplo: Genes con un p-balor ajustado inferior a 0.001 y un `fold-change’ superior a 2.

```{r, include=TRUE, message=TRUE}
topGenesBas1 <- rownames(subset(toptab1, (abs(toptab1$logFC) > 2) & (toptab1$P.Value < 0.05)))

topGenesBas2 <- rownames(subset(toptab2, (abs(toptab2$logFC) > 2) & (toptab2$P.Value < 0.05)))

topGenesBas3 <- rownames(subset(toptab3, (abs(toptab3$logFC) > 2) & (toptab3$P.Value < 0.05)))

topGenesBas4 <- rownames(subset(toptab4, (abs(toptab4$logFC) > 2) & (toptab4$P.Value < 0.05)))

topGenesBas5 <- rownames(subset(toptab5, (abs(toptab5$logFC) > 2) & (toptab5$P.Value < 0.05)))

topGenesBas6 <- rownames(subset(toptab6, (abs(toptab6$logFC) > 2) & (toptab6$P.Value < 0.05)))
length(topGenesBas6)
```

Usamos el p valor < 0.05, como antes, para poder compararlo con el anterior GSE en el futuro.

```{r, include=TRUE, message=TRUE}
library(pheatmap)
mat <- GSE110636_log2countnorm[topGenesBas1, ]
mat <- mat - rowMeans(mat)
pheatmap(mat, main = 'HOXA_IMM')
mat <- GSE110636_log2countnorm[topGenesBas2, ]
mat <- mat - rowMeans(mat)
pheatmap(mat, main = 'HOXA_TAL')
mat <- GSE110636_log2countnorm[topGenesBas3, ]
mat <- mat - rowMeans(mat)
pheatmap(mat, main = 'HOXA_TLX')
mat <- GSE110636_log2countnorm[topGenesBas4, ]
mat <- mat - rowMeans(mat)
pheatmap(mat, main = 'IMM_TAL')
mat <- GSE110636_log2countnorm[topGenesBas5, ]
mat <- mat - rowMeans(mat)
pheatmap(mat, main = 'IMM_TLX')
mat <- GSE110636_log2countnorm[topGenesBas6, ]
mat <- mat - rowMeans(mat)
pheatmap(mat, main = 'TAL_TLX')

```

```{r, include=TRUE, message=TRUE}
topGenes1 <- union(topGenesBas1, topGenes_edge1)

topGenes2 <- union(topGenesBas2, topGenes_edge2)

topGenes3 <- union(topGenesBas3, topGenes_edge3)

topGenes4 <- union(topGenesBas4, topGenes_edge4)

topGenes5 <- union(topGenesBas5, topGenes_edge5)

topGenes6 <- union(topGenesBas6, topGenes_edge6)

length(topGenes4)
```


```{r, include=TRUE, message=TRUE}
universe1 <- rownames(toptab1)
universe2 <- rownames(toptab2)
universe3 <- rownames(toptab3)
universe4 <- rownames(toptab4)
universe5 <- rownames(toptab5)
universe6 <- rownames(toptab6)
length(universe4)
```

```{r, include=TRUE, message=TRUE}
save(toptab1, toptab2, toptab3, toptab4, toptab5, toptab6,
     universe1, universe2, universe3, universe4, universe5,
     universe6, topGenes1, topGenes2,topGenes3,
     topGenes4,topGenes5,topGenes6,
     topGenesBas1, topGenes_edge1,
     topGenesBas2, topGenes_edge2,
     topGenesBas3, topGenes_edge3,
     topGenesBas4, topGenes_edge4,
     topGenesBas5, topGenes_edge5,
     topGenesBas6, topGenes_edge6,
     
     file='C:/Users/Copito/OneDrive/Documentos/Master bioinf y bioest/TFM/datasets/GSE110636/GSE110636_Toptabs&Universe.Rda')

# save(toptab1, toptab2, toptab3, toptab4, toptab5, toptab6,
     # universe1, universe2, universe3, universe4, universe5,
     # universe6, topGenes, topGenesBas, topGenes_edge,
     # file='C:/Users/crist/Documents/TFM/GSE110633_Toptabs&Universe.Rda')
```




# -------------------------

# GSE8879

## Análisis de significación biológica

Métodos de análisis

Una vez obtenidas las listas de genes diferencialmente expresados pueden llevarse a cabo todo tipo de análisis sobre ellas, generalmente encaminados a facilitar la interpretación de los resultados.

EL análisis de significación biológica de las listas mediante análisis de enriquecimiento (“Over-Representation Analysis”) permite detectar si las listas de genes diferencialmente expresadas presentan una cantidad, superior a la esperada (“se encuentran enriquecidas”), de genes asociados a funciones o procesos biológicos determinados, es decir anotados en categorías biológicamente relevantes para el problema que se estudia.

Alternativamente el “Gene Set Expresion Analysis” permitiría determinar conjuntos de genes que se encuentren asociados a las diferencias que se estudian.

En este caso, y dado que el análisis de la interacción muestra pocos o ningún gen seleccionado tan sólo se realizará un análisis de enriquecimiento para las dos comparaciones simples.

Se han desarrollad multitud de variantes de estos tipos de análisis (Khatri and Drăghici (2005)) pero aquí utilizaremos el análisis básico de enriquecimiento tal como se implementa en el paquete GOstats. Una alternativa interesante la ofrece el paquete clusterprofiler que dispone de algunas herramientas para la visualización de los resultados.

Preparación de listas y del "Universo"

Para seleccionar los genes a incluir en el análisis podemos aplicar el mismo criterio que para las comparaciones múltiples, es decir, conservar aquellos genes con un p-valor ajustado inferior a 0.05

También creamos un vector con todos los identificadores ENTREZ.


```{r, warning=TRUE, error=FALSE}
load('C:/Users/Copito/OneDrive/Documentos/Master bioinf y bioest/TFM/datasets/GSE8879/GSE8879datos.normalizados.Rda')
load('C:/Users/Copito/OneDrive/Documentos/Master bioinf y bioest/TFM/datasets/GSE8879/GSE8879topTab_Anot.Rda')
```


```{r, warning=TRUE, error=FALSE}
library(dplyr)
selGenes_GSE8879 <- (topTab_GSE8879_Anot %>%
    subset(adj.P.Val < 0.05) %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]

geneUniverse <- (topTab_GSE8879_Anot %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]

# La notación anterior pretende ser más clara y acorde con las tendencias
# actuales en R EL mismo resultado se habría podido obtener con un enfoque más
# clásico aunque algo más críptico : selGenes_SoloToxico<-
# unique(subset(topTab_SoloToxico_Anot, adj.P.Val < 0.05)$ENTREZID)
# selGenes_ToxicoEnMet <-unique(subset(topTab_ToxicoEnMet, adj.P.Val <
# 0.05)$ENTREZID) geneUniverse <- unique(topTab_ToxicoEnMet$ENTREZID)

```

Ejecución del análisis de enriquecimiento

El análisis es relativamente sencillo y muy parecido entre distintos paquetes.

-Se crea un “hiperparámetro” con la información de entrada. En este caso crearemos, para cada lista a analizar, un parámetro para la Gene Ontology, en la ontología de “Biological Process” y uno para KEGG. Obsérvese que los parámetros de KEGG se definen de forma más simple dado que KEGG no es una ontología. Además el umbral de selección (p-valor) se deja en un valor superior para evitar que no aparezca ninguna categoría seleccionada, dado que el número de anotaciones es inferior.

-Una vez creados los parámetros el análisis se lleva a cabo invocando la función hyperGTestque realiza un test de Fisher (hipergeométrico) para todas las categorías GO de la ontología seleccionada.




```{r, warning=TRUE, error=FALSE}

library (Category)
library (hgu133a.db)
library(GOstats)


GOparamsGSE8879 <- new("GOHyperGParams", geneIds = selGenes_GSE8879, universeGeneIds = geneUniverse,
    annotation = "hgu133a.db", ontology = "BP", pvalueCutoff = 0.001, conditional = FALSE,
    testDirection = "over")

KEGGparamsGSE8879 <- new("KEGGHyperGParams", geneIds = selGenes_GSE8879, universeGeneIds = geneUniverse,
    annotation = "hgu133a.db", pvalueCutoff = 0.05)

# Ejecutamos los análisis
GOHyperGSE8879 <- hyperGTest(GOparamsGSE8879)
KEGGHyperGSE8879 <- hyperGTest(KEGGparamsGSE8879)
```

Resultados

Los resultados del análisis se encuentran en un objeto que se puede visualizar directamente.

```{r, warning=TRUE, error=FALSE}
summary(GOHyperGSE8879)
summary(KEGGHyperGSE8879)
```

Una mejor opción es exportarlos a un archivo, preferentemente con hiperenlaces que permitan una exploración directa de las categorías

----------



```{r, warning=TRUE, error=FALSE}
a <- (topTab_GSE8879_Anot %>%
          subset(adj.P.Val < 0.05))
unique(a$ENTREZID)
```


```{r, warning=TRUE, error=FALSE}
library(ReactomePA)
enrich.result <- enrichPathway(gene = selGenes_GSE8879,
                               pvalueCutoff = 0.05,
                               readable = T,
                               organism = "human",
                               universe = geneUniverse)

```

```{r, warning=TRUE, error=FALSE}

listOfTables <- list(CvsP = topTab_GSE8879_Anot)

listOfSelected <- list()


for (i in 1:length(listOfTables)){
  # select the toptable
  topTab <- listOfTables[[i]]
  # select the genes to be included in the analysis
  whichGenes<-topTab["P.Value"]<0.05
  selectedIDs <- rownames(topTab)[whichGenes]
  # convert the ID to Entrez
  EntrezIDs<- listOfTables[[i]]$ENTREZID
  listOfSelected[[i]] <- EntrezIDs
  names(listOfSelected)[i] <- names(listOfTables)[i]
}

```



```{r, warning=TRUE, error=FALSE}

listOfData <- listOfSelected
comparisonsNames <- names(listOfData)
universe <- geneUniverse

for (i in 1:length(listOfData)){
  genesIn <- listOfData[[i]]
  comparison <- comparisonsNames[i]
  enrich.r <- enrich.result
  cat("##################################")
  cat("\nComparison: ", comparison,"\n")
  print(head(enrich.r))
}



```



```{r, warning=TRUE, error=FALSE}

barplot(enrich.r, showCategory = 15, font.size = 4,
title = paste0("Reactome Pathway Analysis for ", comparison,". Barplot"))

cnetplot(enrich.r, categorySize = "geneNum", schowCategory = 15, vertex.label.cex = 0.75)
```

```{r, warning=TRUE, error=FALSE}
Path<-enrich.r@result[["ID"]]
Biological_Description<-enrich.r@result[["Description"]]
Gene<-enrich.r@result[["geneID"]]
GSE8879_df<-data.frame(Path, Biological_Description, Gene)
library("xlsx")
write.xlsx(GSE8879_df, 'C:/Users/Copito/OneDrive/Documentos/Master bioinf y bioest/TFM/datasets/GSE8879/Resultado_GSE8879.xlsx', row.names = FALSE,
           col.names = TRUE)
```


# GSE10609


## Análisis de significación biológica


```{r, warning=TRUE, error=FALSE}
load('C:/Users/Copito/OneDrive/Documentos/Master bioinf y bioest/TFM/datasets/GSE10609/GSE10609datos.normalizados.Rda')
load('C:/Users/Copito/OneDrive/Documentos/Master bioinf y bioest/TFM/datasets/GSE10609/GSE10609topTabs_Anot')
```


```{r, warning=TRUE, error=FALSE}
library(dplyr)
selGenes_GSE10609_LMO2TAL1 <- (topTab_GSE10609_LMO2TAL1_Anot%>%
    subset(adj.P.Val < 0.05) %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]

geneUniverse_LMO2TAL1 <- (topTab_GSE10609_LMO2TAL1_Anot %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]


selGenes_GSE10609_HOXATAL1 <- (topTab_GSE10609_HOXATAL1_Anot %>%
    subset(adj.P.Val < 0.05) %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]

geneUniverse_HOXATAL1 <- (topTab_GSE10609_HOXATAL1_Anot %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]


selGenes_GSE10609_HOXALMO2 <- (topTab_GSE10609_HOXALMO2_Anot %>%
    subset(adj.P.Val < 0.05) %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]

geneUniverse_HOXALMO2 <- (topTab_GSE10609_HOXALMO2_Anot %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]


selGenes_GSE10609_HOX11TAL1 <- (topTab_GSE10609_HOX11TAL1_Anot %>%
    subset(adj.P.Val < 0.05) %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]

geneUniverse_HOX11TAL1 <- (topTab_GSE10609_HOX11TAL1_Anot %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]

selGenes_GSE10609_HOX11LMO2 <- (topTab_GSE10609_HOX11LMO2_Anot %>%
    subset(adj.P.Val < 0.05) %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]

geneUniverse_HOX11LMO2 <- (topTab_GSE10609_HOX11LMO2_Anot %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]



selGenes_GSE10609_HOX11L2TAL1 <- (topTab_GSE10609_HOX11L2TAL1_Anot %>%
    subset(adj.P.Val < 0.05) %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]

geneUniverse_HOX11L2TAL1 <- (topTab_GSE10609_HOX11L2TAL1_Anot %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]




selGenes_GSE10609_HOX11L2LMO2 <- (topTab_GSE10609_HOX11L2LMO2_Anot %>%
    subset(adj.P.Val < 0.05) %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]

geneUniverse_HOX11L2LMO2 <- (topTab_GSE10609_HOX11L2LMO2_Anot %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]


selGenes_GSE10609_HOX11L2HOXA <- (topTab_GSE10609_HOX11L2HOXA_Anot %>%
    subset(adj.P.Val < 0.05) %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]

geneUniverse_HOX11L2HOXA <- (topTab_GSE10609_HOX11L2HOXA_Anot %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]



selGenes_GSE10609_HOX11HOXA <- (topTab_GSE10609_HOX11HOXA_Anot %>%
    subset(adj.P.Val < 0.05) %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]

geneUniverse_HOX11HOXA <- (topTab_GSE10609_HOX11HOXA_Anot %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]


selGenes_GSE10609_HOX11HOX11L2TAL1 <- (topTab_GSE10609_HOX11HOX11L2TAL1_Anot %>%
    subset(adj.P.Val < 0.05) %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]

geneUniverse_HOX11HOX11L2TAL1 <- (topTab_GSE10609_HOX11HOX11L2TAL1_Anot %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]



selGenes_GSE10609_HOX11HOX11L2LMO2 <- (topTab_GSE10609_HOX11HOX11L2LMO2_Anot %>%
    subset(adj.P.Val < 0.05) %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]

geneUniverse_HOX11HOX11L2LMO2 <- (topTab_GSE10609_HOX11HOX11L2LMO2_Anot %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]



selGenes_GSE10609_HOX11HOX11L2HOXA <- (topTab_GSE10609_HOX11HOX11L2HOXA_Anot %>%
    subset(adj.P.Val < 0.05) %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]

geneUniverse_HOX11HOX11L2HOXA <- (topTab_GSE10609_HOX11HOX11L2HOXA_Anot %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]


selGenes_GSE10609_HOX <- (topTab_GSE10609_HOX_Anot %>%
    subset(adj.P.Val < 0.05) %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]

geneUniverse_HOX <- (topTab_GSE10609_HOX_Anot %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]



# La notación anterior pretende ser más clara y acorde con las tendencias
# actuales en R EL mismo resultado se habría podido obtener con un enfoque más
# clásico aunque algo más críptico : selGenes_SoloToxico<-
# unique(subset(topTab_SoloToxico_Anot, adj.P.Val < 0.05)$ENTREZID)
# selGenes_ToxicoEnMet <-unique(subset(topTab_ToxicoEnMet, adj.P.Val <
# 0.05)$ENTREZID) geneUniverse <- unique(topTab_ToxicoEnMet$ENTREZID)

```

Ejecución del análisis de enriquecimiento

selGenes_GSE10609_LMO2TAL1, selGenes_GSE10609_HOXATAL1, selGenes_GSE10609_HOXALMO2, selGenes_GSE10609_HOX11TAL1, selGenes_GSE10609_HOX11LMO2, selGenes_GSE10609_HOX11L2TAL1, selGenes_GSE10609_HOX11L2LMO2, selGenes_GSE10609_HOX11L2HOXA, selGenes_GSE10609_HOX11HOXA, selGenes_GSE10609_HOX11HOX11L2TAL1, selGenes_GSE10609_HOX11HOX11L2LMO2, selGenes_GSE10609_HOX11HOX11L2HOXA, selGenes_GSE10609_HOX



```{r, warning=TRUE, error=TRUE}

library (Category)
library (hgu133plus2.db)
library(GOstats)


# selGenes_GSE10609_LMO2TAL1

GOparamsGSE10609_LMO2TAL1 <- new("GOHyperGParams", geneIds = selGenes_GSE10609_LMO2TAL1, universeGeneIds = geneUniverse_LMO2TAL1,
    annotation = "hgu133plus2.db", ontology = "BP", pvalueCutoff = 0.001, conditional = FALSE,
    testDirection = "over")

KEGGparamsGSE10609_LMO2TAL1 <- new("KEGGHyperGParams", geneIds = selGenes_GSE10609_LMO2TAL1, universeGeneIds = geneUniverse_LMO2TAL1,
    annotation = "hgu133plus2.db", pvalueCutoff = 0.05)

# Ejecutamos los análisis
GOHyperGSE10609_LMO2TAL1 <- hyperGTest(GOparamsGSE10609_LMO2TAL1)
KEGGHyperGSE10609_LMO2TAL1 <- hyperGTest(KEGGparamsGSE10609_LMO2TAL1)



# selGenes_GSE10609_HOXATAL1


GOparamsGSE10609_HOXATAL1 <- new("GOHyperGParams", geneIds = selGenes_GSE10609_HOXATAL1, universeGeneIds = geneUniverse_HOXATAL1,
    annotation = "hgu133plus2.db", ontology = "BP", pvalueCutoff = 0.001, conditional = FALSE,
    testDirection = "over")

KEGGparamsGSE10609_HOXATAL1 <- new("KEGGHyperGParams", geneIds = selGenes_GSE10609_HOXATAL1, universeGeneIds = geneUniverse_HOXATAL1,
    annotation = "hgu133plus2.db", pvalueCutoff = 0.05)

GOHyperGSE10609_HOXATAL1 <- hyperGTest(GOparamsGSE10609_HOXATAL1)
KEGGHyperGSE10609_HOXATAL1 <- hyperGTest(KEGGparamsGSE10609_HOXATAL1)


# selGenes_GSE10609_HOXALMO2

GOparamsGSE10609_HOXALMO2 <- new("GOHyperGParams", geneIds = selGenes_GSE10609_HOXALMO2, universeGeneIds = geneUniverse_HOXALMO2,
    annotation = "hgu133plus2.db", ontology = "BP", pvalueCutoff = 0.001, conditional = FALSE,
    testDirection = "over")

KEGGparamsGSE10609_HOXALMO2 <- new("KEGGHyperGParams", geneIds = selGenes_GSE10609_HOXALMO2, universeGeneIds = geneUniverse_HOXALMO2,
    annotation = "hgu133plus2.db", pvalueCutoff = 0.05)

GOHyperGSE10609_HOXALMO2 <- hyperGTest(GOparamsGSE10609_HOXALMO2)
KEGGHyperGSE10609_HOXALMO2 <- hyperGTest(KEGGparamsGSE10609_HOXALMO2)

# selGenes_GSE10609_HOX11TAL1

GOparamsGSE10609_HOX11TAL1 <- new("GOHyperGParams", geneIds = selGenes_GSE10609_HOX11TAL1, universeGeneIds = geneUniverse_HOX11TAL1,
    annotation = "hgu133plus2.db", ontology = "BP", pvalueCutoff = 0.001, conditional = FALSE,
    testDirection = "over")

KEGGparamsGSE10609_HOX11TAL1 <- new("KEGGHyperGParams", geneIds = selGenes_GSE10609_HOX11TAL1, universeGeneIds = geneUniverse_HOX11TAL1,
    annotation = "hgu133plus2.db", pvalueCutoff = 0.05)

GOHyperGSE10609_HOX11TAL1 <- hyperGTest(GOparamsGSE10609_HOX11TAL1)
KEGGHyperGSE10609_HOX11TAL1 <- hyperGTest(KEGGparamsGSE10609_HOX11TAL1)



# selGenes_GSE10609_HOX11LMO2

GOparamsGSE10609_HOX11LMO2 <- new("GOHyperGParams", geneIds = selGenes_GSE10609_HOX11LMO2, universeGeneIds = geneUniverse_HOX11LMO2,
    annotation = "hgu133plus2.db", ontology = "BP", pvalueCutoff = 0.001, conditional = FALSE,
    testDirection = "over")

KEGGparamsGSE10609_HOX11LMO2 <- new("KEGGHyperGParams", geneIds = selGenes_GSE10609_HOX11LMO2, universeGeneIds = geneUniverse_HOX11LMO2,
    annotation = "hgu133plus2.db", pvalueCutoff = 0.05)

GOHyperGSE10609_HOX11TAL1 <- hyperGTest(GOparamsGSE10609_HOX11LMO2)
KEGGHyperGSE10609_HOX11TAL1 <- hyperGTest(KEGGparamsGSE10609_HOX11LMO2)

# selGenes_GSE10609_HOX11L2TAL1

GOparamsGSE10609_HOX11L2TAL1 <- new("GOHyperGParams", geneIds = selGenes_GSE10609_HOX11L2TAL1, universeGeneIds = geneUniverse_HOX11L2TAL1,
    annotation = "hgu133plus2.db", ontology = "BP", pvalueCutoff = 0.001, conditional = FALSE,
    testDirection = "over")

KEGGparamsGSE10609_HOX11L2TAL1 <- new("KEGGHyperGParams", geneIds = selGenes_GSE10609_HOX11L2TAL1, universeGeneIds = geneUniverse_HOX11L2TAL1,
    annotation = "hgu133plus2.db", pvalueCutoff = 0.05)

GOHyperGSE10609_HOX11L2TAL1 <- hyperGTest(GOparamsGSE10609_HOX11L2TAL1)
KEGGHyperGSE10609_HOX11L2TAL1 <- hyperGTest(KEGGparamsGSE10609_HOX11L2TAL1)


# selGenes_GSE10609_HOX11L2LMO2

GOparamsGSE10609_HOX11L2LMO2 <- new("GOHyperGParams", geneIds = selGenes_GSE10609_HOX11L2LMO2, universeGeneIds = geneUniverse_HOX11L2LMO2,
    annotation = "hgu133plus2.db", ontology = "BP", pvalueCutoff = 0.001, conditional = FALSE,
    testDirection = "over")

KEGGparamsGSE10609_HOX11L2LMO2 <- new("KEGGHyperGParams", geneIds = selGenes_GSE10609_HOX11L2LMO2, universeGeneIds = geneUniverse_HOX11L2LMO2,
    annotation = "hgu133plus2.db", pvalueCutoff = 0.05)

GOHyperGSE10609_HOX11L2LMO2 <- hyperGTest(GOparamsGSE10609_HOX11L2LMO2)
KEGGHyperGSE10609_HOX11L2LMO2 <- hyperGTest(KEGGparamsGSE10609_HOX11L2LMO2)


# selGenes_GSE10609_HOX11L2HOXA

GOparamsGSE10609_HOX11L2HOXA <- new("GOHyperGParams", geneIds = selGenes_GSE10609_HOX11L2HOXA, universeGeneIds = geneUniverse_HOX11L2HOXA,
    annotation = "hgu133plus2.db", ontology = "BP", pvalueCutoff = 0.001, conditional = FALSE,
    testDirection = "over")

KEGGparamsGSE10609_HOX11L2HOXA <- new("KEGGHyperGParams", geneIds = selGenes_GSE10609_HOX11L2HOXA, universeGeneIds = geneUniverse_HOX11L2HOXA,
    annotation = "hgu133plus2.db", pvalueCutoff = 0.05)

GOHyperGSE10609_HOX11L2HOXA <- hyperGTest(GOparamsGSE10609_HOX11L2HOXA)
KEGGHyperGSE10609_HOX11L2HOXA <- hyperGTest(KEGGparamsGSE10609_HOX11L2HOXA)



# selGenes_GSE10609_HOX11HOXA

GOparamsGSE10609_HOX11HOXA <- new("GOHyperGParams", geneIds = selGenes_GSE10609_HOX11HOXA, universeGeneIds = geneUniverse_HOX11HOXA,
    annotation = "hgu133plus2.db", ontology = "BP", pvalueCutoff = 0.001, conditional = FALSE,
    testDirection = "over")

KEGGparamsGSE10609_HOX11HOXA <- new("KEGGHyperGParams", geneIds = selGenes_GSE10609_HOX11HOXA, universeGeneIds = geneUniverse_HOX11HOXA,
    annotation = "hgu133plus2.db", pvalueCutoff = 0.05)

GOHyperGSE10609_HOX11HOXA <- hyperGTest(GOparamsGSE10609_HOX11HOXA)
KEGGHyperGSE10609_HOX11HOXA <- hyperGTest(KEGGparamsGSE10609_HOX11HOXA)

# selGenes_GSE10609_HOX11HOX11L2TAL1

GOparamsGSE10609_HOX11HOX11L2TAL1<- new("GOHyperGParams", geneIds = selGenes_GSE10609_HOX11HOX11L2TAL1, universeGeneIds = geneUniverse_HOX11HOX11L2TAL1,
    annotation = "hgu133plus2.db", ontology = "BP", pvalueCutoff = 0.001, conditional = FALSE,
    testDirection = "over")

KEGGparamsGSE10609_HOX11HOX11L2TAL1 <- new("KEGGHyperGParams", geneIds = selGenes_GSE10609_HOX11HOX11L2TAL1, universeGeneIds = geneUniverse_HOX11HOX11L2TAL1,
    annotation = "hgu133plus2.db", pvalueCutoff = 0.05)

GOHyperGSE10609_HOX11HOX11L2TAL1 <- hyperGTest(GOparamsGSE10609_HOX11HOX11L2TAL1)
KEGGHyperGSE10609_HOX11HOX11L2TAL1 <- hyperGTest(KEGGparamsGSE10609_HOX11HOX11L2TAL1)


# selGenes_GSE10609_HOX11HOX11L2LMO2

GOparamsGSE10609_HOX11HOX11L2LMO2<- new("GOHyperGParams", geneIds = selGenes_GSE10609_HOX11HOX11L2LMO2, universeGeneIds = geneUniverse_HOX11HOX11L2LMO2,
    annotation = "hgu133plus2.db", ontology = "BP", pvalueCutoff = 0.001, conditional = FALSE,
    testDirection = "over")

KEGGparamsGSE10609_HOX11HOX11L2LMO2 <- new("KEGGHyperGParams", geneIds = selGenes_GSE10609_HOX11HOX11L2LMO2, universeGeneIds = geneUniverse_HOX11HOX11L2LMO2,
    annotation = "hgu133plus2.db", pvalueCutoff = 0.05)

GOHyperGSE10609_HOX11HOX11L2LMO2 <- hyperGTest(GOparamsGSE10609_HOX11HOX11L2LMO2)
KEGGHyperGSE10609_HOX11HOX11L2LMO2 <- hyperGTest(KEGGparamsGSE10609_HOX11HOX11L2LMO2)



# selGenes_GSE10609_HOX11HOX11L2HOXA

GOparamsGSE10609_HOX11HOX11L2HOXA <- new("GOHyperGParams", geneIds = selGenes_GSE10609_HOX11HOX11L2HOXA, universeGeneIds = geneUniverse_HOX11HOX11L2LMO2,
    annotation = "hgu133plus2.db", ontology = "BP", pvalueCutoff = 0.001, conditional = FALSE,
    testDirection = "over")

KEGGparamsGSE10609_HOX11HOX11L2HOXA <- new("KEGGHyperGParams", geneIds = selGenes_GSE10609_HOX11HOX11L2HOXA, universeGeneIds = geneUniverse_HOX11HOX11L2LMO2,
    annotation = "hgu133plus2.db", pvalueCutoff = 0.05)

GOHyperGSE10609_HOX11HOX11L2HOXA <- hyperGTest(GOparamsGSE10609_HOX11HOX11L2HOXA)
KEGGHyperGSE10609_HOX11HOX11L2HOXA <- hyperGTest(KEGGparamsGSE10609_HOX11HOX11L2HOXA)

# selGenes_GSE10609_HOX

GOparamsGSE10609_HOX <- new("GOHyperGParams", geneIds = selGenes_GSE10609_HOX, universeGeneIds = geneUniverse_HOX,
    annotation = "hgu133plus2.db", ontology = "BP", pvalueCutoff = 0.001, conditional = FALSE,
    testDirection = "over")

KEGGparamsGSE10609_HOX <- new("KEGGHyperGParams", geneIds = selGenes_GSE10609_HOX, universeGeneIds = geneUniverse_HOX,
    annotation = "hgu133plus2.db", pvalueCutoff = 0.05)

GOHyperGSE10609_HOX <- hyperGTest(GOparamsGSE10609_HOX)
KEGGHyperGSE10609_HOX <- hyperGTest(KEGGparamsGSE10609_HOX)


```

Resultados


```{r, warning=TRUE, error=FALSE}
summary(GOparamsGSE10609_HOX11L2LMO2)
summary(KEGGparamsGSE10609_HOX11HOX11L2TAL1)
```


----------

topTab_GSE10609_LMO2TAL1_Anot, topTab_GSE10609_HOXATAL1_Anot, topTab_GSE10609_HOXALMO2_Anot, topTab_GSE10609_HOX11TAL1_Anot, topTab_GSE10609_HOX11LMO2_Anot, topTab_GSE10609_HOX11L2TAL1_Anot,  topTab_GSE10609_HOX11L2LMO2_Anot, topTab_GSE10609_HOX11L2HOXA_Anot, topTab_GSE10609_HOX11HOXA_Anot, topTab_GSE10609_HOX11HOX11L2TAL1_Anot, topTab_GSE10609_HOX11HOX11L2LMO2_Anot, topTab_GSE10609_HOX11HOX11L2HOXA_Anot,  topTab_GSE10609_HOX_Anot


```{r, warning=TRUE, error=FALSE}
library(dplyr)

a <- (topTab_GSE10609_LMO2TAL1_Anot %>%
          subset(P.Value < 0.05))
unique(a$ENTREZID)

library(ReactomePA)
enrich.result_LMO2TAL1 <- enrichPathway(gene = selGenes_GSE10609_LMO2TAL1,
                               pvalueCutoff = 0.05,
                               readable = T,
                               organism = "human",
                               universe = geneUniverse_LMO2TAL1)

# NO hay selGenes. Dice la función:
# --> No gene can be mapped....
# --> Expected input gene ID: 4170,6303,729020,6547,1854,1361
# --> return NULL...

enrich.result_HOXATAL1 <- enrichPathway(gene = selGenes_GSE10609_HOXATAL1,
                               pvalueCutoff = 0.05,
                               readable = T,
                               organism = "human",
                               universe = geneUniverse_HOXATAL1)


enrich.result_HOXALMO2 <- enrichPathway(gene = selGenes_GSE10609_HOXALMO2,
                               pvalueCutoff = 0.05,
                               readable = T,
                               organism = "human",
                               universe = geneUniverse_HOXALMO2)

enrich.result_HOX11TAL1 <- enrichPathway(gene = selGenes_GSE10609_HOX11TAL1,
                               pvalueCutoff = 0.05,
                               readable = T,
                               organism = "human",
                               universe = geneUniverse_HOX11TAL1)


enrich.result_HOX11LMO2 <- enrichPathway(gene = selGenes_GSE10609_HOX11LMO2,
                               pvalueCutoff = 0.05,
                               readable = T,
                               organism = "human",
                               universe = geneUniverse_HOX11LMO2)


enrich.result_HOX11L2TAL1 <- enrichPathway(gene = selGenes_GSE10609_HOX11L2TAL1,
                               pvalueCutoff = 0.05,
                               readable = T,
                               organism = "human",
                               universe = geneUniverse_HOX11L2TAL1)




enrich.result_HOX11L2LMO2 <- enrichPathway(gene = selGenes_GSE10609_HOX11L2LMO2,
                               pvalueCutoff = 0.05,
                               readable = T,
                               organism = "human",
                               universe = geneUniverse_HOX11L2LMO2)


enrich.result_HOX11L2HOXA <- enrichPathway(gene = selGenes_GSE10609_HOX11L2HOXA,
                               pvalueCutoff = 0.05,
                               readable = T,
                               organism = "human",
                               universe = geneUniverse_HOX11L2HOXA)


enrich.result_HOX11HOXA <- enrichPathway(gene = selGenes_GSE10609_HOX11HOXA,
                               pvalueCutoff = 0.05,
                               readable = T,
                               organism = "human",
                               universe = geneUniverse_HOX11HOXA)

enrich.result_HOX11HOX11L2TAL1 <- enrichPathway(gene = selGenes_GSE10609_HOX11HOX11L2TAL1,
                               pvalueCutoff = 0.05,
                               readable = T,
                               organism = "human",
                               universe = geneUniverse_HOX11HOX11L2TAL1)

enrich.result_HOX11HOX11L2LMO2 <- enrichPathway(gene = selGenes_GSE10609_HOX11HOX11L2LMO2,
                               pvalueCutoff = 0.05,
                               readable = T,
                               organism = "human",
                               universe = geneUniverse_HOX11HOX11L2LMO2)

enrich.result_HOX11HOX11L2HOXA <- enrichPathway(gene = selGenes_GSE10609_HOX11HOX11L2HOXA,
                               pvalueCutoff = 0.05,
                               readable = T,
                               organism = "human",
                               universe = geneUniverse_HOX11HOX11L2HOXA)

enrich.result_HOX <- enrichPathway(gene = selGenes_GSE10609_HOX,
                               pvalueCutoff = 0.05,
                               readable = T,
                               organism = "human",
                               universe = geneUniverse_HOX)


```

topTab_GSE10609_LMO2TAL1_Anot, topTab_GSE10609_HOXATAL1_Anot, topTab_GSE10609_HOXALMO2_Anot, topTab_GSE10609_HOX11TAL1_Anot, topTab_GSE10609_HOX11LMO2_Anot, topTab_GSE10609_HOX11L2TAL1_Anot,  topTab_GSE10609_HOX11L2LMO2_Anot, topTab_GSE10609_HOX11L2HOXA_Anot, topTab_GSE10609_HOX11HOXA_Anot, topTab_GSE10609_HOX11HOX11L2TAL1_Anot, topTab_GSE10609_HOX11HOX11L2LMO2_Anot, topTab_GSE10609_HOX11HOX11L2HOXA_Anot,  topTab_GSE10609_HOX_Anot

```{r, warning=TRUE, error=FALSE}

listOfTables <- list(LMO2TAL1 = topTab_GSE10609_LMO2TAL1_Anot,
                     HOXATAL1 = topTab_GSE10609_HOXATAL1_Anot,
                     HOXALMO2 = topTab_GSE10609_HOXALMO2_Anot,
                     HOX11TAL1 = topTab_GSE10609_HOX11TAL1_Anot,
                     HOX11LMO2 = topTab_GSE10609_HOX11LMO2_Anot,
                     HOX11L2TAL1 = topTab_GSE10609_HOX11L2TAL1_Anot,
                     HOX11L2LMO2 = topTab_GSE10609_HOX11L2LMO2_Anot,
                     HOX11L2HOXA = topTab_GSE10609_HOX11L2HOXA_Anot,
                     HOX11HOXA = topTab_GSE10609_HOX11HOXA_Anot,
                     HOX11HOX11L2TAL1 = topTab_GSE10609_HOX11HOX11L2TAL1_Anot,
                     HOX11HOX11L2LMO2 = topTab_GSE10609_HOX11HOX11L2LMO2_Anot,
                     HOX11HOX11L2HOXA = topTab_GSE10609_HOX11HOX11L2HOXA_Anot,
                     HOX = topTab_GSE10609_HOX_Anot)

listOfSelected <- list()


for (i in 1:length(listOfTables)){
  # select the toptable
  topTab <- listOfTables[[i]]
  # select the genes to be included in the analysis
  whichGenes<-topTab["P.Value"]<0.05
  selectedIDs <- rownames(topTab)[whichGenes]
  # convert the ID to Entrez
  EntrezIDs<- listOfTables[[i]]$ENTREZID
  listOfSelected[[i]] <- EntrezIDs
  names(listOfSelected)[i] <- names(listOfTables)[i]
}

```



```{r, warning=TRUE, error=FALSE}

listOfData <- listOfSelected
comparisonsNames <- names(listOfData)
universes <- list(geneUniverse_LMO2TAL1, geneUniverse_HOXATAL1,
                  geneUniverse_HOXALMO2,geneUniverse_HOX11TAL1,
                  geneUniverse_HOX11LMO2, geneUniverse_HOX11L2TAL1,
                  geneUniverse_HOX11L2LMO2, geneUniverse_HOX11L2HOXA,
                  geneUniverse_HOX11HOXA, geneUniverse_HOX11HOX11L2TAL1,
                  geneUniverse_HOX11HOX11L2LMO2, geneUniverse_HOX11HOX11L2HOXA,
                  geneUniverse_HOX)
table(universes[[1]] == geneUniverse_LMO2TAL1)

enrich.results=list(enrich.result_LMO2TAL1, enrich.result_HOXATAL1,
                    enrich.result_HOXALMO2, enrich.result_HOX11TAL1,
                    enrich.result_HOX11LMO2, enrich.result_HOX11L2TAL1,
                    enrich.result_HOX11L2LMO2, enrich.result_HOX11L2HOXA,
                    enrich.result_HOX11HOXA, enrich.result_HOX11HOX11L2TAL1,
                    enrich.result_HOX11HOX11L2LMO2, enrich.result_HOX11HOX11L2HOXA,
                    enrich.result_HOX)

```



```{r, warning=TRUE, error=FALSE}

for (i in 1:length(listOfData)){
  universe<-universes[[i]]
  enrich.result<-enrich.results[[i]]
  genesIn <- listOfData[[i]]
  comparison <- comparisonsNames[i]
  enrich.r <- enrich.result
  cat("##################################")
  cat("\nComparison: ", comparison,"\n")
  print(head(enrich.r))
}





```


```{r, warning=TRUE, error=FALSE}
enrich.result<-enrich.results[[2]]
enrich.r <- enrich.result

barplot(enrich.r, showCategory = 15, font.size = 4,
title = paste0("Reactome Pathway Analysis for ", comparison,". Barplot"))

cnetplot(enrich.r, categorySize = "geneNum", schowCategory = 15, vertex.label.cex = 0.75)


enrich.result<-enrich.results[[6]]
enrich.r <- enrich.result

barplot(enrich.r, showCategory = 15, font.size = 4,
title = paste0("Reactome Pathway Analysis for ", comparison,". Barplot"))

cnetplot(enrich.r, categorySize = "geneNum", schowCategory = 15, vertex.label.cex = 0.75)


enrich.result<-enrich.results[[9]]
enrich.r <- enrich.result

barplot(enrich.r, showCategory = 15, font.size = 4,
title = paste0("Reactome Pathway Analysis for ", comparison,". Barplot"))

cnetplot(enrich.r, categorySize = "geneNum", schowCategory = 15, vertex.label.cex = 0.75)



enrich.result<-enrich.results[[13]]
enrich.r <- enrich.result

barplot(enrich.r, showCategory = 15, font.size = 4,
title = paste0("Reactome Pathway Analysis for ", comparison,". Barplot"))

cnetplot(enrich.r, categorySize = "geneNum", schowCategory = 15, vertex.label.cex = 0.75)
```

```{r, warning=TRUE, error=TRUE}



enrich.result<-enrich.results[[1]]
enrich.r <- enrich.result
Path<-enrich.r@result[["ID"]]
Biological_Description<-enrich.r@result[["Description"]]
Gene<-enrich.r@result[["geneID"]]
GSE10609_LMO2TAL1<-data.frame(Path, Biological_Description, Gene)


enrich.result<-enrich.results[[2]]
enrich.r <- enrich.result
Path<-enrich.r@result[["ID"]]
Biological_Description<-enrich.r@result[["Description"]]
Gene<-enrich.r@result[["geneID"]]
GSE10609_HOXATAL1<-data.frame(Path, Biological_Description, Gene)


enrich.result<-enrich.results[[3]]
enrich.r <- enrich.result
Path<-enrich.r@result[["ID"]]
Biological_Description<-enrich.r@result[["Description"]]
Gene<-enrich.r@result[["geneID"]]
GSE10609_HOXALMO2<-data.frame(Path, Biological_Description, Gene)


enrich.result<-enrich.results[[4]]
enrich.r <- enrich.result
Path<-enrich.r@result[["ID"]]
Biological_Description<-enrich.r@result[["Description"]]
Gene<-enrich.r@result[["geneID"]]
GSE10609_HOX11TAL1<-data.frame(Path, Biological_Description, Gene)



enrich.result<-enrich.results[[5]]
enrich.r <- enrich.result
Path<-enrich.r@result[["ID"]]
Biological_Description<-enrich.r@result[["Description"]]
Gene<-enrich.r@result[["geneID"]]
GSE10609_HOX11LMO2<-data.frame(Path, Biological_Description, Gene)


enrich.result<-enrich.results[[6]]
enrich.r <- enrich.result
Path<-enrich.r@result[["ID"]]
Biological_Description<-enrich.r@result[["Description"]]
Gene<-enrich.r@result[["geneID"]]
GSE10609_HOX11L2TAL1<-data.frame(Path, Biological_Description, Gene)

enrich.result<-enrich.results[[7]]
enrich.r <- enrich.result
Path<-enrich.r@result[["ID"]]
Biological_Description<-enrich.r@result[["Description"]]
Gene<-enrich.r@result[["geneID"]]
GSE10609_HOX11L2LMO2<-data.frame(Path, Biological_Description, Gene)

# enrich.result_LMO2TAL1, enrich.result_HOXATAL1,
#                     enrich.result_HOXALMO2, enrich.result_HOX11TAL1,
 #                    enrich.result_HOX11LMO2, enrich.result_HOX11L2TAL1,
 #                    enrich.result_HOX11L2LMO2, enrich.result_HOX11L2HOXA,
 #                    enrich.result_HOX11HOXA, enrich.result_HOX11HOX11L2TAL1,
 #                    enrich.result_HOX11HOX11L2LMO2, enrich.result_HOX11HOX11L2HOXA,
 #                    enrich.result_HOX
                     
                     
enrich.result<-enrich.results[[8]]
enrich.r <- enrich.result
Path<-enrich.r@result[["ID"]]
Biological_Description<-enrich.r@result[["Description"]]
Gene<-enrich.r@result[["geneID"]]
GSE10609_HOX11L2HOXA<-data.frame(Path, Biological_Description, Gene)

enrich.result<-enrich.results[[9]]
enrich.r <- enrich.result
Path<-enrich.r@result[["ID"]]
Biological_Description<-enrich.r@result[["Description"]]
Gene<-enrich.r@result[["geneID"]]
GSE10609_HOX11HOXA<-data.frame(Path, Biological_Description, Gene)


enrich.result<-enrich.results[[10]]
enrich.r <- enrich.result
Path<-enrich.r@result[["ID"]]
Biological_Description<-enrich.r@result[["Description"]]
Gene<-enrich.r@result[["geneID"]]
GSE10609_HOX11HOX11L2TAL1<-data.frame(Path, Biological_Description, Gene)

enrich.result<-enrich.results[[11]]
enrich.r <- enrich.result
Path<-enrich.r@result[["ID"]]
Biological_Description<-enrich.r@result[["Description"]]
Gene<-enrich.r@result[["geneID"]]
GSE10609_HOX11HOX11L2LMO2<-data.frame(Path, Biological_Description, Gene)


enrich.result<-enrich.results[[12]]
enrich.r <- enrich.result
Path<-enrich.r@result[["ID"]]
Biological_Description<-enrich.r@result[["Description"]]
Gene<-enrich.r@result[["geneID"]]
GSE10609_HOX11HOX11L2HOXA<-data.frame(Path, Biological_Description, Gene)

enrich.result<-enrich.results[[13]]
enrich.r <- enrich.result
Path<-enrich.r@result[["ID"]]
Biological_Description<-enrich.r@result[["Description"]]
Gene<-enrich.r@result[["geneID"]]
GSE10609_HOX<-data.frame(Path, Biological_Description, Gene)

```

```{r, warning=TRUE, error=FALSE}

library("xlsx")
write.xlsx(GSE10609_HOX,
           'C:/Users/Copito/OneDrive/Documentos/Master bioinf y bioest/TFM/datasets/GSE10609/Resultado_HOX.xlsx', row.names = FALSE,
           col.names = TRUE)

write.xlsx(GSE10609_HOX11HOX11L2HOXA,
           'C:/Users/Copito/OneDrive/Documentos/Master bioinf y bioest/TFM/datasets/GSE10609/Resultado_HOX11HOX11L2HOXA.xlsx', row.names = FALSE,
           col.names = TRUE)

write.xlsx(GSE10609_HOX11HOX11L2LMO2,
           'C:/Users/Copito/OneDrive/Documentos/Master bioinf y bioest/TFM/datasets/GSE10609/Resultado_HOX11HOX11L2LMO2.xlsx', row.names = FALSE,
           col.names = TRUE)

write.xlsx(GSE10609_HOX11HOX11L2TAL1,
           'C:/Users/Copito/OneDrive/Documentos/Master bioinf y bioest/TFM/datasets/GSE10609/Resultado_HOX11HOX11L2TAL1.xlsx', row.names = FALSE,
           col.names = TRUE)

write.xlsx(GSE10609_HOX11HOXA,
           'C:/Users/Copito/OneDrive/Documentos/Master bioinf y bioest/TFM/datasets/GSE10609/Resultado_HOX11HOXA.xlsx', row.names = FALSE,
           col.names = TRUE)

write.xlsx(GSE10609_HOX11L2HOXA,
           'C:/Users/Copito/OneDrive/Documentos/Master bioinf y bioest/TFM/datasets/GSE10609/Resultado_HOX11L2HOXA.xlsx', row.names = FALSE,
           col.names = TRUE)
write.xlsx(GSE10609_HOX11L2LMO2,
           'C:/Users/Copito/OneDrive/Documentos/Master bioinf y bioest/TFM/datasets/GSE10609/Resultado_HOX11L2LMO2.xlsx', row.names = FALSE,
           col.names = TRUE)

write.xlsx(GSE10609_HOX11L2TAL1,
           'C:/Users/Copito/OneDrive/Documentos/Master bioinf y bioest/TFM/datasets/GSE10609/Resultado_HOX11L2TAL1.xlsx', row.names = FALSE,
           col.names = TRUE)
write.xlsx(GSE10609_HOX11LMO2,
           'C:/Users/Copito/OneDrive/Documentos/Master bioinf y bioest/TFM/datasets/GSE10609/Resultado_HOX11LMO2.xlsx', row.names = FALSE,
           col.names = TRUE)
write.xlsx(GSE10609_HOX11TAL1,
           'C:/Users/Copito/OneDrive/Documentos/Master bioinf y bioest/TFM/datasets/GSE10609/Resultado_HOX11TAL1.xlsx', row.names = FALSE,
           col.names = TRUE)
write.xlsx(GSE10609_HOXATAL1,
           'C:/Users/Copito/OneDrive/Documentos/Master bioinf y bioest/TFM/datasets/GSE10609/Resultado_HOXATAL1.xlsx', row.names = FALSE,
           col.names = TRUE)


save(GSE10609_HOX,
           GSE10609_HOX11HOX11L2HOXA,
           GSE10609_HOX11HOX11L2LMO2,
           GSE10609_HOX11HOX11L2TAL1,
           GSE10609_HOX11HOXA,
           GSE10609_HOX11L2HOXA,
           GSE10609_HOX11L2LMO2,
           GSE10609_HOX11L2TAL1,
           GSE10609_HOX11LMO2,
           GSE10609_HOX11TAL1,
           GSE10609_HOXATAL1,
           file = 'C:/Users/Copito/OneDrive/Documentos/Master bioinf y bioest/TFM/datasets/GSE10609/Resultado_GSE10609.rda')

```

# GSE14618_GPL570

## Análisis de significación biológica


```{r, warning=TRUE, error=FALSE}
library("readxl")
read_excel('C:/Users/Copito/OneDrive/Documentos/Master bioinf y bioest/TFM/datasets/GSE14618/GSE14618_GPL570_geneIds.xlsx')
load('C:/Users/Copito/OneDrive/Documentos/Master bioinf y bioest/TFM/datasets/GSE14618/GSE14618_GPL570_topTabs_Anot.RData')
```


```{r, warning=TRUE, error=FALSE}
library(dplyr)
selGenes_CFAnot <- (topTab_GSE14618_GPL570_CFAnot %>%
    subset(adj.P.Val < 0.05) %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]

geneUniverse_CFAnot <- (topTab_GSE14618_GPL570_CFAnot %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]

selGenes_CNRAnot <- (topTab_GSE14618_GPL570_CNRAnot %>%
    subset(adj.P.Val < 0.05) %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]

geneUniverse_CNRAnot <- (topTab_GSE14618_GPL570_CNRAnot %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]


selGenes_FNRAnot <- (topTab_GSE14618_GPL570_FNRAnot %>%
    subset(adj.P.Val < 0.05) %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]

geneUniverse_FNRAnot <- (topTab_GSE14618_GPL570_FNRAnot %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]

# La notación anterior pretende ser más clara y acorde con las tendencias
# actuales en R EL mismo resultado se habría podido obtener con un enfoque más
# clásico aunque algo más críptico : selGenes_SoloToxico<-
# unique(subset(topTab_SoloToxico_Anot, adj.P.Val < 0.05)$ENTREZID)
# selGenes_ToxicoEnMet <-unique(subset(topTab_ToxicoEnMet, adj.P.Val <
# 0.05)$ENTREZID) geneUniverse <- unique(topTab_ToxicoEnMet$ENTREZID)

```

Ejecución del análisis de enriquecimiento

```{r, warning=TRUE, error=TRUE}

library (Category)
library (hgu133plus2.db)
library(GOstats)


GOparams_CFAnot <- new("GOHyperGParams", geneIds = selGenes_CFAnot, universeGeneIds = geneUniverse_CFAnot,
    annotation = "hgu133plus2.db", ontology = "BP", pvalueCutoff = 0.05, conditional = FALSE,
    testDirection = "over")

KEGGparams_CFAnot <- new("KEGGHyperGParams", geneIds = selGenes_CFAnot, universeGeneIds = geneUniverse_CFAnot,
    annotation = "hgu133plus2.db", pvalueCutoff = 0.05)

# Ejecutamos los análisis
GOHyper_CFAnot <- hyperGTest(GOparams_CFAnot)
KEGGHyper_CFAnot <- hyperGTest(KEGGparams_CFAnot)

# -----



GOparams_CNRAnot <- new("GOHyperGParams", geneIds = selGenes_CNRAnot, universeGeneIds = geneUniverse_CNRAnot,
    annotation = "hgu133plus2.db", ontology = "BP", pvalueCutoff = 0.05, conditional = FALSE,
    testDirection = "over")

KEGGparams_CNRAnot <- new("KEGGHyperGParams", geneIds = selGenes_CNRAnot, universeGeneIds = geneUniverse_CNRAnot,
    annotation = "hgu133plus2.db", pvalueCutoff = 0.05)

# Ejecutamos los análisis
GOHyper_CNRAnot <- hyperGTest(GOparams_CNRAnot)
KEGGHyper_CNRAnot <- hyperGTest(KEGGparams_CNRAnot)


# --


GOparams_FNRAnot <- new("GOHyperGParams", geneIds = selGenes_FNRAnot, universeGeneIds = geneUniverse_FNRAnot,
    annotation = "hgu133plus2.db", ontology = "BP", pvalueCutoff = 0.05, conditional = FALSE,
    testDirection = "over")

KEGGparams_FNRAnot <- new("KEGGHyperGParams", geneIds = selGenes_FNRAnot, universeGeneIds = geneUniverse_FNRAnot,
    annotation = "hgu133plus2.db", pvalueCutoff = 0.05)

# Ejecutamos los análisis
GOHyper_FNRAnot <- hyperGTest(GOparams_FNRAnot)
KEGGHyper_FNRAnot <- hyperGTest(KEGGparams_FNRAnot)
```

Resultados

Los resultados del análisis se encuentran en un objeto que se puede visualizar directamente.

```{r, warning=TRUE, error=FALSE}
summary(GOHyper_CNRAnot)
summary(KEGGHyper_CNRAnot)
```

Una mejor opción es exportarlos a un archivo, preferentemente con hiperenlaces que permitan una exploración directa de las categorías

----------

topTab_GSE14618_GPL570_CFAnot, topTab_GSE14618_GPL570_CNRAnot, topTab_GSE14618_GPL570_FNRAnot

```{r, warning=TRUE, error=TRUE}
library(dplyr)

a <- (topTab_GSE14618_GPL570_CFAnot %>%
          subset(P.Value < 0.05))
unique(a$ENTREZID)

library(ReactomePA)
enrich.result_CFAnot <- enrichPathway(gene = selGenes_CFAnot,
                               pvalueCutoff = 0.05,
                               readable = T,
                               organism = "human",
                               universe = geneUniverse_CFAnot)

# NO hay selGenes. Dice la función:
# --> No gene can be mapped....
# --> Expected input gene ID: 4170,6303,729020,6547,1854,1361
# --> return NULL...

enrich.result_CNRAnot <- enrichPathway(gene = selGenes_CNRAnot,
                               pvalueCutoff = 0.05,
                               readable = T,
                               organism = "human",
                               universe = geneUniverse_CNRAnot)


enrich.result_FNRAnot <- enrichPathway(gene = selGenes_FNRAnot,
                               pvalueCutoff = 0.05,
                               readable = T,
                               organism = "human",
                               universe = geneUniverse_FNRAnot)


```

topTab_GSE14618_GPL570_CFAnot, topTab_GSE14618_GPL570_CNRAnot, topTab_GSE14618_GPL570_FNRAnot



```{r, warning=TRUE, error=FALSE}

listOfTables <- list(CF = topTab_GSE14618_GPL570_CFAnot,
                     CNR = topTab_GSE14618_GPL570_CNRAnot,
                     FNR = topTab_GSE14618_GPL570_FNRAnot)

listOfSelected <- list()

for (i in 1:length(listOfTables)){
  # select the toptable
  topTab <- listOfTables[[i]]
  # select the genes to be included in the analysis
  whichGenes<-topTab["P.Value"]<0.05
  selectedIDs <- rownames(topTab)[whichGenes]
  # convert the ID to Entrez
  EntrezIDs<- listOfTables[[i]]$ENTREZID
  listOfSelected[[i]] <- EntrezIDs
  names(listOfSelected)[i] <- names(listOfTables)[i]
}

```



```{r, warning=TRUE, error=FALSE}

listOfData <- listOfSelected
comparisonsNames <- names(listOfData)
universes <- list(geneUniverse_CFAnot, geneUniverse_CNRAnot,
                  geneUniverse_FNRAnot)
table(universes[[1]] == geneUniverse_CFAnot)

enrich.results=list(enrich.result_CFAnot, enrich.result_CNRAnot,
                    enrich.result_FNRAnot)

```



```{r, warning=TRUE, error=FALSE}

for (i in 1:length(listOfData)){
  universe<-universes[[i]]
  enrich.result<-enrich.results[[i]]
  genesIn <- listOfData[[i]]
  comparison <- comparisonsNames[i]
  enrich.r <- enrich.result
  cat("##################################")
  cat("\nComparison: ", comparison,"\n")
  print(head(enrich.r))
}





```


```{r, warning=TRUE, error=FALSE}
enrich.result<-enrich.results[[2]]
enrich.r <- enrich.result

barplot(enrich.r, showCategory = 15, font.size = 4,
title = paste0("Reactome Pathway Analysis for ", comparison,". Barplot"))

cnetplot(enrich.r, categorySize = "geneNum", schowCategory = 15, vertex.label.cex = 0.75)


enrich.result<-enrich.results[[3]]
enrich.r <- enrich.result

barplot(enrich.r, showCategory = 15, font.size = 4,
title = paste0("Reactome Pathway Analysis for ", comparison,". Barplot"))

cnetplot(enrich.r, categorySize = "geneNum", schowCategory = 15, vertex.label.cex = 0.75)

```

```{r, warning=TRUE, error=TRUE}
enrich.result<-enrich.results[[2]]
enrich.r <- enrich.result
Path<-enrich.r@result[["ID"]]
Biological_Description<-enrich.r@result[["Description"]]
Gene<-enrich.r@result[["geneID"]]
GSE14618_GPL570_CNRAnot<-data.frame(Path, Biological_Description, Gene)


enrich.result<-enrich.results[[3]]
enrich.r <- enrich.result
Path<-enrich.r@result[["ID"]]
Biological_Description<-enrich.r@result[["Description"]]
Gene<-enrich.r@result[["geneID"]]
GSE14618_GPL570_FNRAnot<-data.frame(Path, Biological_Description, Gene)

```

```{r, warning=TRUE, error=FALSE}

library("xlsx")
write.xlsx(GSE14618_GPL570_CNRAnot,
           'C:/Users/Copito/OneDrive/Documentos/Master bioinf y bioest/TFM/datasets/GSE14618/Resultado_GPL570_CNR.xlsx', row.names = FALSE,
           col.names = TRUE)

write.xlsx(GSE14618_GPL570_FNRAnot,
           'C:/Users/Copito/OneDrive/Documentos/Master bioinf y bioest/TFM/datasets/GSE14618/Resultado_GPL570_FNR.xlsx', row.names = FALSE,
           col.names = TRUE)




save(GSE14618_GPL570_CNRAnot,
     GSE14618_GPL570_FNRAnot,
           file = 'C:/Users/Copito/OneDrive/Documentos/Master bioinf y bioest/TFM/datasets/GSE14618/Resultado_GSE14618_GPL570.rda')

```


# GSE14618_GPL96


## Análisis de significación biológica


```{r, warning=TRUE, error=FALSE}
library("readxl")
read_excel('C:/Users/Copito/OneDrive/Documentos/Master bioinf y bioest/TFM/datasets/GSE14618/GSE14618_GPL96_geneIds.xlsx')
load('C:/Users/Copito/OneDrive/Documentos/Master bioinf y bioest/TFM/datasets/GSE14618/GSE14618_GPL96_topTabs_Anot.RData')
```


```{r, warning=TRUE, error=FALSE}
library(dplyr)
selGenes_CFAnot <- (topTab_GSE14618_GPL96_CFAnot %>%
    subset(adj.P.Val < 0.05) %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]

geneUniverse_CFAnot <- (topTab_GSE14618_GPL96_CFAnot %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]

selGenes_CNRAnot <- (topTab_GSE14618_GPL96_CNRAnot %>%
    subset(adj.P.Val < 0.05) %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]

geneUniverse_CNRAnot <- (topTab_GSE14618_GPL96_CNRAnot %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]


selGenes_FNRAnot <- (topTab_GSE14618_GPL96_FNRAnot %>%
    subset(adj.P.Val < 0.05) %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]

geneUniverse_FNRAnot <- (topTab_GSE14618_GPL96_FNRAnot %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]

# La notación anterior pretende ser más clara y acorde con las tendencias
# actuales en R EL mismo resultado se habría podido obtener con un enfoque más
# clásico aunque algo más críptico : selGenes_SoloToxico<-
# unique(subset(topTab_SoloToxico_Anot, adj.P.Val < 0.05)$ENTREZID)
# selGenes_ToxicoEnMet <-unique(subset(topTab_ToxicoEnMet, adj.P.Val <
# 0.05)$ENTREZID) geneUniverse <- unique(topTab_ToxicoEnMet$ENTREZID)

```

Ejecución del análisis de enriquecimiento

```{r, warning=TRUE, error=TRUE}

library (Category)
library (hgu133a.db)
library(GOstats)


GOparams_CFAnot <- new("GOHyperGParams", geneIds = selGenes_CFAnot, universeGeneIds = geneUniverse_CFAnot,
    annotation = "hgu133a.db", ontology = "BP", pvalueCutoff = 0.05, conditional = FALSE,
    testDirection = "over")

KEGGparams_CFAnot <- new("KEGGHyperGParams", geneIds = selGenes_CFAnot, universeGeneIds = geneUniverse_CFAnot,
    annotation = "hgu133a.db", pvalueCutoff = 0.05)

# Ejecutamos los análisis
GOHyper_CFAnot <- hyperGTest(GOparams_CFAnot)
KEGGHyper_CFAnot <- hyperGTest(KEGGparams_CFAnot)

# -----



GOparams_CNRAnot <- new("GOHyperGParams", geneIds = selGenes_CNRAnot, universeGeneIds = geneUniverse_CNRAnot,
    annotation = "hgu133a.db", ontology = "BP", pvalueCutoff = 0.05, conditional = FALSE,
    testDirection = "over")

KEGGparams_CNRAnot <- new("KEGGHyperGParams", geneIds = selGenes_CNRAnot, universeGeneIds = geneUniverse_CNRAnot,
    annotation = "hgu133a.db", pvalueCutoff = 0.05)

# Ejecutamos los análisis
GOHyper_CNRAnot <- hyperGTest(GOparams_CNRAnot)
KEGGHyper_CNRAnot <- hyperGTest(KEGGparams_CNRAnot)


# --


GOparams_FNRAnot <- new("GOHyperGParams", geneIds = selGenes_FNRAnot, universeGeneIds = geneUniverse_FNRAnot,
    annotation = "hgu133a.db", ontology = "BP", pvalueCutoff = 0.05, conditional = FALSE,
    testDirection = "over")

KEGGparams_FNRAnot <- new("KEGGHyperGParams", geneIds = selGenes_FNRAnot, universeGeneIds = geneUniverse_FNRAnot,
    annotation = "hgu133a.db", pvalueCutoff = 0.05)

# Ejecutamos los análisis
GOHyper_FNRAnot <- hyperGTest(GOparams_FNRAnot)
KEGGHyper_FNRAnot <- hyperGTest(KEGGparams_FNRAnot)
```

Resultados

Los resultados del análisis se encuentran en un objeto que se puede visualizar directamente.

```{r, warning=TRUE, error=FALSE}
summary(GOHyper_CNRAnot)
summary(KEGGHyper_CNRAnot)
```

Una mejor opción es exportarlos a un archivo, preferentemente con hiperenlaces que permitan una exploración directa de las categorías

----------

topTab_GSE14618_GPL570_CFAnot, topTab_GSE14618_GPL570_CNRAnot, topTab_GSE14618_GPL570_FNRAnot

```{r, warning=TRUE, error=TRUE}
library(dplyr)

a <- (topTab_GSE14618_GPL96_CFAnot %>%
          subset(P.Value < 0.05))
unique(a$ENTREZID)

library(ReactomePA)
enrich.result_CFAnot <- enrichPathway(gene = selGenes_CFAnot,
                               pvalueCutoff = 0.05,
                               readable = T,
                               organism = "human",
                               universe = geneUniverse_CFAnot)

# NO hay selGenes. Dice la función:
# --> No gene can be mapped....
# --> Expected input gene ID: 4170,6303,729020,6547,1854,1361
# --> return NULL...

enrich.result_CNRAnot <- enrichPathway(gene = selGenes_CNRAnot,
                               pvalueCutoff = 0.05,
                               readable = T,
                               organism = "human",
                               universe = geneUniverse_CNRAnot)


enrich.result_FNRAnot <- enrichPathway(gene = selGenes_FNRAnot,
                               pvalueCutoff = 0.05,
                               readable = T,
                               organism = "human",
                               universe = geneUniverse_FNRAnot)


```

topTab_GSE14618_GPL570_CFAnot, topTab_GSE14618_GPL570_CNRAnot, topTab_GSE14618_GPL570_FNRAnot



```{r, warning=TRUE, error=FALSE}

listOfTables <- list(CF = topTab_GSE14618_GPL96_CFAnot,
                     CNR = topTab_GSE14618_GPL96_CNRAnot,
                     FNR = topTab_GSE14618_GPL96_FNRAnot)

listOfSelected <- list()

for (i in 1:length(listOfTables)){
  # select the toptable
  topTab <- listOfTables[[i]]
  # select the genes to be included in the analysis
  whichGenes<-topTab["P.Value"]<0.05
  selectedIDs <- rownames(topTab)[whichGenes]
  # convert the ID to Entrez
  EntrezIDs<- listOfTables[[i]]$ENTREZID
  listOfSelected[[i]] <- EntrezIDs
  names(listOfSelected)[i] <- names(listOfTables)[i]
}

```



```{r, warning=TRUE, error=FALSE}

listOfData <- listOfSelected
comparisonsNames <- names(listOfData)
universes <- list(geneUniverse_CFAnot, geneUniverse_CNRAnot,
                  geneUniverse_FNRAnot)
table(universes[[1]] == geneUniverse_CFAnot)

enrich.results=list(enrich.result_CFAnot, enrich.result_CNRAnot,
                    enrich.result_FNRAnot)

```



```{r, warning=TRUE, error=FALSE}

for (i in 1:length(listOfData)){
  universe<-universes[[i]]
  enrich.result<-enrich.results[[i]]
  genesIn <- listOfData[[i]]
  comparison <- comparisonsNames[i]
  enrich.r <- enrich.result
  cat("##################################")
  cat("\nComparison: ", comparison,"\n")
  print(head(enrich.r))
}





```


```{r, warning=TRUE, error=TRUE}
enrich.result<-enrich.results[[2]]
enrich.r <- enrich.result

barplot(enrich.r, showCategory = 15, font.size = 4,
title = paste0("Reactome Pathway Analysis for ", comparison,". Barplot"))

cnetplot(enrich.r, categorySize = "geneNum", schowCategory = 15, vertex.label.cex = 0.75)


enrich.result<-enrich.results[[3]]
enrich.r <- enrich.result

barplot(enrich.r, showCategory = 15, font.size = 4,
title = paste0("Reactome Pathway Analysis for ", comparison,". Barplot"))

cnetplot(enrich.r, categorySize = "geneNum", schowCategory = 15, vertex.label.cex = 0.75)

```

```{r, warning=TRUE, error=TRUE}
enrich.result<-enrich.results[[2]]
enrich.r <- enrich.result
Path<-enrich.r@result[["ID"]]
Biological_Description<-enrich.r@result[["Description"]]
Gene<-enrich.r@result[["geneID"]]
GSE14618_GPL96_CNRAnot<-data.frame(Path, Biological_Description, Gene)


enrich.result<-enrich.results[[3]]
enrich.r <- enrich.result
Path<-enrich.r@result[["ID"]]
Biological_Description<-enrich.r@result[["Description"]]
Gene<-enrich.r@result[["geneID"]]
GSE14618_GPL96_FNRAnot<-data.frame(Path, Biological_Description, Gene)

```

```{r, warning=TRUE, error=FALSE}

library("xlsx")
write.xlsx(GSE14618_GPL96_CNRAnot,
           'C:/Users/Copito/OneDrive/Documentos/Master bioinf y bioest/TFM/datasets/GSE14618/Resultado_GPL96_CNR.xlsx', row.names = FALSE,
           col.names = TRUE)

write.xlsx(GSE14618_GPL96_FNRAnot,
           'C:/Users/Copito/OneDrive/Documentos/Master bioinf y bioest/TFM/datasets/GSE14618/Resultado_GPL96_FNR.xlsx', row.names = FALSE,
           col.names = TRUE)




save(GSE14618_GPL96_CNRAnot,
     GSE14618_GPL96_FNRAnot,
           file = 'C:/Users/Copito/OneDrive/Documentos/Master bioinf y bioest/TFM/datasets/GSE14618/Resultado_GSE14618_GPL96.rda')

```


# GSE26713


## Análisis de significación biológica


```{r, warning=TRUE, error=FALSE}
library("readxl")
# read_excel('C:/Users/Copito/OneDrive/Documentos/Master bioinf y bioest/TFM/datasets/GSE26713/GSE26713_geneIds.xlsx')
load('C:/Users/Copito/OneDrive/Documentos/Master bioinf y bioest/TFM/datasets/GSE26713/GSE26713topTabs_Anot.RData')
```


```{r, warning=TRUE, error=FALSE}
(list= ls(pattern="Anot$")) # todos los objetos que acaban con Anot

library(dplyr)
selGenes_BMHOXAAnot <- (topTab_GSE26713_BMHOXAAnot %>%
    subset(adj.P.Val < 0.05) %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]

geneUniverse_BMHOXAAnot <- (topTab_GSE26713_BMHOXAAnot %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]



selGenes_BMLMO1Anot <- (topTab_GSE26713_BMLMO1Anot %>%
    subset(adj.P.Val < 0.05) %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]

geneUniverse_BMLMO1Anot <- (topTab_GSE26713_BMLMO1Anot %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]




selGenes_BMLMO2Anot <- (topTab_GSE26713_BMLMO2Anot %>%
    subset(adj.P.Val < 0.05) %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]

geneUniverse_BMLMO2Anot <- (topTab_GSE26713_BMLMO2Anot %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]




selGenes_BMMYBAnot <- (topTab_GSE26713_BMMYBAnot %>%
    subset(adj.P.Val < 0.05) %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]

geneUniverse_BMMYBAnot <- (topTab_GSE26713_BMMYBAnot %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]



selGenes_BMTAL1Anot <- (topTab_GSE26713_BMTAL1Anot %>%
    subset(adj.P.Val < 0.05) %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]

geneUniverse_BMTAL1Anot <- (topTab_GSE26713_BMTAL1Anot %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]




selGenes_BMTAL2Anot <- (topTab_GSE26713_BMTAL2Anot %>%
    subset(adj.P.Val < 0.05) %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]

geneUniverse_BMTAL2Anot <- (topTab_GSE26713_BMTAL2Anot %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]


# 7 

selGenes_BMTAL2LMO1Anot <- (topTab_GSE26713_BMTAL2LMO1Anot %>%
    subset(adj.P.Val < 0.05) %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]

geneUniverse_BMTAL2LMO1Anot <- (topTab_GSE26713_BMTAL2LMO1Anot %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]




selGenes_BMTLX1Anot <- (topTab_GSE26713_BMTLX1Anot %>%
    subset(adj.P.Val < 0.05) %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]

geneUniverse_BMTLX1Anot <- (topTab_GSE26713_BMTLX1Anot %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]

selGenes_BMTLX3Anot <- (topTab_GSE26713_BMTLX3Anot %>%
    subset(adj.P.Val < 0.05) %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]

geneUniverse_BMTLX3Anot <- (topTab_GSE26713_BMTLX3Anot %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]


selGenes_HOXALMO1Anot <- (topTab_GSE26713_HOXALMO1Anot %>%
    subset(adj.P.Val < 0.05) %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]

geneUniverse_HOXALMO1Anot <- (topTab_GSE26713_HOXALMO1Anot %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]


selGenes_HOXALMO2Anot <- (topTab_GSE26713_HOXALMO2Anot %>%
    subset(adj.P.Val < 0.05) %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]




geneUniverse_HOXALMO2Anot <- (topTab_GSE26713_HOXALMO2Anot %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]


selGenes_HOXATAL1Anot <- (topTab_GSE26713_HOXATAL1Anot %>%
    subset(adj.P.Val < 0.05) %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]

geneUniverse_HOXATAL1Anot <- (topTab_GSE26713_HOXATAL1Anot %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]


selGenes_HOXATAL2Anot <- (topTab_GSE26713_HOXATAL2Anot %>%
    subset(adj.P.Val < 0.05) %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]

geneUniverse_HOXATAL2Anot <- (topTab_GSE26713_HOXATAL2Anot %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]


selGenes_HOXATAL2LMO1Anot <- (topTab_GSE26713_HOXATAL2LMO1Anot %>%
    subset(adj.P.Val < 0.05) %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]

geneUniverse_HOXATAL2LMO1Anot <- (topTab_GSE26713_HOXATAL2LMO1Anot %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]


selGenes_HOXATLX1Anot <- (topTab_GSE26713_HOXATLX1Anot %>%
    subset(adj.P.Val < 0.05) %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]

geneUniverse_HOXATLX1Anot <- (topTab_GSE26713_HOXATLX1Anot %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]

selGenes_HOXATLX3Anot <- (topTab_GSE26713_HOXATLX3Anot %>%
    subset(adj.P.Val < 0.05) %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]

geneUniverse_HOXATLX3Anot <- (topTab_GSE26713_HOXATLX3Anot %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]

selGenes_LMO1LMO2MYBAnot <- (topTab_GSE26713_LMO1LMO2MYBAnot %>%
    subset(adj.P.Val < 0.05) %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]

geneUniverse_LMO1LMO2MYBAnot <- (topTab_GSE26713_LMO1LMO2MYBAnot %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]


selGenes_LMO1MYBAnot <- (topTab_GSE26713_LMO1MYBAnot %>%
    subset(adj.P.Val < 0.05) %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]

geneUniverse_LMO1MYBAnot <- (topTab_GSE26713_LMO1MYBAnot %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]


selGenes_LMO2TAL1Anot <- (topTab_GSE26713_LMO2TAL1Anot %>%
    subset(adj.P.Val < 0.05) %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]

geneUniverse_LMO2TAL1Anot <- (topTab_GSE26713_LMO2TAL1Anot %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]


selGenes_LMO2TAL2Anot <- (topTab_GSE26713_LMO2TAL2Anot %>%
    subset(adj.P.Val < 0.05) %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]

geneUniverse_LMO2TAL2Anot <- (topTab_GSE26713_LMO2TAL2Anot %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]



selGenes_LMO2TAL2LMO1Anot <- (topTab_GSE26713_LMO2TAL2LMO1Anot %>%
    subset(adj.P.Val < 0.05) %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]

geneUniverse_LMO2TAL2LMO1Anot <- (topTab_GSE26713_LMO2TAL2LMO1Anot %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]


selGenes_LMO2TLX1Anot <- (topTab_GSE26713_LMO2TLX1Anot %>%
    subset(adj.P.Val < 0.05) %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]

geneUniverse_LMO2TLX1Anot <- (topTab_GSE26713_LMO2TLX1Anot %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]


selGenes_LMO2TLX3Anot <- (topTab_GSE26713_LMO2TLX3Anot %>%
    subset(adj.P.Val < 0.05) %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]

geneUniverse_LMO2TLX3Anot <- (topTab_GSE26713_LMO2TLX3Anot %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]


selGenes_LMOAnot <- (topTab_GSE26713_LMOAnot %>%
    subset(adj.P.Val < 0.05) %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]

geneUniverse_LMOAnot <- (topTab_GSE26713_LMOAnot %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]

selGenes_LMOBMAnot <- (topTab_GSE26713_LMOBMAnot %>%
    subset(adj.P.Val < 0.05) %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]

geneUniverse_LMOBMAnot <- (topTab_GSE26713_LMOBMAnot %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]


selGenes_LMOTAL1Anot <- (topTab_GSE26713_LMOTAL1Anot %>%
    subset(adj.P.Val < 0.05) %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]

geneUniverse_LMOTAL1Anot <- (topTab_GSE26713_LMOTAL1Anot %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]




selGenes_LMOTAL2Anot <- (topTab_GSE26713_LMOTAL2Anot %>%
    subset(adj.P.Val < 0.05) %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]

geneUniverse_LMOTAL2Anot <- (topTab_GSE26713_LMOTAL2Anot %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]



selGenes_LMOTAL2LMO1Anot <- (topTab_GSE26713_LMOTAL2LMO1Anot %>%
    subset(adj.P.Val < 0.05) %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]

geneUniverse_LMOTAL2LMO1Anot <- (topTab_GSE26713_LMOTAL2LMO1Anot %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]


selGenes_LMOTALAnot <- (topTab_GSE26713_LMOTALAnot %>%
    subset(adj.P.Val < 0.05) %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]


geneUniverse_LMOTALAnot <- (topTab_GSE26713_LMOTALAnot %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]

selGenes_LMOTLX1Anot <- (topTab_GSE26713_LMOTLX1Anot %>%
    subset(adj.P.Val < 0.05) %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]

geneUniverse_LMOTLX1Anot <- (topTab_GSE26713_LMOTLX1Anot %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]



selGenes_LMOTLX3Anot <- (topTab_GSE26713_LMOTLX3Anot %>%
    subset(adj.P.Val < 0.05) %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]

geneUniverse_LMOTLX3Anot <- (topTab_GSE26713_LMOTLX3Anot %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]

selGenes_MYBTAL1Anot <- (topTab_GSE26713_MYBTAL1Anot %>%
    subset(adj.P.Val < 0.05) %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]

geneUniverse_MYBTAL1Anot <- (topTab_GSE26713_MYBTAL1Anot %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]

selGenes_MYBTAL2Anot <- (topTab_GSE26713_MYBTAL2Anot %>%
    subset(adj.P.Val < 0.05) %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]

geneUniverse_MYBTAL2Anot <- (topTab_GSE26713_MYBTAL2Anot %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]



selGenes_MYBTAL2LMO1Anot <- (topTab_GSE26713_MYBTAL2LMO1Anot %>%
    subset(adj.P.Val < 0.05) %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]

geneUniverse_MYBTAL2LMO1Anot <- (topTab_GSE26713_MYBTAL2LMO1Anot %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]

selGenes_MYBTLX1Anot <- (topTab_GSE26713_MYBTLX1Anot %>%
    subset(adj.P.Val < 0.05) %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]

geneUniverse_MYBTLX1Anot <- (topTab_GSE26713_MYBTLX1Anot %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]



selGenes_MYBTLX3Anot <- (topTab_GSE26713_MYBTLX3Anot %>%
    subset(adj.P.Val < 0.05) %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]

geneUniverse_MYBTLX3Anot <- (topTab_GSE26713_MYBTLX3Anot %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]



selGenes_TAL1TAL2LMO1Anot <- (topTab_GSE26713_TAL1TAL2LMO1Anot %>%
    subset(adj.P.Val < 0.05) %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]

geneUniverse_TAL1TAL2LMO1Anot <- (topTab_GSE26713_TAL1TAL2LMO1Anot %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]


selGenes_TAL1TLX1Anot <- (topTab_GSE26713_TAL1TLX1Anot %>%
    subset(adj.P.Val < 0.05) %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]

geneUniverse_TAL1TLX1Anot <- (topTab_GSE26713_TAL1TLX1Anot %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]

selGenes_TAL1TLX3Anot <- (topTab_GSE26713_TAL1TLX3Anot %>%
    subset(adj.P.Val < 0.05) %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]



geneUniverse_TAL1TLX3Anot <- (topTab_GSE26713_TAL1TLX3Anot %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]


selGenes_TAL2LMO1Anot <- (topTab_GSE26713_TAL2LMO1Anot %>%
    subset(adj.P.Val < 0.05) %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]

geneUniverse_TAL2LMO1Anot <- (topTab_GSE26713_TAL2LMO1Anot %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]


selGenes_TAL2LMO1TLX1Anot <- (topTab_GSE26713_TAL2LMO1TLX1Anot %>%
    subset(adj.P.Val < 0.05) %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]

geneUniverse_TAL2LMO1TLX1Anot <- (topTab_GSE26713_TAL2LMO1TLX1Anot %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]

selGenes_TAL2TAL2LMO1Anot <- (topTab_GSE26713_TAL2TAL2LMO1Anot %>%
    subset(adj.P.Val < 0.05) %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]

geneUniverse_TAL2TAL2LMO1Anot <- (topTab_GSE26713_TAL2TAL2LMO1Anot %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]


selGenes_TAL2TLX1Anot <- (topTab_GSE26713_TAL2TLX1Anot %>%
    subset(adj.P.Val < 0.05) %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]

geneUniverse_TAL2TLX1Anot <- (topTab_GSE26713_TAL2TLX1Anot %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]

selGenes_TAL2TLX3Anot <- (topTab_GSE26713_TAL2TLX3Anot %>%
    subset(adj.P.Val < 0.05) %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]


 
geneUniverse_TAL2TLX3Anot <- (topTab_GSE26713_TAL2TLX3Anot %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]


selGenes_TALAnot <- (topTab_GSE26713_TALAnot %>%
    subset(adj.P.Val < 0.05) %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]

geneUniverse_TALAnot <- (topTab_GSE26713_TALAnot %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]


selGenes_TALBMAnot <- (topTab_GSE26713_TALBMAnot %>%
    subset(adj.P.Val < 0.05) %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]

geneUniverse_TALBMAnot <- (topTab_GSE26713_TALBMAnot %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]


selGenes_TALMYBAnot <- (topTab_GSE26713_TALMYBAnot %>%
    subset(adj.P.Val < 0.05) %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]

geneUniverse_TALMYBAnot <- (topTab_GSE26713_TALMYBAnot %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]

selGenes_TALTAL2LMO1Anot <- (topTab_GSE26713_TALTAL2LMO1Anot %>%
    subset(adj.P.Val < 0.05) %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]

geneUniverse_TALTAL2LMO1Anot <- (topTab_GSE26713_TALTAL2LMO1Anot %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]





selGenes_TALTLX1Anot <- (topTab_GSE26713_TALTLX1Anot %>%
    subset(adj.P.Val < 0.05) %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]

geneUniverse_TALTLX1Anot <- (topTab_GSE26713_TALTLX1Anot %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]



selGenes_TALTLX3Anot <- (topTab_GSE26713_TALTLX3Anot %>%
    subset(adj.P.Val < 0.05) %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]

geneUniverse_TALTLX3Anot <- (topTab_GSE26713_TALTLX3Anot %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]


 
selGenes_TALTLXAnot <- (topTab_GSE26713_TALTLXAnot %>%
    subset(adj.P.Val < 0.05) %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]

geneUniverse_TALTLXAnot <- (topTab_GSE26713_TALTLXAnot %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]


selGenes_TALTLXLAnot <- (topTab_GSE26713_TALTLXLAnot %>%
    subset(adj.P.Val < 0.05) %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]

geneUniverse_TALTLXLAnot <- (topTab_GSE26713_TALTLXLAnot %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]




selGenes_TLXAnot <- (topTab_GSE26713_TLXAnot %>%
    subset(adj.P.Val < 0.05) %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]

geneUniverse_TLXAnot <- (topTab_GSE26713_TLXAnot %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]

selGenes_TLXBMAnot <- (topTab_GSE26713_TLXBMAnot %>%
    subset(adj.P.Val < 0.05) %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]

geneUniverse_TLXBMAnot <- (topTab_GSE26713_TLXBMAnot %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]


selGenes_TLXMYBAnot <- (topTab_GSE26713_TLXMYBAnot %>%
    subset(adj.P.Val < 0.05) %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]

geneUniverse_TLXMYBAnot <- (topTab_GSE26713_TLXMYBAnot %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]



selGenes_TLXTAL1Anot <- (topTab_GSE26713_TLXTAL1Anot %>%
    subset(adj.P.Val < 0.05) %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]

geneUniverse_TLXTAL1Anot <- (topTab_GSE26713_TLXTAL1Anot %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]



selGenes_TLXTAL2Anot <- (topTab_GSE26713_TLXTAL2Anot %>%
    subset(adj.P.Val < 0.05) %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]

geneUniverse_TLXTAL2Anot <- (topTab_GSE26713_TLXTAL2Anot %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]



selGenes_TLXTAL2LMO1Anot <- (topTab_GSE26713_TLXTAL2LMO1Anot %>%
    subset(adj.P.Val < 0.05) %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]

geneUniverse_TLXTAL2LMO1Anot <- (topTab_GSE26713_TLXTAL2LMO1Anot %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]







# La notación anterior pretende ser más clara y acorde con las tendencias
# actuales en R EL mismo resultado se habría podido obtener con un enfoque más
# clásico aunque algo más críptico : selGenes_SoloToxico<-
# unique(subset(topTab_SoloToxico_Anot, adj.P.Val < 0.05)$ENTREZID)
# selGenes_ToxicoEnMet <-unique(subset(topTab_ToxicoEnMet, adj.P.Val <
# 0.05)$ENTREZID) geneUniverse <- unique(topTab_ToxicoEnMet$ENTREZID)

```

Ejecución del análisis de enriquecimiento.

topTab_GSE26713_BMTAL2LMO1Anot

```{r, warning=TRUE, error=TRUE}

library (Category)
library (hgu133plus2.db)
library(GOstats)

ls(pattern="selGenes")


GOparams_BMHOXAAnot <- new("GOHyperGParams", geneIds = selGenes_BMHOXAAnot, universeGeneIds = geneUniverse_BMHOXAAnot,
    annotation = "hgu133plus2.db", ontology = "BP", pvalueCutoff = 0.05, conditional = FALSE,
    testDirection = "over")

KEGGparams_BMHOXAAnot <- new("KEGGHyperGParams", geneIds = selGenes_BMHOXAAnot, universeGeneIds = geneUniverse_BMHOXAAnot,
    annotation = "hgu133plus2.db", pvalueCutoff = 0.05)

# Ejecutamos los análisis
GOHyper_BMHOXAAnot <- hyperGTest(GOparams_BMHOXAAnot)
KEGGHyper_BMHOXAAnot <- hyperGTest(KEGGparams_BMHOXAAnot)

# -----2



GOparams_BMLMO1Anot <- new("GOHyperGParams", geneIds = selGenes_BMLMO1Anot, universeGeneIds = geneUniverse_BMLMO1Anot,
    annotation = "hgu133plus2.db", ontology = "BP", pvalueCutoff = 0.05, conditional = FALSE,
    testDirection = "over")

KEGGparams_BMLMO1Anot <- new("KEGGHyperGParams", geneIds = selGenes_BMLMO1Anot, universeGeneIds = geneUniverse_BMLMO1Anot,
    annotation = "hgu133plus2.db", pvalueCutoff = 0.05)

# Ejecutamos los análisis
GOHyper_BMLMO1Anot <- hyperGTest(GOparams_BMLMO1Anot)
KEGGHyper_BMLMO1Anot <- hyperGTest(KEGGparams_BMLMO1Anot)


# --3


GOparams_BMLMO2Anot <- new("GOHyperGParams", geneIds = selGenes_BMLMO2Anot, universeGeneIds = geneUniverse_BMLMO2Anot,
    annotation = "hgu133plus2.db", ontology = "BP", pvalueCutoff = 0.05, conditional = FALSE,
    testDirection = "over")

KEGGparams_BMLMO2Anot <- new("KEGGHyperGParams", geneIds = selGenes_BMLMO2Anot, universeGeneIds = geneUniverse_BMLMO2Anot,
    annotation = "hgu133plus2.db", pvalueCutoff = 0.05)

# Ejecutamos los análisis
GOHyper_BMLMO2Anot <- hyperGTest(GOparams_BMLMO2Anot)
KEGGHyper_BMLMO2Anot <- hyperGTest(KEGGparams_BMLMO2Anot)



# --4


GOparams_BMMYBAnot <- new("GOHyperGParams", geneIds = selGenes_BMMYBAnot, universeGeneIds = geneUniverse_BMMYBAnot,
    annotation = "hgu133plus2.db", ontology = "BP", pvalueCutoff = 0.05, conditional = FALSE,
    testDirection = "over")

KEGGparams_BMMYBAnot <- new("KEGGHyperGParams", geneIds = selGenes_BMMYBAnot, universeGeneIds = geneUniverse_BMMYBAnot,
    annotation = "hgu133plus2.db", pvalueCutoff = 0.05)

# Ejecutamos los análisis
GOHyper_BMMYBAnot <- hyperGTest(GOparams_BMMYBAnot)
KEGGHyper_BMMYBAnot <- hyperGTest(KEGGparams_BMMYBAnot)



# --5


GOparams_BMTAL1Anot <- new("GOHyperGParams", geneIds = selGenes_BMTAL1Anot, universeGeneIds = geneUniverse_BMTAL1Anot,
    annotation = "hgu133plus2.db", ontology = "BP", pvalueCutoff = 0.05, conditional = FALSE,
    testDirection = "over")

KEGGparams_BMTAL1Anot <- new("KEGGHyperGParams", geneIds = selGenes_BMTAL1Anot, universeGeneIds = geneUniverse_BMTAL1Anot,
    annotation = "hgu133plus2.db", pvalueCutoff = 0.05)

# Ejecutamos los análisis
GOHyper_BMTAL1Anot <- hyperGTest(GOparams_BMTAL1Anot)
KEGGHyper_BMTAL1Anot <- hyperGTest(KEGGparams_BMTAL1Anot)




# --6


GOparams_BMTAL2Anot <- new("GOHyperGParams", geneIds = selGenes_BMTAL2Anot, universeGeneIds = geneUniverse_BMTAL2Anot,
    annotation = "hgu133plus2.db", ontology = "BP", pvalueCutoff = 0.05, conditional = FALSE,
    testDirection = "over")

KEGGparams_BMTAL2Anot <- new("KEGGHyperGParams", geneIds = selGenes_BMTAL2Anot, universeGeneIds = geneUniverse_BMTAL2Anot,
    annotation = "hgu133plus2.db", pvalueCutoff = 0.05)

# Ejecutamos los análisis
GOHyper_BMTAL2Anot <- hyperGTest(GOparams_BMTAL2Anot)
KEGGHyper_BMTAL2Anot <- hyperGTest(KEGGparams_BMTAL2Anot)




# --7

GOparams_BMTAL2LMO1Anot <- new("GOHyperGParams", geneIds = selGenes_BMTAL2LMO1Anot, universeGeneIds = geneUniverse_BMTAL2LMO1Anot,
    annotation = "hgu133plus2.db", ontology = "BP", pvalueCutoff = 0.05, conditional = FALSE,
    testDirection = "over")

KEGGparams_BMTAL2LMO1Anot <- new("KEGGHyperGParams", geneIds = selGenes_BMTAL2LMO1Anot, universeGeneIds = geneUniverse_BMTAL2LMO1Anot,
    annotation = "hgu133plus2.db", pvalueCutoff = 0.05)

# Ejecutamos los análisis
GOHyper_BMTAL2LMO1Anot <- hyperGTest(GOparams_BMTAL2LMO1Anot)
KEGGHyper_BMTAL2LMO1Anot <- hyperGTest(KEGGparams_BMTAL2LMO1Anot)



GOparams_BMTLX1Anot <- new("GOHyperGParams", geneIds = selGenes_BMTLX1Anot, universeGeneIds = geneUniverse_BMTLX1Anot,
    annotation = "hgu133plus2.db", ontology = "BP", pvalueCutoff = 0.05, conditional = FALSE,
    testDirection = "over")

KEGGparams_BMTLX1Anot <- new("KEGGHyperGParams", geneIds = selGenes_BMTLX1Anot, universeGeneIds = geneUniverse_BMTLX1Anot,
    annotation = "hgu133plus2.db", pvalueCutoff = 0.05)

# Ejecutamos los análisis
GOHyper_BMTLX1Anot <- hyperGTest(GOparams_BMTLX1Anot)
KEGGHyper_BMTLX1Anot <- hyperGTest(KEGGparams_BMTLX1Anot)


# --8


GOparams_BMTLX3Anot <- new("GOHyperGParams", geneIds = selGenes_BMTLX3Anot, universeGeneIds = geneUniverse_BMTLX3Anot,
    annotation = "hgu133plus2.db", ontology = "BP", pvalueCutoff = 0.05, conditional = FALSE,
    testDirection = "over")

KEGGparams_BMTLX3Anot <- new("KEGGHyperGParams", geneIds = selGenes_BMTLX3Anot, universeGeneIds = geneUniverse_BMTLX3Anot,
    annotation = "hgu133plus2.db", pvalueCutoff = 0.05)

# Ejecutamos los análisis
GOHyper_BMTLX3Anot <- hyperGTest(GOparams_BMTLX3Anot)
KEGGHyper_BMTLX3Anot <- hyperGTest(KEGGparams_BMTLX3Anot)


# --9


GOparams_HOXALMO1Anot <- new("GOHyperGParams", geneIds = selGenes_HOXALMO1Anot, universeGeneIds = geneUniverse_HOXALMO1Anot,
    annotation = "hgu133plus2.db", ontology = "BP", pvalueCutoff = 0.05, conditional = FALSE,
    testDirection = "over")

KEGGparams_HOXALMO1Anot <- new("KEGGHyperGParams", geneIds = selGenes_HOXALMO1Anot, universeGeneIds = geneUniverse_HOXALMO1Anot,
    annotation = "hgu133plus2.db", pvalueCutoff = 0.05)

# Ejecutamos los análisis
GOHyper_HOXALMO1Anot <- hyperGTest(GOparams_HOXALMO1Anot)
KEGGHyper_HOXALMO1Anot <- hyperGTest(KEGGparams_HOXALMO1Anot)


# --10


GOparams_HOXALMO2Anot <- new("GOHyperGParams", geneIds = selGenes_HOXALMO2Anot, universeGeneIds = geneUniverse_HOXALMO2Anot,
    annotation = "hgu133plus2.db", ontology = "BP", pvalueCutoff = 0.05, conditional = FALSE,
    testDirection = "over")

KEGGparams_HOXALMO2Anot <- new("KEGGHyperGParams", geneIds = selGenes_HOXALMO2Anot, universeGeneIds = geneUniverse_HOXALMO2Anot,
    annotation = "hgu133plus2.db", pvalueCutoff = 0.05)

# Ejecutamos los análisis
GOHyper_HOXALMO2Anot <- hyperGTest(GOparams_HOXALMO2Anot)
KEGGHyper_HOXALMO2Anot <- hyperGTest(KEGGparams_HOXALMO2Anot)
# --11


GOparams_HOXATAL1Anot <- new("GOHyperGParams", geneIds = selGenes_HOXATAL1Anot, universeGeneIds = geneUniverse_HOXATAL1Anot,
    annotation = "hgu133plus2.db", ontology = "BP", pvalueCutoff = 0.05, conditional = FALSE,
    testDirection = "over")

KEGGparams_HOXATAL1Anot <- new("KEGGHyperGParams", geneIds = selGenes_HOXATAL1Anot, universeGeneIds = geneUniverse_HOXATAL1Anot,
    annotation = "hgu133plus2.db", pvalueCutoff = 0.05)

# Ejecutamos los análisis
GOHyper_HOXATAL1Anot <- hyperGTest(GOparams_HOXATAL1Anot)
KEGGHyper_HOXATAL1Anot <- hyperGTest(KEGGparams_HOXATAL1Anot)
# --12


GOparams_HOXATAL2Anot <- new("GOHyperGParams", geneIds = selGenes_HOXATAL2Anot, universeGeneIds = geneUniverse_HOXATAL2Anot,
    annotation = "hgu133plus2.db", ontology = "BP", pvalueCutoff = 0.05, conditional = FALSE,
    testDirection = "over")

KEGGparams_HOXATAL2Anot <- new("KEGGHyperGParams", geneIds = selGenes_HOXATAL2Anot, universeGeneIds = geneUniverse_HOXATAL2Anot,
    annotation = "hgu133plus2.db", pvalueCutoff = 0.05)

# Ejecutamos los análisis
GOHyper_HOXATAL2Anot <- hyperGTest(GOparams_HOXATAL2Anot)
KEGGHyper_HOXATAL2Anot <- hyperGTest(KEGGparams_HOXATAL2Anot)
# --13


GOparams_HOXATAL2LMO1Anot <- new("GOHyperGParams", geneIds = selGenes_HOXATAL2LMO1Anot, universeGeneIds = geneUniverse_HOXATAL2LMO1Anot,
    annotation = "hgu133plus2.db", ontology = "BP", pvalueCutoff = 0.05, conditional = FALSE,
    testDirection = "over")

KEGGparams_HOXATAL2LMO1Anot <- new("KEGGHyperGParams", geneIds = selGenes_HOXATAL2LMO1Anot, universeGeneIds = geneUniverse_HOXATAL2LMO1Anot,
    annotation = "hgu133plus2.db", pvalueCutoff = 0.05)

# Ejecutamos los análisis
GOHyper_HOXATAL2LMO1Anot <- hyperGTest(GOparams_HOXATAL2LMO1Anot)
KEGGHyper_HOXATAL2LMO1Anot <- hyperGTest(KEGGparams_HOXATAL2LMO1Anot)
# --14


GOparams_HOXATLX1Anot <- new("GOHyperGParams", geneIds = selGenes_HOXATLX1Anot, universeGeneIds = geneUniverse_HOXATLX1Anot,
    annotation = "hgu133plus2.db", ontology = "BP", pvalueCutoff = 0.05, conditional = FALSE,
    testDirection = "over")

KEGGparams_HOXATLX1Anot <- new("KEGGHyperGParams", geneIds = selGenes_HOXATLX1Anot, universeGeneIds = geneUniverse_HOXATLX1Anot,
    annotation = "hgu133plus2.db", pvalueCutoff = 0.05)

# Ejecutamos los análisis
GOHyper_HOXATLX1Anot <- hyperGTest(GOparams_HOXATLX1Anot)
KEGGHyper_HOXATLX1Anot <- hyperGTest(KEGGparams_HOXATLX1Anot)
# --15


GOparams_HOXATLX3Anot <- new("GOHyperGParams", geneIds = selGenes_HOXATLX3Anot, universeGeneIds = geneUniverse_HOXATLX3Anot,
    annotation = "hgu133plus2.db", ontology = "BP", pvalueCutoff = 0.05, conditional = FALSE,
    testDirection = "over")

KEGGparams_HOXATLX3Anot <- new("KEGGHyperGParams", geneIds = selGenes_HOXATLX3Anot, universeGeneIds = geneUniverse_HOXATLX3Anot,
    annotation = "hgu133plus2.db", pvalueCutoff = 0.05)

# Ejecutamos los análisis
GOHyper_HOXATLX3Anot <- hyperGTest(GOparams_HOXATLX3Anot)
KEGGHyper_HOXATLX3Anot <- hyperGTest(KEGGparams_HOXATLX3Anot)
# --16


GOparams_LMO1LMO2MYBAnot <- new("GOHyperGParams", geneIds = selGenes_LMO1LMO2MYBAnot, universeGeneIds = geneUniverse_LMO1LMO2MYBAnot,
    annotation = "hgu133plus2.db", ontology = "BP", pvalueCutoff = 0.05, conditional = FALSE,
    testDirection = "over")

KEGGparams_LMO1LMO2MYBAnot <- new("KEGGHyperGParams", geneIds = selGenes_LMO1LMO2MYBAnot, universeGeneIds = geneUniverse_LMO1LMO2MYBAnot,
    annotation = "hgu133plus2.db", pvalueCutoff = 0.05)

# Ejecutamos los análisis
GOHyper_LMO1LMO2MYBAnot <- hyperGTest(GOparams_LMO1LMO2MYBAnot)
KEGGHyper_LMO1LMO2MYBAnot <- hyperGTest(KEGGparams_LMO1LMO2MYBAnot)
# --17


GOparams_LMO1MYBAnot <- new("GOHyperGParams", geneIds = selGenes_LMO1MYBAnot, universeGeneIds = geneUniverse_LMO1MYBAnot,
    annotation = "hgu133plus2.db", ontology = "BP", pvalueCutoff = 0.05, conditional = FALSE,
    testDirection = "over")

KEGGparams_LMO1MYBAnot <- new("KEGGHyperGParams", geneIds = selGenes_LMO1MYBAnot, universeGeneIds = geneUniverse_LMO1MYBAnot,
    annotation = "hgu133plus2.db", pvalueCutoff = 0.05)

# Ejecutamos los análisis
GOHyper_LMO1MYBAnot <- hyperGTest(GOparams_LMO1MYBAnot)
KEGGHyper_LMO1MYBAnot <- hyperGTest(KEGGparams_LMO1MYBAnot)
# --18. VAS POR AQUI!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!


GOparams_LMO2TAL1Anot <- new("GOHyperGParams", geneIds = selGenes_LMO2TAL1Anot, universeGeneIds = geneUniverse_LMO2TAL1Anot,
    annotation = "hgu133plus2.db", ontology = "BP", pvalueCutoff = 0.05, conditional = FALSE,
    testDirection = "over")

KEGGparams_LMO2TAL1Anot <- new("KEGGHyperGParams", geneIds = selGenes_LMO2TAL1Anot, universeGeneIds = geneUniverse_LMO2TAL1Anot,
    annotation = "hgu133plus2.db", pvalueCutoff = 0.05)

# Ejecutamos los análisis
GOHyper_LMO2TAL1Anot <- hyperGTest(GOparams_LMO2TAL1Anot)
KEGGHyper_LMO2TAL1Anot <- hyperGTest(KEGGparams_LMO2TAL1Anot)
# --19


GOparams_LMO2TAL2Anot <- new("GOHyperGParams", geneIds = selGenes_LMO2TAL2Anot, universeGeneIds = geneUniverse_LMO2TAL2Anot,
    annotation = "hgu133plus2.db", ontology = "BP", pvalueCutoff = 0.05, conditional = FALSE,
    testDirection = "over")

KEGGparams_LMO2TAL2Anot <- new("KEGGHyperGParams", geneIds = selGenes_LMO2TAL2Anot, universeGeneIds = geneUniverse_LMO2TAL2Anot,
    annotation = "hgu133plus2.db", pvalueCutoff = 0.05)

# Ejecutamos los análisis
GOHyper_LMO2TAL2Anot <- hyperGTest(GOparams_LMO2TAL2Anot)
KEGGHyper_LMO2TAL2Anot <- hyperGTest(KEGGparams_LMO2TAL2Anot)
# --20


GOparams_LMO2TAL2LMO1Anot <- new("GOHyperGParams", geneIds = selGenes_LMO2TAL2LMO1Anot, universeGeneIds = geneUniverse_LMO2TAL2LMO1Anot,
    annotation = "hgu133plus2.db", ontology = "BP", pvalueCutoff = 0.05, conditional = FALSE,
    testDirection = "over")

KEGGparams_LMO2TAL2LMO1Anot <- new("KEGGHyperGParams", geneIds = selGenes_LMO2TAL2LMO1Anot, universeGeneIds = geneUniverse_LMO2TAL2LMO1Anot,
    annotation = "hgu133plus2.db", pvalueCutoff = 0.05)

# Ejecutamos los análisis
GOHyper_LMO2TAL2LMO1Anot <- hyperGTest(GOparams_LMO2TAL2LMO1Anot)
KEGGHyper_LMO2TAL2LMO1Anot <- hyperGTest(KEGGparams_LMO2TAL2LMO1Anot)
# --21


GOparams_LMO2TLX1Anot <- new("GOHyperGParams", geneIds = selGenes_LMO2TLX1Anot, universeGeneIds = geneUniverse_LMO2TLX1Anot,
    annotation = "hgu133plus2.db", ontology = "BP", pvalueCutoff = 0.05, conditional = FALSE,
    testDirection = "over")

KEGGparams_LMO2TLX1Anot <- new("KEGGHyperGParams", geneIds = selGenes_LMO2TLX1Anot, universeGeneIds = geneUniverse_LMO2TLX1Anot,
    annotation = "hgu133plus2.db", pvalueCutoff = 0.05)

# Ejecutamos los análisis
GOHyper_LMO2TLX1Anot <- hyperGTest(GOparams_LMO2TLX1Anot)
KEGGHyper_LMO2TLX1Anot <- hyperGTest(KEGGparams_LMO2TLX1Anot)
# --22


GOparams_LMO2TLX3Anot <- new("GOHyperGParams", geneIds = selGenes_LMO2TLX3Anot, universeGeneIds = geneUniverse_LMO2TLX3Anot,
    annotation = "hgu133plus2.db", ontology = "BP", pvalueCutoff = 0.05, conditional = FALSE,
    testDirection = "over")

KEGGparams_LMO2TLX3Anot <- new("KEGGHyperGParams", geneIds = selGenes_LMO2TLX3Anot, universeGeneIds = geneUniverse_LMO2TLX3Anot,
    annotation = "hgu133plus2.db", pvalueCutoff = 0.05)

# Ejecutamos los análisis
GOHyper_LMO2TLX3Anot <- hyperGTest(GOparams_LMO2TLX3Anot)
KEGGHyper_LMO2TLX3Anot <- hyperGTest(KEGGparams_LMO2TLX3Anot)

# --23


GOparams_LMOAnot <- new("GOHyperGParams", geneIds = selGenes_LMOAnot, universeGeneIds = geneUniverse_LMOAnot,
    annotation = "hgu133plus2.db", ontology = "BP", pvalueCutoff = 0.05, conditional = FALSE,
    testDirection = "over")

KEGGparams_LMOAnot <- new("KEGGHyperGParams", geneIds = selGenes_LMOAnot, universeGeneIds = geneUniverse_LMOAnot,
    annotation = "hgu133plus2.db", pvalueCutoff = 0.05)

# Ejecutamos los análisis
GOHyper_LMOAnot <- hyperGTest(GOparams_LMOAnot)
KEGGHyper_LMOAnot <- hyperGTest(KEGGparams_LMOAnot)

# --24


GOparams_LMOBMAnot <- new("GOHyperGParams", geneIds = selGenes_LMOBMAnot, universeGeneIds = geneUniverse_LMOBMAnot,
    annotation = "hgu133plus2.db", ontology = "BP", pvalueCutoff = 0.05, conditional = FALSE,
    testDirection = "over")

KEGGparams_LMOBMAnot <- new("KEGGHyperGParams", geneIds = selGenes_LMOBMAnot, universeGeneIds = geneUniverse_LMOBMAnot,
    annotation = "hgu133plus2.db", pvalueCutoff = 0.05)

# Ejecutamos los análisis
GOHyper_LMOBMAnot <- hyperGTest(GOparams_LMOBMAnot)
KEGGHyper_LMOBMAnot <- hyperGTest(KEGGparams_LMOBMAnot)

# --25


GOparams_LMOTAL1Anot <- new("GOHyperGParams", geneIds = selGenes_LMOTAL1Anot, universeGeneIds = geneUniverse_LMOTAL1Anot,
    annotation = "hgu133plus2.db", ontology = "BP", pvalueCutoff = 0.05, conditional = FALSE,
    testDirection = "over")

KEGGparams_LMOTAL1Anot <- new("KEGGHyperGParams", geneIds = selGenes_LMOTAL1Anot, universeGeneIds = geneUniverse_LMOTAL1Anot,
    annotation = "hgu133plus2.db", pvalueCutoff = 0.05)

# Ejecutamos los análisis
GOHyper_LMOTAL1Anot <- hyperGTest(GOparams_LMOTAL1Anot)
KEGGHyper_LMOTAL1Anot <- hyperGTest(KEGGparams_LMOTAL1Anot)

# --26


GOparams_LMOTAL2Anot <- new("GOHyperGParams", geneIds = selGenes_LMOTAL2Anot, universeGeneIds = geneUniverse_LMOTAL2Anot,
    annotation = "hgu133plus2.db", ontology = "BP", pvalueCutoff = 0.05, conditional = FALSE,
    testDirection = "over")

KEGGparams_LMOTAL2Anot <- new("KEGGHyperGParams", geneIds = selGenes_LMOTAL2Anot, universeGeneIds = geneUniverse_LMOTAL2Anot,
    annotation = "hgu133plus2.db", pvalueCutoff = 0.05)

# Ejecutamos los análisis
GOHyper_LMOTAL2Anot <- hyperGTest(GOparams_LMOTAL2Anot)
KEGGHyper_LMOTAL2Anot <- hyperGTest(KEGGparams_LMOTAL2Anot)

# --27


GOparams_LMOTAL2LMO1Anot <- new("GOHyperGParams", geneIds = selGenes_LMOTAL2LMO1Anot, universeGeneIds = geneUniverse_LMOTAL2LMO1Anot,
    annotation = "hgu133plus2.db", ontology = "BP", pvalueCutoff = 0.05, conditional = FALSE,
    testDirection = "over")

KEGGparams_LMOTAL2LMO1Anot <- new("KEGGHyperGParams", geneIds = selGenes_LMOTAL2LMO1Anot, universeGeneIds = geneUniverse_LMOTAL2LMO1Anot,
    annotation = "hgu133plus2.db", pvalueCutoff = 0.05)

# Ejecutamos los análisis
GOHyper_LMOTAL2LMO1Anot <- hyperGTest(GOparams_LMOTAL2LMO1Anot)
KEGGHyper_LMOTAL2LMO1Anot <- hyperGTest(KEGGparams_LMOTAL2LMO1Anot)

# --28


GOparams_LMOTALAnot <- new("GOHyperGParams", geneIds = selGenes_LMOTALAnot, universeGeneIds = geneUniverse_LMOTALAnot,
    annotation = "hgu133plus2.db", ontology = "BP", pvalueCutoff = 0.05, conditional = FALSE,
    testDirection = "over")

KEGGparams_LMOTALAnot <- new("KEGGHyperGParams", geneIds = selGenes_LMOTALAnot, universeGeneIds = geneUniverse_LMOTALAnot,
    annotation = "hgu133plus2.db", pvalueCutoff = 0.05)

# Ejecutamos los análisis
GOHyper_LMOTALAnot <- hyperGTest(GOparams_LMOTALAnot)
KEGGHyper_LMOTALAnot <- hyperGTest(KEGGparams_LMOTALAnot)

# --29


GOparams_LMOTLX1Anot <- new("GOHyperGParams", geneIds = selGenes_LMOTLX1Anot, universeGeneIds = geneUniverse_LMOTLX1Anot,
    annotation = "hgu133plus2.db", ontology = "BP", pvalueCutoff = 0.05, conditional = FALSE,
    testDirection = "over")

KEGGparams_LMOTLX1Anot <- new("KEGGHyperGParams", geneIds = selGenes_LMOTLX1Anot, universeGeneIds = geneUniverse_LMOTLX1Anot,
    annotation = "hgu133plus2.db", pvalueCutoff = 0.05)

# Ejecutamos los análisis
GOHyper_LMOTLX1Anot <- hyperGTest(GOparams_LMOTLX1Anot)
KEGGHyper_LMOTLX1Anot <- hyperGTest(KEGGparams_LMOTLX1Anot)

# --30


GOparams_LMOTLX3Anot <- new("GOHyperGParams", geneIds = selGenes_LMOTLX3Anot, universeGeneIds = geneUniverse_LMOTLX3Anot,
    annotation = "hgu133plus2.db", ontology = "BP", pvalueCutoff = 0.05, conditional = FALSE,
    testDirection = "over")

KEGGparams_LMOTLX3Anot <- new("KEGGHyperGParams", geneIds = selGenes_LMOTLX3Anot, universeGeneIds = geneUniverse_LMOTLX3Anot,
    annotation = "hgu133plus2.db", pvalueCutoff = 0.05)

# Ejecutamos los análisis
GOHyper_LMOTLX3Anot <- hyperGTest(GOparams_LMOTLX3Anot)
KEGGHyper_LMOTLX3Anot <- hyperGTest(KEGGparams_LMOTLX3Anot)

# --31


GOparams_MYBTAL1Anot <- new("GOHyperGParams", geneIds = selGenes_MYBTAL1Anot, universeGeneIds = geneUniverse_MYBTAL1Anot,
    annotation = "hgu133plus2.db", ontology = "BP", pvalueCutoff = 0.05, conditional = FALSE,
    testDirection = "over")

KEGGparams_MYBTAL1Anot <- new("KEGGHyperGParams", geneIds = selGenes_MYBTAL1Anot, universeGeneIds = geneUniverse_MYBTAL1Anot,
    annotation = "hgu133plus2.db", pvalueCutoff = 0.05)

# Ejecutamos los análisis
GOHyper_MYBTAL1Anot <- hyperGTest(GOparams_MYBTAL1Anot)
KEGGHyper_MYBTAL1Anot <- hyperGTest(KEGGparams_MYBTAL1Anot)

# --32


GOparams_MYBTAL2Anot <- new("GOHyperGParams", geneIds = selGenes_MYBTAL2Anot, universeGeneIds = geneUniverse_MYBTAL2Anot,
    annotation = "hgu133plus2.db", ontology = "BP", pvalueCutoff = 0.05, conditional = FALSE,
    testDirection = "over")

KEGGparams_MYBTAL2Anot <- new("KEGGHyperGParams", geneIds = selGenes_MYBTAL2Anot, universeGeneIds = geneUniverse_MYBTAL2Anot,
    annotation = "hgu133plus2.db", pvalueCutoff = 0.05)

# Ejecutamos los análisis
GOHyper_MYBTAL2Anot <- hyperGTest(GOparams_MYBTAL2Anot)
KEGGHyper_MYBTAL2Anot <- hyperGTest(KEGGparams_MYBTAL2Anot)

# --33


GOparams_MYBTAL2LMO1Anot <- new("GOHyperGParams", geneIds = selGenes_MYBTAL2LMO1Anot, universeGeneIds = geneUniverse_MYBTAL2LMO1Anot,
    annotation = "hgu133plus2.db", ontology = "BP", pvalueCutoff = 0.05, conditional = FALSE,
    testDirection = "over")

KEGGparams_MYBTAL2LMO1Anot <- new("KEGGHyperGParams", geneIds = selGenes_MYBTAL2LMO1Anot, universeGeneIds = geneUniverse_MYBTAL2LMO1Anot,
    annotation = "hgu133plus2.db", pvalueCutoff = 0.05)

# Ejecutamos los análisis
GOHyper_MYBTAL2LMO1Anot <- hyperGTest(GOparams_MYBTAL2LMO1Anot)
KEGGHyper_MYBTAL2LMO1Anot <- hyperGTest(KEGGparams_MYBTAL2LMO1Anot)

# --34


GOparams_MYBTLX1Anot <- new("GOHyperGParams", geneIds = selGenes_MYBTLX1Anot, universeGeneIds = geneUniverse_MYBTLX1Anot,
    annotation = "hgu133plus2.db", ontology = "BP", pvalueCutoff = 0.05, conditional = FALSE,
    testDirection = "over")

KEGGparams_MYBTLX1Anot <- new("KEGGHyperGParams", geneIds = selGenes_MYBTLX1Anot, universeGeneIds = geneUniverse_MYBTLX1Anot,
    annotation = "hgu133plus2.db", pvalueCutoff = 0.05)

# Ejecutamos los análisis
GOHyper_MYBTLX1Anot <- hyperGTest(GOparams_MYBTLX1Anot)
KEGGHyper_MYBTLX1Anot <- hyperGTest(KEGGparams_MYBTLX1Anot)

# --35


GOparams_MYBTLX3Anot <- new("GOHyperGParams", geneIds = selGenes_MYBTLX3Anot, universeGeneIds = geneUniverse_MYBTLX3Anot,
    annotation = "hgu133plus2.db", ontology = "BP", pvalueCutoff = 0.05, conditional = FALSE,
    testDirection = "over")

KEGGparams_MYBTLX3Anot <- new("KEGGHyperGParams", geneIds = selGenes_MYBTLX3Anot, universeGeneIds = geneUniverse_MYBTLX3Anot,
    annotation = "hgu133plus2.db", pvalueCutoff = 0.05)

# Ejecutamos los análisis
GOHyper_MYBTLX3Anot <- hyperGTest(GOparams_MYBTLX3Anot)
KEGGHyper_MYBTLX3Anot <- hyperGTest(KEGGparams_MYBTLX3Anot)

# --36


GOparams_TAL1TAL2LMO1Anot <- new("GOHyperGParams", geneIds = selGenes_TAL1TAL2LMO1Anot, universeGeneIds = geneUniverse_TAL1TAL2LMO1Anot,
    annotation = "hgu133plus2.db", ontology = "BP", pvalueCutoff = 0.05, conditional = FALSE,
    testDirection = "over")

KEGGparams_TAL1TAL2LMO1Anot <- new("KEGGHyperGParams", geneIds = selGenes_TAL1TAL2LMO1Anot, universeGeneIds = geneUniverse_TAL1TAL2LMO1Anot,
    annotation = "hgu133plus2.db", pvalueCutoff = 0.05)

# Ejecutamos los análisis
GOHyper_TAL1TAL2LMO1Anot <- hyperGTest(GOparams_TAL1TAL2LMO1Anot)
KEGGHyper_TAL1TAL2LMO1Anot <- hyperGTest(KEGGparams_TAL1TAL2LMO1Anot)

# --37


GOparams_TAL1TLX1Anot <- new("GOHyperGParams", geneIds = selGenes_TAL1TLX1Anot, universeGeneIds = geneUniverse_TAL1TLX1Anot,
    annotation = "hgu133plus2.db", ontology = "BP", pvalueCutoff = 0.05, conditional = FALSE,
    testDirection = "over")

KEGGparams_TAL1TLX1Anot <- new("KEGGHyperGParams", geneIds = selGenes_TAL1TLX1Anot, universeGeneIds = geneUniverse_TAL1TLX1Anot,
    annotation = "hgu133plus2.db", pvalueCutoff = 0.05)

# Ejecutamos los análisis
GOHyper_TAL1TLX1Anot <- hyperGTest(GOparams_TAL1TLX1Anot)
KEGGHyper_TAL1TLX1Anot <- hyperGTest(KEGGparams_TAL1TLX1Anot)

# --38


GOparams_TAL1TLX3Anot <- new("GOHyperGParams", geneIds = selGenes_TAL1TLX3Anot, universeGeneIds = geneUniverse_TAL1TLX3Anot,
    annotation = "hgu133plus2.db", ontology = "BP", pvalueCutoff = 0.05, conditional = FALSE,
    testDirection = "over")

KEGGparams_TAL1TLX3Anot <- new("KEGGHyperGParams", geneIds = selGenes_TAL1TLX3Anot, universeGeneIds = geneUniverse_TAL1TLX3Anot,
    annotation = "hgu133plus2.db", pvalueCutoff = 0.05)

# Ejecutamos los análisis
GOHyper_TAL1TLX3Anot <- hyperGTest(GOparams_TAL1TLX3Anot)
KEGGHyper_TAL1TLX3Anot <- hyperGTest(KEGGparams_TAL1TLX3Anot)

# --39


GOparams_TAL2LMO1Anot <- new("GOHyperGParams", geneIds = selGenes_TAL2LMO1Anot, universeGeneIds = geneUniverse_TAL2LMO1Anot,
    annotation = "hgu133plus2.db", ontology = "BP", pvalueCutoff = 0.05, conditional = FALSE,
    testDirection = "over")

KEGGparams_TAL2LMO1Anot <- new("KEGGHyperGParams", geneIds = selGenes_TAL2LMO1Anot, universeGeneIds = geneUniverse_TAL2LMO1Anot,
    annotation = "hgu133plus2.db", pvalueCutoff = 0.05)

# Ejecutamos los análisis
GOHyper_TAL2LMO1Anot <- hyperGTest(GOparams_TAL2LMO1Anot)
KEGGHyper_TAL2LMO1Anot <- hyperGTest(KEGGparams_TAL2LMO1Anot)

# --40


GOparams_TAL2LMO1TLX1Anot <- new("GOHyperGParams", geneIds = selGenes_TAL2LMO1TLX1Anot, universeGeneIds = geneUniverse_TAL2LMO1TLX1Anot,
    annotation = "hgu133plus2.db", ontology = "BP", pvalueCutoff = 0.05, conditional = FALSE,
    testDirection = "over")

KEGGparams_TAL2LMO1TLX1Anot <- new("KEGGHyperGParams", geneIds = selGenes_TAL2LMO1TLX1Anot, universeGeneIds = geneUniverse_TAL2LMO1TLX1Anot,
    annotation = "hgu133plus2.db", pvalueCutoff = 0.05)

# Ejecutamos los análisis
GOHyper_TAL2LMO1TLX1Anot <- hyperGTest(GOparams_TAL2LMO1TLX1Anot)
KEGGHyper_TAL2LMO1TLX1Anot <- hyperGTest(KEGGparams_TAL2LMO1TLX1Anot)

# --41


GOparams_TAL2TAL2LMO1Anot <- new("GOHyperGParams", geneIds = selGenes_TAL2TAL2LMO1Anot, universeGeneIds = geneUniverse_TAL2TAL2LMO1Anot,
    annotation = "hgu133plus2.db", ontology = "BP", pvalueCutoff = 0.05, conditional = FALSE,
    testDirection = "over")

KEGGparams_TAL2TAL2LMO1Anot <- new("KEGGHyperGParams", geneIds = selGenes_TAL2TAL2LMO1Anot, universeGeneIds = geneUniverse_TAL2TAL2LMO1Anot,
    annotation = "hgu133plus2.db", pvalueCutoff = 0.05)

# Ejecutamos los análisis
GOHyper_TAL2TAL2LMO1Anot <- hyperGTest(GOparams_TAL2TAL2LMO1Anot)
KEGGHyper_TAL2TAL2LMO1Anot <- hyperGTest(KEGGparams_TAL2TAL2LMO1Anot)

# --42


GOparams_TAL2TLX1Anot <- new("GOHyperGParams", geneIds = selGenes_TAL2TLX1Anot, universeGeneIds = geneUniverse_TAL2TLX1Anot,
    annotation = "hgu133plus2.db", ontology = "BP", pvalueCutoff = 0.05, conditional = FALSE,
    testDirection = "over")

KEGGparams_TAL2TLX1Anot <- new("KEGGHyperGParams", geneIds = selGenes_TAL2TLX1Anot, universeGeneIds = geneUniverse_TAL2TLX1Anot,
    annotation = "hgu133plus2.db", pvalueCutoff = 0.05)

# Ejecutamos los análisis
GOHyper_TAL2TLX1Anot <- hyperGTest(GOparams_TAL2TLX1Anot)
KEGGHyper_TAL2TLX1Anot <- hyperGTest(KEGGparams_TAL2TLX1Anot)


# --43


GOparams_TAL2TLX3Anot <- new("GOHyperGParams", geneIds = selGenes_TAL2TLX3Anot, universeGeneIds = geneUniverse_TAL2TLX3Anot,
    annotation = "hgu133plus2.db", ontology = "BP", pvalueCutoff = 0.05, conditional = FALSE,
    testDirection = "over")

KEGGparams_TAL2TLX3Anot <- new("KEGGHyperGParams", geneIds = selGenes_TAL2TLX3Anot, universeGeneIds = geneUniverse_TAL2TLX3Anot,
    annotation = "hgu133plus2.db", pvalueCutoff = 0.05)

# Ejecutamos los análisis
GOHyper_TAL2TLX3Anot <- hyperGTest(GOparams_TAL2TLX3Anot)
KEGGHyper_TAL2TLX3Anot <- hyperGTest(KEGGparams_TAL2TLX3Anot)


# --44


GOparams_TALAnot <- new("GOHyperGParams", geneIds = selGenes_TALAnot, universeGeneIds = geneUniverse_TALAnot,
    annotation = "hgu133plus2.db", ontology = "BP", pvalueCutoff = 0.05, conditional = FALSE,
    testDirection = "over")

KEGGparams_TALAnot <- new("KEGGHyperGParams", geneIds = selGenes_TALAnot, universeGeneIds = geneUniverse_TALAnot,
    annotation = "hgu133plus2.db", pvalueCutoff = 0.05)

# Ejecutamos los análisis
GOHyper_TALAnot <- hyperGTest(GOparams_TALAnot)
KEGGHyper_TALAnot <- hyperGTest(KEGGparams_TALAnot)



# --45


GOparams_TALBMAnot <- new("GOHyperGParams", geneIds = selGenes_TALBMAnot, universeGeneIds = geneUniverse_TALBMAnot,
    annotation = "hgu133plus2.db", ontology = "BP", pvalueCutoff = 0.05, conditional = FALSE,
    testDirection = "over")

KEGGparams_TALBMAnot <- new("KEGGHyperGParams", geneIds = selGenes_TALBMAnot, universeGeneIds = geneUniverse_TALBMAnot,
    annotation = "hgu133plus2.db", pvalueCutoff = 0.05)

# Ejecutamos los análisis
GOHyper_TALBMAnot <- hyperGTest(GOparams_TALBMAnot)
KEGGHyper_TALBMAnot <- hyperGTest(KEGGparams_TALBMAnot)



# --46


GOparams_TALMYBAnot <- new("GOHyperGParams", geneIds = selGenes_TALMYBAnot, universeGeneIds = geneUniverse_TALMYBAnot,
    annotation = "hgu133plus2.db", ontology = "BP", pvalueCutoff = 0.05, conditional = FALSE,
    testDirection = "over")

KEGGparams_TALMYBAnot <- new("KEGGHyperGParams", geneIds = selGenes_TALMYBAnot, universeGeneIds = geneUniverse_TALMYBAnot,
    annotation = "hgu133plus2.db", pvalueCutoff = 0.05)

# Ejecutamos los análisis
GOHyper_TALMYBAnot <- hyperGTest(GOparams_TALMYBAnot)
KEGGHyper_TALMYBAnot <- hyperGTest(KEGGparams_TALMYBAnot)



# --47


GOparams_TALTAL2LMO1Anot <- new("GOHyperGParams", geneIds = selGenes_TALTAL2LMO1Anot, universeGeneIds = geneUniverse_TALTAL2LMO1Anot,
    annotation = "hgu133plus2.db", ontology = "BP", pvalueCutoff = 0.05, conditional = FALSE,
    testDirection = "over")

KEGGparams_TALTAL2LMO1Anot <- new("KEGGHyperGParams", geneIds = selGenes_TALTAL2LMO1Anot, universeGeneIds = geneUniverse_TALTAL2LMO1Anot,
    annotation = "hgu133plus2.db", pvalueCutoff = 0.05)

# Ejecutamos los análisis
GOHyper_TALTAL2LMO1Anot <- hyperGTest(GOparams_TALTAL2LMO1Anot)
KEGGHyper_TALTAL2LMO1Anot <- hyperGTest(KEGGparams_TALTAL2LMO1Anot)

# --48


GOparams_TALTLX1Anot <- new("GOHyperGParams", geneIds = selGenes_TALTLX1Anot, universeGeneIds = geneUniverse_TALTLX1Anot,
    annotation = "hgu133plus2.db", ontology = "BP", pvalueCutoff = 0.05, conditional = FALSE,
    testDirection = "over")

KEGGparams_TALTLX1Anot <- new("KEGGHyperGParams", geneIds = selGenes_TALTLX1Anot, universeGeneIds = geneUniverse_TALTLX1Anot,
    annotation = "hgu133plus2.db", pvalueCutoff = 0.05)

# Ejecutamos los análisis
GOHyper_TALTLX1Anot <- hyperGTest(GOparams_TALTLX1Anot)
KEGGHyper_TALTLX1Anot <- hyperGTest(KEGGparams_TALTLX1Anot)


# --49


GOparams_TALTLX3Anot <- new("GOHyperGParams", geneIds = selGenes_TALTLX3Anot, universeGeneIds = geneUniverse_TALTLX3Anot,
    annotation = "hgu133plus2.db", ontology = "BP", pvalueCutoff = 0.05, conditional = FALSE,
    testDirection = "over")

KEGGparams_TALTLX3Anot <- new("KEGGHyperGParams", geneIds = selGenes_TALTLX3Anot, universeGeneIds = geneUniverse_TALTLX3Anot,
    annotation = "hgu133plus2.db", pvalueCutoff = 0.05)

# Ejecutamos los análisis
GOHyper_TALTLX3Anot <- hyperGTest(GOparams_TALTLX3Anot)
KEGGHyper_TALTLX3Anot <- hyperGTest(KEGGparams_TALTLX3Anot)


# --50


GOparams_TALTLXAnot <- new("GOHyperGParams", geneIds = selGenes_TALTLXAnot, universeGeneIds = geneUniverse_TALTLXAnot,
    annotation = "hgu133plus2.db", ontology = "BP", pvalueCutoff = 0.05, conditional = FALSE,
    testDirection = "over")

KEGGparams_TALTLXAnot <- new("KEGGHyperGParams", geneIds = selGenes_TALTLXAnot, universeGeneIds = geneUniverse_TALTLXAnot,
    annotation = "hgu133plus2.db", pvalueCutoff = 0.05)

# Ejecutamos los análisis
GOHyper_TALTLXAnot <- hyperGTest(GOparams_TALTLXAnot)
KEGGHyper_TALTLXAnot <- hyperGTest(KEGGparams_TALTLXAnot)



# --51


GOparams_TALTLXLAnot <- new("GOHyperGParams", geneIds = selGenes_TALTLXLAnot, universeGeneIds = geneUniverse_TALTLXLAnot,
    annotation = "hgu133plus2.db", ontology = "BP", pvalueCutoff = 0.05, conditional = FALSE,
    testDirection = "over")

KEGGparams_TALTLXLAnot <- new("KEGGHyperGParams", geneIds = selGenes_TALTLXLAnot, universeGeneIds = geneUniverse_TALTLXLAnot,
    annotation = "hgu133plus2.db", pvalueCutoff = 0.05)

# Ejecutamos los análisis
GOHyper_TALTLXLAnot <- hyperGTest(GOparams_TALTLXLAnot)
KEGGHyper_TALTLXLAnot <- hyperGTest(KEGGparams_TALTLXLAnot)



# --52


GOparams_TLXAnot <- new("GOHyperGParams", geneIds = selGenes_TLXAnot, universeGeneIds = geneUniverse_TLXAnot,
    annotation = "hgu133plus2.db", ontology = "BP", pvalueCutoff = 0.05, conditional = FALSE,
    testDirection = "over")

KEGGparams_TLXAnot <- new("KEGGHyperGParams", geneIds = selGenes_TLXAnot, universeGeneIds = geneUniverse_TLXAnot,
    annotation = "hgu133plus2.db", pvalueCutoff = 0.05)

# Ejecutamos los análisis
GOHyper_TLXAnot <- hyperGTest(GOparams_TLXAnot)
KEGGHyper_TLXAnot <- hyperGTest(KEGGparams_TLXAnot)



# --53


GOparams_TLXBMAnot <- new("GOHyperGParams", geneIds = selGenes_TLXBMAnot, universeGeneIds = geneUniverse_TLXBMAnot,
    annotation = "hgu133plus2.db", ontology = "BP", pvalueCutoff = 0.05, conditional = FALSE,
    testDirection = "over")

KEGGparams_TLXBMAnot <- new("KEGGHyperGParams", geneIds = selGenes_TLXBMAnot, universeGeneIds = geneUniverse_TLXBMAnot,
    annotation = "hgu133plus2.db", pvalueCutoff = 0.05)

# Ejecutamos los análisis
GOHyper_TLXBMAnot <- hyperGTest(GOparams_TLXBMAnot)
KEGGHyper_TLXBMAnot <- hyperGTest(KEGGparams_TLXBMAnot)



# --54


GOparams_TLXMYBAnot <- new("GOHyperGParams", geneIds = selGenes_TLXMYBAnot, universeGeneIds = geneUniverse_TLXMYBAnot,
    annotation = "hgu133plus2.db", ontology = "BP", pvalueCutoff = 0.05, conditional = FALSE,
    testDirection = "over")

KEGGparams_TLXMYBAnot <- new("KEGGHyperGParams", geneIds = selGenes_TLXMYBAnot, universeGeneIds = geneUniverse_TLXMYBAnot,
    annotation = "hgu133plus2.db", pvalueCutoff = 0.05)

# Ejecutamos los análisis
GOHyper_TLXMYBAnot <- hyperGTest(GOparams_TLXMYBAnot)
KEGGHyper_TLXMYBAnot <- hyperGTest(KEGGparams_TLXMYBAnot)



# --55


GOparams_TLXTAL1Anot <- new("GOHyperGParams", geneIds = selGenes_TLXTAL1Anot, universeGeneIds = geneUniverse_TLXTAL1Anot,
    annotation = "hgu133plus2.db", ontology = "BP", pvalueCutoff = 0.05, conditional = FALSE,
    testDirection = "over")

KEGGparams_TLXTAL1Anot <- new("KEGGHyperGParams", geneIds = selGenes_TLXTAL1Anot, universeGeneIds = geneUniverse_TLXTAL1Anot,
    annotation = "hgu133plus2.db", pvalueCutoff = 0.05)

# Ejecutamos los análisis
GOHyper_TLXTAL1Anot <- hyperGTest(GOparams_TLXTAL1Anot)
KEGGHyper_TLXTAL1Anot <- hyperGTest(KEGGparams_TLXTAL1Anot)

# --56


GOparams_TLXTAL2Anot <- new("GOHyperGParams", geneIds = selGenes_TLXTAL2Anot, universeGeneIds = geneUniverse_TLXTAL2Anot,
    annotation = "hgu133plus2.db", ontology = "BP", pvalueCutoff = 0.05, conditional = FALSE,
    testDirection = "over")

KEGGparams_TLXTAL2Anot <- new("KEGGHyperGParams", geneIds = selGenes_TLXTAL2Anot, universeGeneIds = geneUniverse_TLXTAL2Anot,
    annotation = "hgu133plus2.db", pvalueCutoff = 0.05)

# Ejecutamos los análisis
GOHyper_TLXTAL2Anot <- hyperGTest(GOparams_TLXTAL2Anot)
KEGGHyper_TLXTAL2Anot <- hyperGTest(KEGGparams_TLXTAL2Anot)
# --57


GOparams_TLXTAL2LMO1Anot <- new("GOHyperGParams", geneIds = selGenes_TLXTAL2LMO1Anot, universeGeneIds = geneUniverse_TLXTAL2LMO1Anot,
    annotation = "hgu133plus2.db", ontology = "BP", pvalueCutoff = 0.05, conditional = FALSE,
    testDirection = "over")

KEGGparams_TLXTAL2LMO1Anot <- new("KEGGHyperGParams", geneIds = selGenes_TLXTAL2LMO1Anot, universeGeneIds = geneUniverse_TLXTAL2LMO1Anot,
    annotation = "hgu133plus2.db", pvalueCutoff = 0.05)

# Ejecutamos los análisis
GOHyper_TLXTAL2LMO1Anot <- hyperGTest(GOparams_TLXTAL2LMO1Anot)
KEGGHyper_TLXTAL2LMO1Anot <- hyperGTest(KEGGparams_TLXTAL2LMO1Anot)

```

Resultados

Los resultados del análisis se encuentran en un objeto que se puede visualizar directamente.

```{r, warning=TRUE, error=FALSE}
summary(GOHyper_CNRAnot)
summary(KEGGHyper_CNRAnot)
```

Una mejor opción es exportarlos a un archivo, preferentemente con hiperenlaces que permitan una exploración directa de las categorías

----------

topTab_GSE26713_BMHOXAAnot, topTab_GSE26713_BMLMO1Anot, topTab_GSE26713_BMLMO2Anot, topTab_GSE26713_BMMYBAnot, topTab_GSE26713_BMTAL1Anot, topTab_GSE26713_BMTAL2Anot, topTab_GSE26713_BMTAL2LMO1Anot, topTab_GSE26713_BMTLX1Anot, topTab_GSE26713_BMTLX3Anot, topTab_GSE26713_HOXALMO1Anot, topTab_GSE26713_HOXALMO2Anot, topTab_GSE26713_HOXATAL1Anot, topTab_GSE26713_HOXATAL2Anot, topTab_GSE26713_HOXATAL2LMO1Anot, topTab_GSE26713_HOXATLX1Anot, topTab_GSE26713_HOXATLX3Anot, topTab_GSE26713_LMO1LMO2MYBAnot, topTab_GSE26713_LMO1MYBAnot, topTab_GSE26713_LMO2TAL1Anot, topTab_GSE26713_LMO2TAL2Anot, topTab_GSE26713_LMO2TAL2LMO1Anot, topTab_GSE26713_LMO2TLX1Anot, topTab_GSE26713_LMO2TLX3Anot, topTab_GSE26713_LMOAnot, topTab_GSE26713_LMOBMAnot, topTab_GSE26713_LMOTAL1Anot, topTab_GSE26713_LMOTAL2Anot, topTab_GSE26713_LMOTAL2LMO1Anot, topTab_GSE26713_LMOTALAnot, topTab_GSE26713_LMOTLX1Anot, topTab_GSE26713_LMOTLX3Anot, topTab_GSE26713_MYBTAL1Anot, topTab_GSE26713_MYBTAL2Anot, topTab_GSE26713_MYBTAL2LMO1Anot, topTab_GSE26713_MYBTLX1Anot, topTab_GSE26713_MYBTLX3Anot, topTab_GSE26713_TAL1TAL2LMO1Anot, topTab_GSE26713_TAL1TLX1Anot, topTab_GSE26713_TAL1TLX3Anot, topTab_GSE26713_TAL2LMO1Anot, topTab_GSE26713_TAL2LMO1TLX1Anot, topTab_GSE26713_TAL2TAL2LMO1Anot, topTab_GSE26713_TAL2TLX1Anot, topTab_GSE26713_TAL2TLX3Anot, topTab_GSE26713_TALAnot, topTab_GSE26713_TALBMAnot, topTab_GSE26713_TALMYBAnot, topTab_GSE26713_TALTAL2LMO1Anot, topTab_GSE26713_TALTLX1Anot, topTab_GSE26713_TALTLX3Anot, topTab_GSE26713_TALTLXAnot, topTab_GSE26713_TALTLXLAnot, topTab_GSE26713_TLXAnot, topTab_GSE26713_TLXBMAnot, topTab_GSE26713_TLXMYBAnot, topTab_GSE26713_TLXTAL1Anot, topTab_GSE26713_TLXTAL2Anot, topTab_GSE26713_TLXTAL2LMO1Anot

```{r, warning=TRUE, error=TRUE}
library(dplyr)

a <- (selGenes_TLXTAL2Anot %>%
          subset(P.Value < 0.05))
unique(a$ENTREZID)

library(ReactomePA)
enrich.result_BMHOXAAnot <- enrichPathway(gene = selGenes_BMHOXAAnot,
                               pvalueCutoff = 0.05,
                               readable = T,
                               organism = "human",
                               universe = geneUniverse_BMHOXAAnot)



enrich.result_BMLMO1Anot <- enrichPathway(gene = selGenes_BMLMO1Anot,
                               pvalueCutoff = 0.05,
                               readable = T,
                               organism = "human",
                               universe = geneUniverse_BMLMO1Anot)


enrich.result_BMLMO2Anot <- enrichPathway(gene = selGenes_BMLMO2Anot,
                               pvalueCutoff = 0.05,
                               readable = T,
                               organism = "human",
                               universe = geneUniverse_BMLMO2Anot)


enrich.result_BMMYBAnot <- enrichPathway(gene = selGenes_BMMYBAnot,
                               pvalueCutoff = 0.05,
                               readable = T,
                               organism = "human",
                               universe = geneUniverse_BMMYBAnot)



enrich.result_BMTAL1Anot <- enrichPathway(gene = selGenes_BMTAL1Anot,
                               pvalueCutoff = 0.05,
                               readable = T,
                               organism = "human",
                               universe = geneUniverse_BMTAL1Anot)


enrich.result_BMTAL2Anot <- enrichPathway(gene = selGenes_BMTAL2Anot,
                               pvalueCutoff = 0.05,
                               readable = T,
                               organism = "human",
                               universe = geneUniverse_BMTAL2Anot)



enrich.result_BMTAL2LMO1Anot <- enrichPathway(gene = selGenes_BMTAL2LMO1Anot,
                               pvalueCutoff = 0.05,
                               readable = T,
                               organism = "human",
                               universe = geneUniverse_BMTAL2LMO1Anot)



enrich.result_BMTLX1Anot <- enrichPathway(gene = selGenes_BMTLX1Anot,
                               pvalueCutoff = 0.05,
                               readable = T,
                               organism = "human",
                               universe = geneUniverse_BMTLX1Anot)


enrich.result_BMTLX3Anot <- enrichPathway(gene = selGenes_BMTLX3Anot,
                               pvalueCutoff = 0.05,
                               readable = T,
                               organism = "human",
                               universe = geneUniverse_BMTLX3Anot)
enrich.result_HOXALMO1Anot <- enrichPathway(gene = selGenes_HOXALMO1Anot,
                               pvalueCutoff = 0.05,
                               readable = T,
                               organism = "human",
                               universe = geneUniverse_HOXALMO1Anot)



enrich.result_HOXALMO2Anot <- enrichPathway(gene = selGenes_HOXALMO2Anot,
                               pvalueCutoff = 0.05,
                               readable = T,
                               organism = "human",
                               universe = geneUniverse_HOXALMO2Anot)


enrich.result_HOXATAL1Anot <- enrichPathway(gene = selGenes_HOXATAL1Anot,
                               pvalueCutoff = 0.05,
                               readable = T,
                               organism = "human",
                               universe = geneUniverse_HOXATAL1Anot)
enrich.result_HOXATAL2Anot <- enrichPathway(gene = selGenes_HOXATAL2Anot,
                               pvalueCutoff = 0.05,
                               readable = T,
                               organism = "human",
                               universe = geneUniverse_HOXATAL2Anot)



enrich.result_HOXATAL2LMO1Anot <- enrichPathway(gene = selGenes_HOXATAL2LMO1Anot,
                               pvalueCutoff = 0.05,
                               readable = T,
                               organism = "human",
                               universe = geneUniverse_HOXATAL2LMO1Anot)


enrich.result_HOXATLX1Anot <- enrichPathway(gene = selGenes_HOXATLX1Anot,
                               pvalueCutoff = 0.05,
                               readable = T,
                               organism = "human",
                               universe = geneUniverse_HOXATLX1Anot)
enrich.result_HOXATLX3Anot <- enrichPathway(gene = selGenes_HOXATLX3Anot,
                               pvalueCutoff = 0.05,
                               readable = T,
                               organism = "human",
                               universe = geneUniverse_HOXATLX3Anot)



enrich.result_LMO1LMO2MYBAnot <- enrichPathway(gene = selGenes_LMO1LMO2MYBAnot,
                               pvalueCutoff = 0.05,
                               readable = T,
                               organism = "human",
                               universe = geneUniverse_LMO1LMO2MYBAnot)



enrich.result_LMO1MYBAnot <- enrichPathway(gene = selGenes_LMO1MYBAnot,
                               pvalueCutoff = 0.05,
                               readable = T,
                               organism = "human",
                               universe = geneUniverse_LMO1MYBAnot)
enrich.result_LMO2TAL1Anot <- enrichPathway(gene = selGenes_LMO2TAL1Anot,
                               pvalueCutoff = 0.05,
                               readable = T,
                               organism = "human",
                               universe = geneUniverse_LMO2TAL1Anot)



enrich.result_LMO2TAL2Anot <- enrichPathway(gene = selGenes_LMO2TAL2Anot,
                               pvalueCutoff = 0.05,
                               readable = T,
                               organism = "human",
                               universe = geneUniverse_LMO2TAL2Anot)


enrich.result_LMO2TAL2LMO1Anot <- enrichPathway(gene = selGenes_LMO2TAL2LMO1Anot,
                               pvalueCutoff = 0.05,
                               readable = T,
                               organism = "human",
                               universe = geneUniverse_LMO2TAL2LMO1Anot)
enrich.result_LMO2TLX1Anot <- enrichPathway(gene = selGenes_LMO2TLX1Anot,
                               pvalueCutoff = 0.05,
                               readable = T,
                               organism = "human",
                               universe = geneUniverse_LMO2TLX1Anot)



enrich.result_LMO2TLX3Anot <- enrichPathway(gene = selGenes_LMO2TLX3Anot,
                               pvalueCutoff = 0.05,
                               readable = T,
                               organism = "human",
                               universe = geneUniverse_LMO2TLX3Anot)




enrich.result_LMOAnot <- enrichPathway(gene = selGenes_LMOAnot,
                               pvalueCutoff = 0.05,
                               readable = T,
                               organism = "human",
                               universe = geneUniverse_LMOAnot)
enrich.result_LMOBMAnot <- enrichPathway(gene = selGenes_LMOBMAnot,
                               pvalueCutoff = 0.05,
                               readable = T,
                               organism = "human",
                               universe = geneUniverse_LMOBMAnot)



enrich.result_LMOTAL1Anot <- enrichPathway(gene = selGenes_LMOTAL1Anot,
                               pvalueCutoff = 0.05,
                               readable = T,
                               organism = "human",
                               universe = geneUniverse_LMOTAL1Anot)


enrich.result_LMOTAL2Anot <- enrichPathway(gene = selGenes_LMOTAL2Anot,
                               pvalueCutoff = 0.05,
                               readable = T,
                               organism = "human",
                               universe = geneUniverse_LMOTAL2Anot)



enrich.result_LMOTAL2LMO1Anot <- enrichPathway(gene = selGenes_LMOTAL2LMO1Anot,
                               pvalueCutoff = 0.05,
                               readable = T,
                               organism = "human",
                               universe = geneUniverse_LMOTAL2LMO1Anot)



enrich.result_LMOTALAnot <- enrichPathway(gene = selGenes_LMOTALAnot,
                               pvalueCutoff = 0.05,
                               readable = T,
                               organism = "human",
                               universe = geneUniverse_LMOTALAnot)


enrich.result_LMOTLX1Anot <- enrichPathway(gene = selGenes_LMOTLX1Anot,
                               pvalueCutoff = 0.05,
                               readable = T,
                               organism = "human",
                               universe = geneUniverse_LMOTLX1Anot)

enrich.result_LMOTLX3Anot <- enrichPathway(gene = selGenes_LMOTLX3Anot,
                               pvalueCutoff = 0.05,
                               readable = T,
                               organism = "human",
                               universe = geneUniverse_LMOTLX3Anot)



enrich.result_MYBTAL1Anot <- enrichPathway(gene = selGenes_MYBTAL1Anot,
                               pvalueCutoff = 0.05,
                               readable = T,
                               organism = "human",
                               universe = geneUniverse_MYBTAL1Anot)


enrich.result_MYBTAL2Anot <- enrichPathway(gene = selGenes_MYBTAL2Anot,
                               pvalueCutoff = 0.05,
                               readable = T,
                               organism = "human",
                               universe = geneUniverse_MYBTAL2Anot)
enrich.result_MYBTAL2LMO1Anot <- enrichPathway(gene = selGenes_MYBTAL2LMO1Anot,
                               pvalueCutoff = 0.05,
                               readable = T,
                               organism = "human",
                               universe = geneUniverse_MYBTAL2LMO1Anot)



enrich.result_MYBTLX1Anot <- enrichPathway(gene = selGenes_MYBTLX1Anot,
                               pvalueCutoff = 0.05,
                               readable = T,
                               organism = "human",
                               universe = geneUniverse_MYBTLX1Anot)


enrich.result_MYBTLX3Anot <- enrichPathway(gene = selGenes_MYBTLX3Anot,
                               pvalueCutoff = 0.05,
                               readable = T,
                               organism = "human",
                               universe = geneUniverse_MYBTLX3Anot)
enrich.result_TAL1TAL2LMO1Anot <- enrichPathway(gene = selGenes_TAL1TAL2LMO1Anot,
                               pvalueCutoff = 0.05,
                               readable = T,
                               organism = "human",
                               universe = geneUniverse_TAL1TAL2LMO1Anot)



enrich.result_TAL1TLX1Anot <- enrichPathway(gene = selGenes_TAL1TLX1Anot,
                               pvalueCutoff = 0.05,
                               readable = T,
                               organism = "human",
                               universe = geneUniverse_TAL1TLX1Anot)


enrich.result_TAL1TLX3Anot <- enrichPathway(gene = selGenes_TAL1TLX3Anot,
                               pvalueCutoff = 0.05,
                               readable = T,
                               organism = "human",
                               universe = geneUniverse_TAL1TLX3Anot)



enrich.result_TAL2LMO1Anot <- enrichPathway(gene = selGenes_TAL2LMO1Anot,
                               pvalueCutoff = 0.05,
                               readable = T,
                               organism = "human",
                               universe = geneUniverse_TAL2LMO1Anot)



enrich.result_TAL2LMO1TLX1Anot <- enrichPathway(gene = selGenes_TAL2LMO1TLX1Anot,
                               pvalueCutoff = 0.05,
                               readable = T,
                               organism = "human",
                               universe = geneUniverse_TAL2LMO1TLX1Anot)


enrich.result_TAL2TAL2LMO1Anot <- enrichPathway(gene = selGenes_TAL2TAL2LMO1Anot,
                               pvalueCutoff = 0.05,
                               readable = T,
                               organism = "human",
                               universe = geneUniverse_TAL2TAL2LMO1Anot)

enrich.result_TAL2TLX1Anot <- enrichPathway(gene = selGenes_TAL2TLX1Anot,
                               pvalueCutoff = 0.05,
                               readable = T,
                               organism = "human",
                               universe = geneUniverse_TAL2TLX1Anot)


enrich.result_TAL2TLX3Anot <- enrichPathway(gene = selGenes_TAL2TLX3Anot,
                               pvalueCutoff = 0.05,
                               readable = T,
                               organism = "human",
                               universe = geneUniverse_TAL2TLX3Anot)


enrich.result_TALAnot <- enrichPathway(gene = selGenes_TALAnot,
                               pvalueCutoff = 0.05,
                               readable = T,
                               organism = "human",
                               universe = geneUniverse_TALAnot)

enrich.result_TALBMAnot <- enrichPathway(gene = selGenes_TALBMAnot,
                               pvalueCutoff = 0.05,
                               readable = T,
                               organism = "human",
                               universe = geneUniverse_TALBMAnot)



enrich.result_TALMYBAnot <- enrichPathway(gene = selGenes_TALMYBAnot,
                               pvalueCutoff = 0.05,
                               readable = T,
                               organism = "human",
                               universe = geneUniverse_TALMYBAnot)


enrich.result_TALTAL2LMO1Anot <- enrichPathway(gene = selGenes_TALTAL2LMO1Anot,
                               pvalueCutoff = 0.05,
                               readable = T,
                               organism = "human",
                               universe = geneUniverse_TALTAL2LMO1Anot)

enrich.result_TALTLX1Anot <- enrichPathway(gene = selGenes_TALTLX1Anot,
                               pvalueCutoff = 0.05,
                               readable = T,
                               organism = "human",
                               universe = geneUniverse_TALTLX1Anot)



enrich.result_TALTLX3Anot <- enrichPathway(gene = selGenes_TALTLX3Anot,
                               pvalueCutoff = 0.05,
                               readable = T,
                               organism = "human",
                               universe = geneUniverse_TALTLX3Anot)


enrich.result_TALTLXAnot <- enrichPathway(gene = selGenes_TALTLXAnot,
                               pvalueCutoff = 0.05,
                               readable = T,
                               organism = "human",
                               universe = geneUniverse_TALTLXAnot)


enrich.result_TALTLXLAnot <- enrichPathway(gene = selGenes_TALTLXLAnot,
                               pvalueCutoff = 0.05,
                               readable = T,
                               organism = "human",
                               universe = geneUniverse_TALTLXLAnot)



enrich.result_TLXAnot <- enrichPathway(gene = selGenes_TLXAnot,
                               pvalueCutoff = 0.05,
                               readable = T,
                               organism = "human",
                               universe = geneUniverse_TLXAnot)


enrich.result_TLXBMAnot <- enrichPathway(gene = selGenes_TLXBMAnot,
                               pvalueCutoff = 0.05,
                               readable = T,
                               organism = "human",
                               universe = geneUniverse_TLXBMAnot)


enrich.result_TLXMYBAnot <- enrichPathway(gene = selGenes_TLXMYBAnot,
                               pvalueCutoff = 0.05,
                               readable = T,
                               organism = "human",
                               universe = geneUniverse_TLXMYBAnot)


# topTab_GSE26713_TLXMYBAnot, topTab_GSE26713_TLXTAL1Anot, topTab_GSE26713_TLXTAL2Anot, topTab_GSE26713_TLXTAL2LMO1Anot

enrich.result_TLXTAL1Anot <- enrichPathway(gene = selGenes_TLXTAL1Anot,
                               pvalueCutoff = 0.05,
                               readable = T,
                               organism = "human",
                               universe = geneUniverse_TLXTAL1Anot)


enrich.result_TLXTAL2Anot <- enrichPathway(gene = selGenes_TLXTAL2Anot,
                               pvalueCutoff = 0.05,
                               readable = T,
                               organism = "human",
                               universe = geneUniverse_TLXTAL2Anot)


enrich.result_TLXTAL2LMO1Anot <- enrichPathway(gene = selGenes_TLXTAL2LMO1Anot,
                               pvalueCutoff = 0.05,
                               readable = T,
                               organism = "human",
                               universe = geneUniverse_TLXTAL2LMO1Anot)



```

topTab_GSE14618_GPL570_CFAnot, topTab_GSE14618_GPL570_CNRAnot, topTab_GSE14618_GPL570_FNRAnot



```{r, warning=TRUE, error=FALSE}

listOfTables <- list(BMHOXA = topTab_GSE26713_BMHOXAAnot,
                     BMLMO1 = topTab_GSE26713_BMLMO1Anot,
                     BMLMO2 = topTab_GSE26713_BMLMO2Anot,
                     BMMYB = topTab_GSE26713_BMMYBAnot,
                     BMTAL1 = topTab_GSE26713_BMTAL1Anot,
                     BMTAL2 = topTab_GSE26713_BMTAL2Anot,
                     BMTAL2LMO1 = topTab_GSE26713_BMTAL2LMO1Anot,
                     BMTLX1 = topTab_GSE26713_BMTLX1Anot,
                     BMTLX3 = topTab_GSE26713_BMTLX3Anot,
                     HOXALMO1 = topTab_GSE26713_HOXALMO1Anot,
                     HOXALMO2 = topTab_GSE26713_HOXALMO2Anot,
                     HOXATAL1 = topTab_GSE26713_HOXATAL1Anot,
                     HOXATAL2 = topTab_GSE26713_HOXATAL2Anot,
                     HOXATAL2LMO1 = topTab_GSE26713_HOXATAL2LMO1Anot,
                     HOXATLX1 = topTab_GSE26713_HOXATLX1Anot,
                     HOXATLX3 = topTab_GSE26713_HOXATLX3Anot,
                     LMO1LMO2MYB = topTab_GSE26713_LMO1LMO2MYBAnot,
                     LMO1MYB = topTab_GSE26713_LMO1MYBAnot,
                     LMO2TAL1 = topTab_GSE26713_LMO2TAL1Anot,
                     LMO2TAL2 = topTab_GSE26713_LMO2TAL2Anot,
                     LMO2TAL2LMO1 = topTab_GSE26713_LMO2TAL2LMO1Anot,
                     LMO2TLX1 = topTab_GSE26713_LMO2TLX1Anot,
                     LMO2TLX3 = topTab_GSE26713_LMO2TLX3Anot,
                     LMO = topTab_GSE26713_LMOAnot,
                     LMOBM = topTab_GSE26713_LMOBMAnot,
                     LMOTAL1 = topTab_GSE26713_LMOTAL1Anot,
                     LMOTAL2 = topTab_GSE26713_LMOTAL2Anot,
                     LMOTAL2LMO1 = topTab_GSE26713_LMOTAL2LMO1Anot,
                     LMOTAL = topTab_GSE26713_LMOTALAnot,
                     LMOTLX1 = topTab_GSE26713_LMOTLX1Anot,
                     LMOTLX3 = topTab_GSE26713_LMOTLX3Anot,
                     MYBTAL1 = topTab_GSE26713_MYBTAL1Anot,
                     MYBTAL2 = topTab_GSE26713_MYBTAL2Anot,
                     MYBTAL2LMO1 = topTab_GSE26713_MYBTAL2LMO1Anot,
                     MYBTLX1 = topTab_GSE26713_MYBTLX1Anot,
                     MYBTLX3 = topTab_GSE26713_MYBTLX3Anot,
                     TAL1TAL2LMO1 = topTab_GSE26713_TAL1TAL2LMO1Anot,
                     TAL1TLX1 = topTab_GSE26713_TAL1TLX1Anot,
                     TAL1TLX3 = topTab_GSE26713_TAL1TLX3Anot,
                     TAL2LMO1 = topTab_GSE26713_TAL2LMO1Anot,
                     TAL2LMO1TLX1 = topTab_GSE26713_TAL2LMO1TLX1Anot,
                     TAL2TAL2LMO1 = topTab_GSE26713_TAL2TAL2LMO1Anot,
                     TAL2TLX1 = topTab_GSE26713_TAL2TLX1Anot,
                     TAL2TLX3 = topTab_GSE26713_TAL2TLX3Anot,
                     TAL = topTab_GSE26713_TALAnot,
                     TALBM = topTab_GSE26713_TALBMAnot,
                     TALMYB = topTab_GSE26713_TALMYBAnot,
                     TALTAL2LMO1 = topTab_GSE26713_TALTAL2LMO1Anot,
                     TALTLX1 = topTab_GSE26713_TALTLX1Anot,
                     TALTLX3 = topTab_GSE26713_TALTLX3Anot,
                     TALTLX = topTab_GSE26713_TALTLXAnot,
                     TALTLXL = topTab_GSE26713_TALTLXLAnot,
                     TLX = topTab_GSE26713_TLXAnot,
                     TLXBM = topTab_GSE26713_TLXBMAnot,
                     TLXMYB = topTab_GSE26713_TLXMYBAnot,
                     TLXTAL1 = topTab_GSE26713_TLXTAL1Anot,
                     TLXTAL2 = topTab_GSE26713_TLXTAL2Anot,
                     TLXTAL2LMO1 = topTab_GSE26713_TLXTAL2LMO1Anot
)

listOfSelected <- list()



for (i in 1:length(listOfTables)){
  # select the toptable
  topTab <- listOfTables[[i]]
  # select the genes to be included in the analysis
  whichGenes<-topTab["P.Value"]<0.05
  selectedIDs <- rownames(topTab)[whichGenes]
  # convert the ID to Entrez
  EntrezIDs<- listOfTables[[i]]$ENTREZID
  listOfSelected[[i]] <- EntrezIDs
  names(listOfSelected)[i] <- names(listOfTables)[i]
}

```



```{r, warning=TRUE, error=FALSE}
ls(pattern="enrich")

listOfData <- listOfSelected

comparisonsNames <- names(listOfData)

universes <- list(geneUniverse_BMHOXAAnot, geneUniverse_BMLMO1Anot,
                  geneUniverse_BMLMO2Anot, geneUniverse_BMMYBAnot,
                   geneUniverse_BMTAL1Anot, geneUniverse_BMTAL2Anot,
                   geneUniverse_BMTAL2LMO1Anot,
                  geneUniverse_BMTLX1Anot, geneUniverse_BMTLX3Anot,
                   geneUniverse_HOXALMO1Anot, geneUniverse_HOXALMO2Anot, # 10
                   geneUniverse_HOXATAL1Anot, geneUniverse_HOXATAL2Anot,
                   geneUniverse_HOXATAL2LMO1Anot, geneUniverse_HOXATLX1Anot,
                   geneUniverse_HOXATLX3Anot, geneUniverse_LMO1LMO2MYBAnot,
                   geneUniverse_LMO1MYBAnot, geneUniverse_LMO2TAL1Anot,
                   geneUniverse_LMO2TAL2Anot, geneUniverse_LMO2TAL2LMO1Anot, #20
                   geneUniverse_LMO2TLX1Anot, geneUniverse_LMO2TLX3Anot,
                   geneUniverse_LMOAnot, geneUniverse_LMOBMAnot,
                   geneUniverse_LMOTAL1Anot, geneUniverse_LMOTAL2Anot,
                   geneUniverse_LMOTAL2LMO1Anot, geneUniverse_LMOTALAnot,
                   geneUniverse_LMOTLX1Anot, geneUniverse_LMOTLX3Anot, # 30
                   geneUniverse_MYBTAL1Anot, geneUniverse_MYBTAL2Anot,
                   geneUniverse_MYBTAL2LMO1Anot, geneUniverse_MYBTLX1Anot,
                   geneUniverse_MYBTLX3Anot, geneUniverse_TAL1TAL2LMO1Anot,
                   geneUniverse_TAL1TLX1Anot, geneUniverse_TAL1TLX3Anot,
                   geneUniverse_TAL2LMO1Anot, geneUniverse_TAL2LMO1TLX1Anot, # 40
                   geneUniverse_TAL2TAL2LMO1Anot, geneUniverse_TAL2TLX1Anot,
                   geneUniverse_TAL2TLX3Anot, geneUniverse_TALAnot,
                   geneUniverse_TALBMAnot, geneUniverse_TALMYBAnot,
                   geneUniverse_TALTAL2LMO1Anot, geneUniverse_TALTLX1Anot,
                   geneUniverse_TALTLX3Anot, geneUniverse_TALTLXAnot, # 50
                   geneUniverse_TALTLXLAnot, geneUniverse_TLXAnot,
                   geneUniverse_TLXBMAnot, geneUniverse_TLXMYBAnot,
                   geneUniverse_TLXTAL1Anot, geneUniverse_TLXTAL2Anot,
                   geneUniverse_TLXTAL2LMO1Anot)

table(universes[[1]] == geneUniverse_BMHOXAAnot)

enrich.results=list(enrich.result_BMHOXAAnot, enrich.result_BMLMO1Anot,
                    enrich.result_BMLMO2Anot,
                    enrich.result_BMMYBAnot, enrich.result_BMTAL1Anot,
                    enrich.result_BMTAL2Anot, enrich.result_BMTAL2LMO1Anot ,
                    enrich.result_BMTLX1Anot,
                    enrich.result_BMTLX3Anot,
                    enrich.result_HOXALMO1Anot,# 10
                    enrich.result_HOXALMO2Anot, 
                    enrich.result_HOXATAL1Anot, enrich.result_HOXATAL2Anot,
                    enrich.result_HOXATAL2LMO1Anot,
                    enrich.result_HOXATLX1Anot, enrich.result_HOXATLX3Anot,
                    enrich.result_LMO1LMO2MYBAnot, enrich.result_LMO1MYBAnot,
                    enrich.result_LMO2TAL1Anot,
                    enrich.result_LMO2TAL2Anot, enrich.result_LMO2TAL2LMO1Anot, # 20
                    enrich.result_LMO2TLX1Anot, enrich.result_LMO2TLX3Anot,
                    enrich.result_LMOAnot, enrich.result_LMOBMAnot,
                    enrich.result_LMOTAL1Anot, enrich.result_LMOTAL2Anot,
                    enrich.result_LMOTAL2LMO1Anot, enrich.result_LMOTALAnot,
                    enrich.result_LMOTLX1Anot, enrich.result_LMOTLX3Anot, #30
                    enrich.result_MYBTAL1Anot, enrich.result_MYBTAL2Anot,
                    enrich.result_MYBTAL2LMO1Anot, enrich.result_MYBTLX1Anot,
                    enrich.result_MYBTLX3Anot, enrich.result_TAL1TAL2LMO1Anot,
                    enrich.result_TAL1TLX1Anot, enrich.result_TAL1TLX3Anot,
                    enrich.result_TAL2LMO1Anot, enrich.result_TAL2LMO1TLX1Anot, # 40
                    enrich.result_TAL2TAL2LMO1Anot, enrich.result_TAL2TLX1Anot,
                    enrich.result_TAL2TLX3Anot, enrich.result_TALAnot,
                    enrich.result_TALBMAnot, enrich.result_TALMYBAnot,
                    enrich.result_TALTAL2LMO1Anot, enrich.result_TALTLX1Anot,
                    enrich.result_TALTLX3Anot, enrich.result_TALTLXAnot, # 50
                    enrich.result_TALTLXLAnot, enrich.result_TLXAnot,
                    enrich.result_TLXBMAnot, enrich.result_TLXMYBAnot,
                    enrich.result_TLXTAL1Anot, enrich.result_TLXTAL2Anot,
                    enrich.result_TLXTAL2LMO1Anot)


```



```{r, warning=TRUE, error=FALSE}

for (i in 1:length(listOfData)){
  universe<-universes[[i]]
  enrich.result<-enrich.results[[i]]
  genesIn <- listOfData[[i]]
  comparison <- comparisonsNames[i]
  enrich.r <- enrich.result
  cat("##################################")
  cat("\nComparison: ", comparison,"\n")
  print(head(enrich.r))
}





```

Están mal el número 10, 13, 18, 19, 20, 24, 29, 32, 33, 40, 41, 42, 43 y 44.

```{r, warning=TRUE, error=FALSE}
enrich.result<-enrich.results[[1]]
enrich.r <- enrich.result

barplot(enrich.r, showCategory = 15, font.size = 4,
title = paste0("Reactome Pathway Analysis for ", comparison,". Barplot"))

cnetplot(enrich.r, categorySize = "geneNum", schowCategory = 15, vertex.label.cex = 0.75)


enrich.result<-enrich.results[[2]]
enrich.r <- enrich.result

barplot(enrich.r, showCategory = 15, font.size = 4,
title = paste0("Reactome Pathway Analysis for ", comparison,". Barplot"))

cnetplot(enrich.r, categorySize = "geneNum", schowCategory = 15, vertex.label.cex = 0.75)

enrich.result<-enrich.results[[3]]
enrich.r <- enrich.result

barplot(enrich.r, showCategory = 15, font.size = 4,
title = paste0("Reactome Pathway Analysis for ", comparison,". Barplot"))

cnetplot(enrich.r, categorySize = "geneNum", schowCategory = 15, vertex.label.cex = 0.75)


enrich.result<-enrich.results[[4]]
enrich.r <- enrich.result

barplot(enrich.r, showCategory = 15, font.size = 4,
title = paste0("Reactome Pathway Analysis for ", comparison,". Barplot"))

cnetplot(enrich.r, categorySize = "geneNum", schowCategory = 15, vertex.label.cex = 0.75)


enrich.result<-enrich.results[[5]]
enrich.r <- enrich.result

barplot(enrich.r, showCategory = 15, font.size = 4,
title = paste0("Reactome Pathway Analysis for ", comparison,". Barplot"))

cnetplot(enrich.r, categorySize = "geneNum", schowCategory = 15, vertex.label.cex = 0.75)


enrich.result<-enrich.results[[6]]
enrich.r <- enrich.result

barplot(enrich.r, showCategory = 15, font.size = 4,
title = paste0("Reactome Pathway Analysis for ", comparison,". Barplot"))

cnetplot(enrich.r, categorySize = "geneNum", schowCategory = 15, vertex.label.cex = 0.75)

enrich.result<-enrich.results[[7]]
enrich.r <- enrich.result

barplot(enrich.r, showCategory = 15, font.size = 4,
title = paste0("Reactome Pathway Analysis for ", comparison,". Barplot"))

cnetplot(enrich.r, categorySize = "geneNum", schowCategory = 15, vertex.label.cex = 0.75)


enrich.result<-enrich.results[[8]]
enrich.r <- enrich.result

barplot(enrich.r, showCategory = 15, font.size = 4,
title = paste0("Reactome Pathway Analysis for ", comparison,". Barplot"))

cnetplot(enrich.r, categorySize = "geneNum", schowCategory = 15, vertex.label.cex = 0.75)


enrich.result<-enrich.results[[9]]
enrich.r <- enrich.result

barplot(enrich.r, showCategory = 15, font.size = 4,
title = paste0("Reactome Pathway Analysis for ", comparison,". Barplot"))

cnetplot(enrich.r, categorySize = "geneNum", schowCategory = 15, vertex.label.cex = 0.75)


enrich.result<-enrich.results[[11]]
enrich.r <- enrich.result

barplot(enrich.r, showCategory = 15, font.size = 4,
title = paste0("Reactome Pathway Analysis for ", comparison,". Barplot"))

cnetplot(enrich.r, categorySize = "geneNum", schowCategory = 15, vertex.label.cex = 0.75)

enrich.result<-enrich.results[[12]]
enrich.r <- enrich.result

barplot(enrich.r, showCategory = 15, font.size = 4,
title = paste0("Reactome Pathway Analysis for ", comparison,". Barplot"))

cnetplot(enrich.r, categorySize = "geneNum", schowCategory = 15, vertex.label.cex = 0.75)


enrich.result<-enrich.results[[13]]
enrich.r <- enrich.result

barplot(enrich.r, showCategory = 15, font.size = 4,
title = paste0("Reactome Pathway Analysis for ", comparison,". Barplot"))

cnetplot(enrich.r, categorySize = "geneNum", schowCategory = 15, vertex.label.cex = 0.75)

enrich.result<-enrich.results[[14]]
enrich.r <- enrich.result

barplot(enrich.r, showCategory = 15, font.size = 4,
title = paste0("Reactome Pathway Analysis for ", comparison,". Barplot"))

cnetplot(enrich.r, categorySize = "geneNum", schowCategory = 15, vertex.label.cex = 0.75)


enrich.result<-enrich.results[[15]]
enrich.r <- enrich.result

barplot(enrich.r, showCategory = 15, font.size = 4,
title = paste0("Reactome Pathway Analysis for ", comparison,". Barplot"))

cnetplot(enrich.r, categorySize = "geneNum", schowCategory = 15, vertex.label.cex = 0.75)

enrich.result<-enrich.results[[16]]
enrich.r <- enrich.result

barplot(enrich.r, showCategory = 15, font.size = 4,
title = paste0("Reactome Pathway Analysis for ", comparison,". Barplot"))

cnetplot(enrich.r, categorySize = "geneNum", schowCategory = 15, vertex.label.cex = 0.75)


enrich.result<-enrich.results[[17]]
enrich.r <- enrich.result

barplot(enrich.r, showCategory = 15, font.size = 4,
title = paste0("Reactome Pathway Analysis for ", comparison,". Barplot"))

cnetplot(enrich.r, categorySize = "geneNum", schowCategory = 15, vertex.label.cex = 0.75)


enrich.result<-enrich.results[[18]]
enrich.r <- enrich.result

barplot(enrich.r, showCategory = 15, font.size = 4,
title = paste0("Reactome Pathway Analysis for ", comparison,". Barplot"))

cnetplot(enrich.r, categorySize = "geneNum", schowCategory = 15, vertex.label.cex = 0.75)


enrich.result<-enrich.results[[21]]
enrich.r <- enrich.result

barplot(enrich.r, showCategory = 15, font.size = 4,
title = paste0("Reactome Pathway Analysis for ", comparison,". Barplot"))

cnetplot(enrich.r, categorySize = "geneNum", schowCategory = 15, vertex.label.cex = 0.75)




```

```{r, warning=TRUE, error=TRUE}
enrich.result<-enrich.results[[1]]
enrich.r <- enrich.result
Path<-enrich.r@result[["ID"]]
Biological_Description<-enrich.r@result[["Description"]]
Gene<-enrich.r@result[["geneID"]]
GSE26713_BMHOXA <-data.frame(Path, Biological_Description, Gene)



enrich.result<-enrich.results[[2]]
enrich.r <- enrich.result
Path<-enrich.r@result[["ID"]]
Biological_Description<-enrich.r@result[["Description"]]
Gene<-enrich.r@result[["geneID"]]
GSE26713_BMLMO1<-data.frame(Path, Biological_Description, Gene)

enrich.result<-enrich.results[[3]]
enrich.r <- enrich.result
Path<-enrich.r@result[["ID"]]
Biological_Description<-enrich.r@result[["Description"]]
Gene<-enrich.r@result[["geneID"]]
GSE26713_BMLMO2<-data.frame(Path, Biological_Description, Gene)


enrich.result<-enrich.results[[4]]
enrich.r <- enrich.result
Path<-enrich.r@result[["ID"]]
Biological_Description<-enrich.r@result[["Description"]]
Gene<-enrich.r@result[["geneID"]]
GSE26713_BMMYB<-data.frame(Path, Biological_Description, Gene)


enrich.result<-enrich.results[[5]]
enrich.r <- enrich.result
Path<-enrich.r@result[["ID"]]
Biological_Description<-enrich.r@result[["Description"]]
Gene<-enrich.r@result[["geneID"]]
GSE26713_BMTAL1<-data.frame(Path, Biological_Description, Gene)


enrich.result<-enrich.results[[6]]
enrich.r <- enrich.result
Path<-enrich.r@result[["ID"]]
Biological_Description<-enrich.r@result[["Description"]]
Gene<-enrich.r@result[["geneID"]]
GSE26713_BMTAL2<-data.frame(Path, Biological_Description, Gene)


enrich.result<-enrich.results[[7]]
enrich.r <- enrich.result
Path<-enrich.r@result[["ID"]]
Biological_Description<-enrich.r@result[["Description"]]
Gene<-enrich.r@result[["geneID"]]
GSE26713_BMTAL2LMO1<-data.frame(Path, Biological_Description, Gene)


enrich.result<-enrich.results[[8]]
enrich.r <- enrich.result
Path<-enrich.r@result[["ID"]]
Biological_Description<-enrich.r@result[["Description"]]
Gene<-enrich.r@result[["geneID"]]
GSE26713_BMTLX1<-data.frame(Path, Biological_Description, Gene)

enrich.result<-enrich.results[[9]]
enrich.r <- enrich.result
Path<-enrich.r@result[["ID"]]
Biological_Description<-enrich.r@result[["Description"]]
Gene<-enrich.r@result[["geneID"]]
GSE26713_BMTLX3<-data.frame(Path, Biological_Description, Gene)



enrich.result<-enrich.results[[11]]
enrich.r <- enrich.result
Path<-enrich.r@result[["ID"]]
Biological_Description<-enrich.r@result[["Description"]]
Gene<-enrich.r@result[["geneID"]]
GSE26713_HOXALMO2<-data.frame(Path, Biological_Description, Gene)

enrich.result<-enrich.results[[12]]
enrich.r <- enrich.result
Path<-enrich.r@result[["ID"]]
Biological_Description<-enrich.r@result[["Description"]]
Gene<-enrich.r@result[["geneID"]]
GSE26713_HOXATAL1<-data.frame(Path, Biological_Description, Gene)



enrich.result<-enrich.results[[14]]
enrich.r <- enrich.result
Path<-enrich.r@result[["ID"]]
Biological_Description<-enrich.r@result[["Description"]]
Gene<-enrich.r@result[["geneID"]]
GSE26713_HOXATAL2LMO1 <-data.frame(Path, Biological_Description, Gene)


enrich.result<-enrich.results[[15]]
enrich.r <- enrich.result
Path<-enrich.r@result[["ID"]]
Biological_Description<-enrich.r@result[["Description"]]
Gene<-enrich.r@result[["geneID"]]
GSE26713_HOXATLX1<-data.frame(Path, Biological_Description, Gene)



enrich.result<-enrich.results[[16]]
enrich.r <- enrich.result
Path<-enrich.r@result[["ID"]]
Biological_Description<-enrich.r@result[["Description"]]
Gene<-enrich.r@result[["geneID"]]
GSE26713_HOXATLX3<-data.frame(Path, Biological_Description, Gene)


enrich.result<-enrich.results[[17]]
enrich.r <- enrich.result
Path<-enrich.r@result[["ID"]]
Biological_Description<-enrich.r@result[["Description"]]
Gene<-enrich.r@result[["geneID"]]
GSE26713_LMO1LMO2MYB<-data.frame(Path, Biological_Description, Gene)




enrich.result<-enrich.results[[21]]
enrich.r <- enrich.result
Path<-enrich.r@result[["ID"]]
Biological_Description<-enrich.r@result[["Description"]]
Gene<-enrich.r@result[["geneID"]]
GSE26713_LMO2TAL2LMO1<-data.frame(Path, Biological_Description, Gene)


enrich.result<-enrich.results[[22]]
enrich.r <- enrich.result
Path<-enrich.r@result[["ID"]]
Biological_Description<-enrich.r@result[["Description"]]
Gene<-enrich.r@result[["geneID"]]
GSE26713_LMO2TLX1<-data.frame(Path, Biological_Description, Gene)

enrich.result<-enrich.results[[23]]
enrich.r <- enrich.result
Path<-enrich.r@result[["ID"]]
Biological_Description<-enrich.r@result[["Description"]]
Gene<-enrich.r@result[["geneID"]]
GSE26713_LMO2TLX3<-data.frame(Path, Biological_Description, Gene)


enrich.result<-enrich.results[[25]]
enrich.r <- enrich.result
Path<-enrich.r@result[["ID"]]
Biological_Description<-enrich.r@result[["Description"]]
Gene<-enrich.r@result[["geneID"]]
GSE26713_LMOBM<-data.frame(Path, Biological_Description, Gene)


enrich.result<-enrich.results[[26]]
enrich.r <- enrich.result
Path<-enrich.r@result[["ID"]]
Biological_Description<-enrich.r@result[["Description"]]
Gene<-enrich.r@result[["geneID"]]
GSE26713_LMOTAL1<-data.frame(Path, Biological_Description, Gene)


enrich.result<-enrich.results[[27]]
enrich.r <- enrich.result
Path<-enrich.r@result[["ID"]]
Biological_Description<-enrich.r@result[["Description"]]
Gene<-enrich.r@result[["geneID"]]
GSE26713_LMOTAL2<-data.frame(Path, Biological_Description, Gene)


enrich.result<-enrich.results[[28]]
enrich.r <- enrich.result
Path<-enrich.r@result[["ID"]]
Biological_Description<-enrich.r@result[["Description"]]
Gene<-enrich.r@result[["geneID"]]
GSE26713_LMOTAL2LMO1<-data.frame(Path, Biological_Description, Gene)





enrich.result<-enrich.results[[30]]
enrich.r <- enrich.result
Path<-enrich.r@result[["ID"]]
Biological_Description<-enrich.r@result[["Description"]]
Gene<-enrich.r@result[["geneID"]]
GSE26713_LMOTLX1<-data.frame(Path, Biological_Description, Gene)


enrich.result<-enrich.results[[31]]
enrich.r <- enrich.result
Path<-enrich.r@result[["ID"]]
Biological_Description<-enrich.r@result[["Description"]]
Gene<-enrich.r@result[["geneID"]]
GSE26713_LMOTLX3<-data.frame(Path, Biological_Description, Gene)



enrich.result<-enrich.results[[35]]
enrich.r <- enrich.result
Path<-enrich.r@result[["ID"]]
Biological_Description<-enrich.r@result[["Description"]]
Gene<-enrich.r@result[["geneID"]]
GSE26713_MYBTLX1<-data.frame(Path, Biological_Description, Gene)


enrich.result<-enrich.results[[36]]
enrich.r <- enrich.result
Path<-enrich.r@result[["ID"]]
Biological_Description<-enrich.r@result[["Description"]]
Gene<-enrich.r@result[["geneID"]]
GSE26713_MYBTLX3<-data.frame(Path, Biological_Description, Gene)


enrich.result<-enrich.results[[37]]
enrich.r <- enrich.result
Path<-enrich.r@result[["ID"]]
Biological_Description<-enrich.r@result[["Description"]]
Gene<-enrich.r@result[["geneID"]]
GSE26713_TAL1TAL2LMO1<-data.frame(Path, Biological_Description, Gene)


enrich.result<-enrich.results[[38]]
enrich.r <- enrich.result
Path<-enrich.r@result[["ID"]]
Biological_Description<-enrich.r@result[["Description"]]
Gene<-enrich.r@result[["geneID"]]
GSE26713_TAL1TLX1<-data.frame(Path, Biological_Description, Gene)


enrich.result<-enrich.results[[39]]
enrich.r <- enrich.result
Path<-enrich.r@result[["ID"]]
Biological_Description<-enrich.r@result[["Description"]]
Gene<-enrich.r@result[["geneID"]]
GSE26713_TAL1TLX3<-data.frame(Path, Biological_Description, Gene)





enrich.result<-enrich.results[[40]]
enrich.r <- enrich.result
Path<-enrich.r@result[["ID"]]
Biological_Description<-enrich.r@result[["Description"]]
Gene<-enrich.r@result[["geneID"]]
GSE26713_TAL2LMO1<-data.frame(Path, Biological_Description, Gene)


enrich.result<-enrich.results[[46]]
enrich.r <- enrich.result
Path<-enrich.r@result[["ID"]]
Biological_Description<-enrich.r@result[["Description"]]
Gene<-enrich.r@result[["geneID"]]
GSE26713_TALBM<-data.frame(Path, Biological_Description, Gene)



enrich.result<-enrich.results[[47]]
enrich.r <- enrich.result
Path<-enrich.r@result[["ID"]]
Biological_Description<-enrich.r@result[["Description"]]
Gene<-enrich.r@result[["geneID"]]
GSE26713_TALMYB<-data.frame(Path, Biological_Description, Gene)


enrich.result<-enrich.results[[48]]
enrich.r <- enrich.result
Path<-enrich.r@result[["ID"]]
Biological_Description<-enrich.r@result[["Description"]]
Gene<-enrich.r@result[["geneID"]]
GSE26713_TALTAL2LMO1<-data.frame(Path, Biological_Description, Gene)



enrich.result<-enrich.results[[49]]
enrich.r <- enrich.result
Path<-enrich.r@result[["ID"]]
Biological_Description<-enrich.r@result[["Description"]]
Gene<-enrich.r@result[["geneID"]]
GSE26713_TALTLX1<-data.frame(Path, Biological_Description, Gene)


enrich.result<-enrich.results[[50]]
enrich.r <- enrich.result
Path<-enrich.r@result[["ID"]]
Biological_Description<-enrich.r@result[["Description"]]
Gene<-enrich.r@result[["geneID"]]
GSE26713_TALTLX3<-data.frame(Path, Biological_Description, Gene)


enrich.result<-enrich.results[[51]]
enrich.r <- enrich.result
Path<-enrich.r@result[["ID"]]
Biological_Description<-enrich.r@result[["Description"]]
Gene<-enrich.r@result[["geneID"]]
GSE26713_TALTLX<-data.frame(Path, Biological_Description, Gene)

enrich.result<-enrich.results[[52]]
enrich.r <- enrich.result
Path<-enrich.r@result[["ID"]]
Biological_Description<-enrich.r@result[["Description"]]
Gene<-enrich.r@result[["geneID"]]
GSE26713_TALTLXL<-data.frame(Path, Biological_Description, Gene)


enrich.result<-enrich.results[[53]]
enrich.r <- enrich.result
Path<-enrich.r@result[["ID"]]
Biological_Description<-enrich.r@result[["Description"]]
Gene<-enrich.r@result[["geneID"]]
GSE26713_TLX<-data.frame(Path, Biological_Description, Gene)

enrich.result<-enrich.results[[54]]
enrich.r <- enrich.result
Path<-enrich.r@result[["ID"]]
Biological_Description<-enrich.r@result[["Description"]]
Gene<-enrich.r@result[["geneID"]]
GSE26713_TLXBM<-data.frame(Path, Biological_Description, Gene)


enrich.result<-enrich.results[[55]]
enrich.r <- enrich.result
Path<-enrich.r@result[["ID"]]
Biological_Description<-enrich.r@result[["Description"]]
Gene<-enrich.r@result[["geneID"]]
GSE26713_TLXMYB<-data.frame(Path, Biological_Description, Gene)


enrich.result<-enrich.results[[56]]
enrich.r <- enrich.result
Path<-enrich.r@result[["ID"]]
Biological_Description<-enrich.r@result[["Description"]]
Gene<-enrich.r@result[["geneID"]]
GSE26713_TLXTAL1<-data.frame(Path, Biological_Description, Gene)


enrich.result<-enrich.results[[57]]
enrich.r <- enrich.result
Path<-enrich.r@result[["ID"]]
Biological_Description<-enrich.r@result[["Description"]]
Gene<-enrich.r@result[["geneID"]]
GSE26713_TLXTAL2<-data.frame(Path, Biological_Description, Gene)


enrich.result<-enrich.results[[58]]
enrich.r <- enrich.result
Path<-enrich.r@result[["ID"]]
Biological_Description<-enrich.r@result[["Description"]]
Gene<-enrich.r@result[["geneID"]]
GSE26713_TLXTAL2LMO1<-data.frame(Path, Biological_Description, Gene)



# TALTAL2LMO1, TALTLX1 ,TALTLX3, TALTLX, TLX, TLXBM ,TLXMYB, TLXTAL1, TLXTAL2, TLXTAL2LMO1
```

```{r, warning=TRUE, error=FALSE}

library("xlsx")
write.xlsx(GSE26713_BMHOXA,
           'C:/Users/Copito/OneDrive/Documentos/Master bioinf y bioest/TFM/datasets/GSE26713/Resultado_BMHOXA.xlsx', row.names = FALSE,
           col.names = TRUE)

write.xlsx(GSE26713_BMLMO1,
           'C:/Users/Copito/OneDrive/Documentos/Master bioinf y bioest/TFM/datasets/GSE26713/Resultado_BMLMO1.xlsx', row.names = FALSE,
           col.names = TRUE)

write.xlsx(GSE26713_BMLMO2,
           'C:/Users/Copito/OneDrive/Documentos/Master bioinf y bioest/TFM/datasets/GSE26713/Resultado_BMLMO2.xlsx', row.names = FALSE,
           col.names = TRUE)

write.xlsx(GSE26713_BMMYB,
           'C:/Users/Copito/OneDrive/Documentos/Master bioinf y bioest/TFM/datasets/GSE26713/Resultado_BMMYB.xlsx', row.names = FALSE,
           col.names = TRUE)



write.xlsx(GSE26713_BMTAL1,
           'C:/Users/Copito/OneDrive/Documentos/Master bioinf y bioest/TFM/datasets/GSE26713/Resultado_BMTAL1.xlsx', row.names = FALSE,
           col.names = TRUE)

write.xlsx(GSE26713_BMTAL2,
           'C:/Users/Copito/OneDrive/Documentos/Master bioinf y bioest/TFM/datasets/GSE26713/Resultado_BMTAL2.xlsx', row.names = FALSE,
           col.names = TRUE)

write.xlsx(GSE26713_BMTAL2LMO1,
           'C:/Users/Copito/OneDrive/Documentos/Master bioinf y bioest/TFM/datasets/GSE26713/Resultado_BMTAL2LMO1.xlsx', row.names = FALSE,
           col.names = TRUE)

write.xlsx(GSE26713_BMTLX1,
           'C:/Users/Copito/OneDrive/Documentos/Master bioinf y bioest/TFM/datasets/GSE26713/Resultado_BMTLX1.xlsx', row.names = FALSE,
           col.names = TRUE)
write.xlsx(GSE26713_BMTLX3,
           'C:/Users/Copito/OneDrive/Documentos/Master bioinf y bioest/TFM/datasets/GSE26713/Resultado_BMTLX3.xlsx', row.names = FALSE,
           col.names = TRUE)
write.xlsx(GSE26713_HOXALMO2,
           'C:/Users/Copito/OneDrive/Documentos/Master bioinf y bioest/TFM/datasets/GSE26713/Resultado_HOXALMO2.xlsx', row.names = FALSE,
           col.names = TRUE)
write.xlsx(GSE26713_HOXATAL1,
           'C:/Users/Copito/OneDrive/Documentos/Master bioinf y bioest/TFM/datasets/GSE26713/Resultado_HOXATAL1.xlsx', row.names = FALSE,
           col.names = TRUE)
write.xlsx(GSE26713_HOXATAL2LMO1,
           'C:/Users/Copito/OneDrive/Documentos/Master bioinf y bioest/TFM/datasets/GSE26713/Resultado_HOXATAL2LMO1.xlsx', row.names = FALSE,
           col.names = TRUE)

write.xlsx(GSE26713_HOXATLX1,
           'C:/Users/Copito/OneDrive/Documentos/Master bioinf y bioest/TFM/datasets/GSE26713/Resultado_HOXATLX1.xlsx', row.names = FALSE,
           col.names = TRUE)

write.xlsx(GSE26713_HOXATLX3,
           'C:/Users/Copito/OneDrive/Documentos/Master bioinf y bioest/TFM/datasets/GSE26713/Resultado_HOXATLX3.xlsx', row.names = FALSE,
           col.names = TRUE)

write.xlsx(GSE26713_LMO1LMO2MYB,
           'C:/Users/Copito/OneDrive/Documentos/Master bioinf y bioest/TFM/datasets/GSE26713/Resultado_LMO1LMO2MYB.xlsx', row.names = FALSE,
           col.names = TRUE)

write.xlsx(GSE26713_LMO2TAL2LMO1,
           'C:/Users/Copito/OneDrive/Documentos/Master bioinf y bioest/TFM/datasets/GSE26713/Resultado_LMO2TAL2LMO1.xlsx', row.names = FALSE,
           col.names = TRUE)
write.xlsx(GSE26713_LMO2TLX1,
           'C:/Users/Copito/OneDrive/Documentos/Master bioinf y bioest/TFM/datasets/GSE26713/Resultado_LMO2TLX1.xlsx', row.names = FALSE,
           col.names = TRUE)
write.xlsx(GSE26713_LMO2TLX3,
           'C:/Users/Copito/OneDrive/Documentos/Master bioinf y bioest/TFM/datasets/GSE26713/Resultado_LMO2TLX3.xlsx', row.names = FALSE,
           col.names = TRUE)
write.xlsx(GSE26713_LMOBM,
           'C:/Users/Copito/OneDrive/Documentos/Master bioinf y bioest/TFM/datasets/GSE26713/Resultado_LMOBM.xlsx', row.names = FALSE,
           col.names = TRUE)
write.xlsx(GSE26713_LMOTAL1,
           'C:/Users/Copito/OneDrive/Documentos/Master bioinf y bioest/TFM/datasets/GSE26713/Resultado_LMOTAL1.xlsx', row.names = FALSE,
           col.names = TRUE)

write.xlsx(GSE26713_LMOTAL,
           'C:/Users/Copito/OneDrive/Documentos/Master bioinf y bioest/TFM/datasets/GSE26713/Resultado_LMOTAL.xlsx', row.names = FALSE,
           col.names = TRUE)

write.xlsx(GSE26713_LMOTAL2,
           'C:/Users/Copito/OneDrive/Documentos/Master bioinf y bioest/TFM/datasets/GSE26713/Resultado_LMOTAL2.xlsx', row.names = FALSE,
           col.names = TRUE)

write.xlsx(GSE26713_LMOTAL2LMO1,
           'C:/Users/Copito/OneDrive/Documentos/Master bioinf y bioest/TFM/datasets/GSE26713/Resultado_LMOTAL2LMO1.xlsx', row.names = FALSE,
           col.names = TRUE)

write.xlsx(GSE26713_LMOTLX1,
           'C:/Users/Copito/OneDrive/Documentos/Master bioinf y bioest/TFM/datasets/GSE26713/Resultado_LMOTLX1.xlsx', row.names = FALSE,
           col.names = TRUE)

write.xlsx(GSE26713_LMOTLX3,
           'C:/Users/Copito/OneDrive/Documentos/Master bioinf y bioest/TFM/datasets/GSE26713/Resultado_LMOTLX3.xlsx', row.names = FALSE,
           col.names = TRUE)
write.xlsx(GSE26713_MYBTAL2,
           'C:/Users/Copito/OneDrive/Documentos/Master bioinf y bioest/TFM/datasets/GSE26713/Resultado_MYBTAL2.xlsx', row.names = FALSE,
           col.names = TRUE)
write.xlsx(GSE26713_MYBTLX1,
           'C:/Users/Copito/OneDrive/Documentos/Master bioinf y bioest/TFM/datasets/GSE26713/Resultado_MYBTLX1.xlsx', row.names = FALSE,
           col.names = TRUE)
write.xlsx(GSE26713_MYBTLX3,
           'C:/Users/Copito/OneDrive/Documentos/Master bioinf y bioest/TFM/datasets/GSE26713/Resultado_MYBTLX3.xlsx', row.names = FALSE,
           col.names = TRUE)
write.xlsx(GSE26713_TAL1TAL2LMO1,
           'C:/Users/Copito/OneDrive/Documentos/Master bioinf y bioest/TFM/datasets/GSE26713/Resultado_TAL1TAL2LMO1.xlsx', row.names = FALSE,
           col.names = TRUE)


write.xlsx(GSE26713_TAL1TLX1,
           'C:/Users/Copito/OneDrive/Documentos/Master bioinf y bioest/TFM/datasets/GSE26713/Resultado_TAL1TLX1.xlsx', row.names = FALSE,
           col.names = TRUE)

write.xlsx(GSE26713_TAL1TLX3,
           'C:/Users/Copito/OneDrive/Documentos/Master bioinf y bioest/TFM/datasets/GSE26713/Resultado_TAL1TLX3.xlsx', row.names = FALSE,
           col.names = TRUE)

write.xlsx(GSE26713_TAL2LMO1,
           'C:/Users/Copito/OneDrive/Documentos/Master bioinf y bioest/TFM/datasets/GSE26713/Resultado_TAL2LMO1.xlsx', row.names = FALSE,
           col.names = TRUE)

write.xlsx(GSE26713_TALBM,
           'C:/Users/Copito/OneDrive/Documentos/Master bioinf y bioest/TFM/datasets/GSE26713/Resultado_TALBM.xlsx', row.names = FALSE,
           col.names = TRUE)
write.xlsx(GSE26713_TALMYB,
           'C:/Users/Copito/OneDrive/Documentos/Master bioinf y bioest/TFM/datasets/GSE26713/Resultado_TALMYB.xlsx', row.names = FALSE,
           col.names = TRUE)
write.xlsx(GSE26713_TALTAL2LMO1,
           'C:/Users/Copito/OneDrive/Documentos/Master bioinf y bioest/TFM/datasets/GSE26713/Resultado_TALTAL2LMO1.xlsx', row.names = FALSE,
           col.names = TRUE)
write.xlsx(GSE26713_TALTLX,
           'C:/Users/Copito/OneDrive/Documentos/Master bioinf y bioest/TFM/datasets/GSE26713/Resultado_TALTLX.xlsx', row.names = FALSE,
           col.names = TRUE)
write.xlsx(GSE26713_TALTLX1,
           'C:/Users/Copito/OneDrive/Documentos/Master bioinf y bioest/TFM/datasets/GSE26713/Resultado_TALTLX1.xlsx', row.names = FALSE,
           col.names = TRUE)

 

write.xlsx(GSE26713_TALTLX3,
           'C:/Users/Copito/OneDrive/Documentos/Master bioinf y bioest/TFM/datasets/GSE26713/Resultado_TALTLX3.xlsx', row.names = FALSE,
           col.names = TRUE)
write.xlsx(GSE26713_TALTLXL,
           'C:/Users/Copito/OneDrive/Documentos/Master bioinf y bioest/TFM/datasets/GSE26713/Resultado_TALTLXL.xlsx', row.names = FALSE,
           col.names = TRUE)
write.xlsx(GSE26713_TLX,
           'C:/Users/Copito/OneDrive/Documentos/Master bioinf y bioest/TFM/datasets/GSE26713/Resultado_TLX.xlsx', row.names = FALSE,
           col.names = TRUE)


write.xlsx(GSE26713_TLXBM,
           'C:/Users/Copito/OneDrive/Documentos/Master bioinf y bioest/TFM/datasets/GSE26713/Resultado_TLXBM.xlsx', row.names = FALSE,
           col.names = TRUE)
write.xlsx(GSE26713_TLXMYB,
           'C:/Users/Copito/OneDrive/Documentos/Master bioinf y bioest/TFM/datasets/GSE26713/Resultado_TLXMYB.xlsx', row.names = FALSE,
           col.names = TRUE)
write.xlsx(GSE26713_TLXTAL1,
           'C:/Users/Copito/OneDrive/Documentos/Master bioinf y bioest/TFM/datasets/GSE26713/Resultado_TLXTAL1.xlsx', row.names = FALSE,
           col.names = TRUE)


write.xlsx(GSE26713_TLXTAL2,
           'C:/Users/Copito/OneDrive/Documentos/Master bioinf y bioest/TFM/datasets/GSE26713/Resultado_TLXTAL2.xlsx', row.names = FALSE,
           col.names = TRUE)
write.xlsx(GSE26713_TLXTAL2LMO1,
           'C:/Users/Copito/OneDrive/Documentos/Master bioinf y bioest/TFM/datasets/GSE26713/Resultado_TLXTAL2LMO1.xlsx', row.names = FALSE,
           col.names = TRUE)




#save(GSE26713_BMHOXA, GSE26713_BMLMO1, GSE26713_BMLMO2, GSE26713_BMMYB, GSE26713_BMTAL1, GSE26713_BMTAL2, GSE26713_BMTAL2LMO1, GSE26713_BMTLX1, GSE26713_BMTLX3, GSE26713_HOXALMO2, GSE26713_HOXATAL1, GSE26713_HOXATAL2LMO1, GSE26713_HOXATLX1, GSE26713_HOXATLX3, GSE26713_LMO1LMO2MYB, GSE26713_LMO2TAL2LMO1, GSE26713_LMO2TLX1, GSE26713_LMO2TLX3, GSE26713_LMOBM, GSE26713_LMOTAL1, GSE26713_LMOTAL2, GSE26713_LMOTAL2LMO1, GSE26713_LMOTLX1, GSE26713_LMOTLX3, GSE26713_MYBTAL2, GSE26713_MYBTLX1, GSE26713_MYBTLX3, GSE26713_TAL1TAL2LMO1, GSE26713_TAL1TLX1, GSE26713_TAL1TLX3, GSE26713_TAL2LMO1, GSE26713_TALBM, GSE26713_TALMYB, GSE26713_TALTAL2LMO1, GSE26713_TALTLX, GSE26713_TALTLX1, GSE26713_TALTLX3, GSE26713_TALTLXL, GSE26713_TLX, GSE26713_TLXBM, GSE26713_TLXMYB, GSE26713_TLXTAL1, GSE26713_TLXTAL2, GSE26713_TLXTAL2LMO1,
          # file = 'C:/Users/Copito/OneDrive/Documentos/Master bioinf y bioest/TFM/datasets/GSE26713/Resultado_GSE26713.rda')


save(GSE26713_BMHOXA, GSE26713_BMLMO1, GSE26713_BMLMO2, GSE26713_BMMYB, GSE26713_BMTAL1, GSE26713_BMTAL2, GSE26713_BMTAL2LMO1, GSE26713_BMTLX1, GSE26713_BMTLX3, GSE26713_HOXALMO2, GSE26713_HOXATAL1, GSE26713_HOXATAL2LMO1, GSE26713_HOXATLX1, GSE26713_HOXATLX3, GSE26713_LMO1LMO2MYB, GSE26713_LMO2TAL2LMO1, GSE26713_LMO2TLX1, GSE26713_LMO2TLX3, GSE26713_LMOBM, GSE26713_LMOTAL1, GSE26713_LMOTAL2, GSE26713_LMOTAL2LMO1, GSE26713_LMOTLX1, GSE26713_LMOTLX3, GSE26713_MYBTLX1, GSE26713_MYBTLX3, GSE26713_TAL1TAL2LMO1, GSE26713_TAL1TLX1, GSE26713_TAL1TLX3, GSE26713_TAL2LMO1, GSE26713_TALBM, GSE26713_TALMYB, GSE26713_TALTAL2LMO1, GSE26713_TALTLX, GSE26713_TALTLX1, GSE26713_TALTLX3, GSE26713_TALTLXL, GSE26713_TLX, GSE26713_TLXBM, GSE26713_TLXMYB, GSE26713_TLXTAL1, GSE26713_TLXTAL2, GSE26713_TLXTAL2LMO1,
     file = 'C:/Users/Copito/OneDrive/Documentos/Master bioinf y bioest/TFM/datasets/GSE26713/NUEVOResultado_GSE26713.rda')


```

# GSE28703

## Análisis de significación biológica

Métodos de análisis



```{r, warning=TRUE, error=FALSE}
load('C:/Users/Copito/OneDrive/Documentos/Master bioinf y bioest/TFM/datasets/GSE28703/GSE28703_datos.normalizados.Rda')
load('C:/Users/Copito/OneDrive/Documentos/Master bioinf y bioest/TFM/datasets/GSE28703/GSE28703topTabs_Anot.RData')
```


```{r, warning=TRUE, error=FALSE}
library(dplyr)
selGenes_GSE28703 <- (topTab_GSE28703Anot %>%
    subset(adj.P.Val < 0.05) %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]

geneUniverse_GSE28703 <- (topTab_GSE28703Anot %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]

# La notación anterior pretende ser más clara y acorde con las tendencias
# actuales en R EL mismo resultado se habría podido obtener con un enfoque más
# clásico aunque algo más críptico : selGenes_SoloToxico<-
# unique(subset(topTab_SoloToxico_Anot, adj.P.Val < 0.05)$ENTREZID)
# selGenes_ToxicoEnMet <-unique(subset(topTab_ToxicoEnMet, adj.P.Val <
# 0.05)$ENTREZID) geneUniverse <- unique(topTab_ToxicoEnMet$ENTREZID)

```

Ejecución del análisis de enriquecimiento

El análisis es relativamente sencillo y muy parecido entre distintos paquetes.


```{r, warning=TRUE, error=FALSE}

library (Category)
library (hthgu133pluspm.db)
library(GOstats)


GOparamsGSE28703 <- new("GOHyperGParams", geneIds = selGenes_GSE28703, universeGeneIds = geneUniverse_GSE28703,
    annotation = "hthgu133pluspm.db", ontology = "BP", pvalueCutoff = 0.05, conditional = FALSE,
    testDirection = "over")

KEGGparamsGSE28703 <- new("KEGGHyperGParams", geneIds = selGenes_GSE28703, universeGeneIds = geneUniverse_GSE28703,
    annotation = "hthgu133pluspm.db", pvalueCutoff = 0.05)

# Ejecutamos los análisis
GOHyperGSE28703 <- hyperGTest(GOparamsGSE28703)
KEGGHyperGSE28703 <- hyperGTest(KEGGparamsGSE28703)
```

Resultados

Los resultados del análisis se encuentran en un objeto que se puede visualizar directamente.

```{r, warning=TRUE, error=FALSE}
summary(GOHyperGSE28703)
summary(KEGGHyperGSE28703)
```

Una mejor opción es exportarlos a un archivo, preferentemente con hiperenlaces que permitan una exploración directa de las categorías

----------



```{r, warning=TRUE, error=FALSE}
a <- (topTab_GSE28703Anot %>%
          subset(P.Value < 0.05))
unique(a$ENTREZID)
```


```{r, warning=TRUE, error=FALSE}
library(ReactomePA)
enrich.result <- enrichPathway(gene = selGenes_GSE28703,
                               pvalueCutoff = 0.05,
                               readable = T,
                               organism = "human",
                               universe = geneUniverse_GSE28703)

```

```{r, warning=TRUE, error=FALSE}

listOfTables <- list(GSE28703 = topTab_GSE28703Anot)

listOfSelected <- list()


for (i in 1:length(listOfTables)){
  # select the toptable
  topTab <- listOfTables[[i]]
  # select the genes to be included in the analysis
  whichGenes<-topTab["P.Value"]<0.05
  selectedIDs <- rownames(topTab)[whichGenes]
  # convert the ID to Entrez
  EntrezIDs<- listOfTables[[i]]$ENTREZID
  listOfSelected[[i]] <- EntrezIDs
  names(listOfSelected)[i] <- names(listOfTables)[i]
}

```



```{r, warning=TRUE, error=FALSE}

listOfData <- listOfSelected
comparisonsNames <- names(listOfData)
universe <- geneUniverse_GSE28703

for (i in 1:length(listOfData)){
  genesIn <- listOfData[[i]]
  comparison <- comparisonsNames[i]
  enrich.r <- enrich.result
  cat("##################################")
  cat("\nComparison: ", comparison,"\n")
  print(head(enrich.r))
}



```



```{r, warning=TRUE, error=FALSE}

barplot(enrich.r, showCategory = 15, font.size = 4,
title = paste0("Reactome Pathway Analysis for ", comparison,". Barplot"))

cnetplot(enrich.r, categorySize = "geneNum", schowCategory = 15, vertex.label.cex = 0.75)
```

```{r, warning=TRUE, error=FALSE}
Path<-enrich.r@result[["ID"]]
Biological_Description<-enrich.r@result[["Description"]]
Gene<-enrich.r@result[["geneID"]]
GSE28703_df<-data.frame(Path, Biological_Description, Gene)
library("xlsx")
write.xlsx(GSE28703_df, 'C:/Users/Copito/OneDrive/Documentos/Master bioinf y bioest/TFM/datasets/GSE28703/Resultado_GSE28703.xlsx', row.names = FALSE,
           col.names = TRUE)
```


# GSE32215

## Análisis de significación biológica

Métodos de análisis



```{r, warning=TRUE, error=FALSE}
load('C:/Users/Copito/OneDrive/Documentos/Master bioinf y bioest/TFM/datasets/GSE32215/GSE32215_datos.normalizados.Rda')
load('C:/Users/Copito/OneDrive/Documentos/Master bioinf y bioest/TFM/datasets/GSE32215/GSE32215_topTabAnot.Rda')
```


```{r, warning=TRUE, error=FALSE}
library(dplyr)
selGenes_GSE32215 <- (topTab_GSE32215_Anot %>%
    subset(adj.P.Val < 0.05) %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]

geneUniverse_GSE32215 <- (topTab_GSE32215_Anot %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]


# La notación anterior pretende ser más clara y acorde con las tendencias
# actuales en R EL mismo resultado se habría podido obtener con un enfoque más
# clásico aunque algo más críptico : selGenes_SoloToxico<-
# unique(subset(topTab_SoloToxico_Anot, adj.P.Val < 0.05)$ENTREZID)
# selGenes_ToxicoEnMet <-unique(subset(topTab_ToxicoEnMet, adj.P.Val <
# 0.05)$ENTREZID) geneUniverse <- unique(topTab_ToxicoEnMet$ENTREZID)

```

Ejecución del análisis de enriquecimiento

El análisis es relativamente sencillo y muy parecido entre distintos paquetes.


```{r, warning=TRUE, error=FALSE}

library (Category)
library (hthgu133pluspm.db)
library(GOstats)


GOparamsGSE32215 <- new("GOHyperGParams", geneIds = selGenes_GSE32215, universeGeneIds = geneUniverse_GSE32215,
    annotation = "hthgu133pluspm.db", ontology = "BP", pvalueCutoff = 0.05, conditional = FALSE,
    testDirection = "over")

KEGGparamsGSE32215 <- new("KEGGHyperGParams", geneIds = selGenes_GSE32215, universeGeneIds = geneUniverse_GSE32215,
    annotation = "hthgu133pluspm.db", pvalueCutoff = 0.05)

# Ejecutamos los análisis
GOHyperGSE32215 <- hyperGTest(GOparamsGSE32215)
KEGGHyperGSE32215 <- hyperGTest(KEGGparamsGSE32215)
```

Resultados

Los resultados del análisis se encuentran en un objeto que se puede visualizar directamente.

```{r, warning=TRUE, error=FALSE}
summary(GOHyperGSE32215)
summary(KEGGHyperGSE32215)
```

Una mejor opción es exportarlos a un archivo, preferentemente con hiperenlaces que permitan una exploración directa de las categorías

----------



```{r, warning=TRUE, error=FALSE}
a <- (topTab_GSE32215_Anot %>%
          subset(P.Value < 0.05))
unique(a$ENTREZID)
```


```{r, warning=TRUE, error=FALSE}
library(ReactomePA)
enrich.result <- enrichPathway(gene = selGenes_GSE32215,
                               pvalueCutoff = 0.05,
                               readable = T,
                               organism = "human",
                               universe = geneUniverse_GSE32215)

```

```{r, warning=TRUE, error=FALSE}

listOfTables <- list(GSE32215 = topTab_GSE32215_Anot)

listOfSelected <- list()


for (i in 1:length(listOfTables)){
  # select the toptable
  topTab <- listOfTables[[i]]
  # select the genes to be included in the analysis
  whichGenes<-topTab["P.Value"]<0.05
  selectedIDs <- rownames(topTab)[whichGenes]
  # convert the ID to Entrez
  EntrezIDs<- listOfTables[[i]]$ENTREZID
  listOfSelected[[i]] <- EntrezIDs
  names(listOfSelected)[i] <- names(listOfTables)[i]
}

```



```{r, warning=TRUE, error=FALSE}

listOfData <- listOfSelected
comparisonsNames <- names(listOfData)
universe <- geneUniverse_GSE32215

for (i in 1:length(listOfData)){
  genesIn <- listOfData[[i]]
  comparison <- comparisonsNames[i]
  enrich.r <- enrich.result
  cat("##################################")
  cat("\nComparison: ", comparison,"\n")
  print(head(enrich.r))
}



```



```{r, warning=TRUE, error=FALSE}
Path<-enrich.r@result[["ID"]]
Biological_Description<-enrich.r@result[["Description"]]
Gene<-enrich.r@result[["geneID"]]
GSE32215_df<-data.frame(Path, Biological_Description, Gene)
library("xlsx")
write.xlsx(GSE32215_df, 'C:/Users/Copito/OneDrive/Documentos/Master bioinf y bioest/TFM/datasets/GSE32215/Resultado_GSE32215.xlsx', row.names = FALSE,
           col.names = TRUE)
```

# GSE33470

## Análisis de significación biológica

Métodos de análisis



```{r, warning=TRUE, error=FALSE}
load('C:/Users/Copito/OneDrive/Documentos/Master bioinf y bioest/TFM/datasets/GSE33470/GSE33470datos.normalizados.Rda')
load('C:/Users/Copito/OneDrive/Documentos/Master bioinf y bioest/TFM/datasets/GSE33470/GSE33470topTabs_Anot.Rda')
```


```{r, warning=TRUE, error=FALSE}
ls(pattern = 'topTab')
```



```{r, warning=TRUE, error=TRUE}
library(dplyr)


selGenes_1 <- (topTab_GSE33470CD3_Anot %>%
    subset(adj.P.Val < 0.05) %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]

geneUniverse_1 <- (topTab_GSE33470CD3_Anot %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]


selGenes_2 <- (topTab_GSE33470CD34_Anot %>%
    subset(adj.P.Val < 0.05) %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]

geneUniverse_2 <- (topTab_GSE33470CD34_Anot %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]


selGenes_3 <- (topTab_GSE33470CD34CD4_Anot %>%
    subset(adj.P.Val < 0.05) %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]

geneUniverse_3 <- (topTab_GSE33470CD34CD4_Anot %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]


selGenes_4 <- (topTab_GSE33470CD34DPCD3_Anot %>%
    subset(adj.P.Val < 0.05) %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]

geneUniverse_4 <- (topTab_GSE33470CD34DPCD3_Anot %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]


selGenes_5 <- (topTab_GSE33470CD34masmasCD4_Anot %>%
    subset(adj.P.Val < 0.05) %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]

geneUniverse_5 <- (topTab_GSE33470CD34masmasCD4_Anot %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]
  
 

selGenes_6 <- (topTab_GSE33470CD34masmasDPCD3mas_Anot %>%
    subset(adj.P.Val < 0.05) %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]

geneUniverse_6 <- (topTab_GSE33470CD34masmasDPCD3mas_Anot %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]

selGenes_7 <- (topTab_GSE33470CD34masmasDPCD3menos_Anot %>%
    subset(adj.P.Val < 0.05) %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]

geneUniverse_7 <- (topTab_GSE33470CD34masmasDPCD3menos_Anot %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]


selGenes_8 <- (topTab_GSE33470CD34masmenosCD4_Anot %>%
    subset(adj.P.Val < 0.05) %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]

geneUniverse_8 <- (topTab_GSE33470CD34masmenosCD4_Anot %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]


selGenes_9 <- (topTab_GSE33470CD34masmenosDPCD3mas_Anot %>%
    subset(adj.P.Val < 0.05) %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]

geneUniverse_9 <- (topTab_GSE33470CD34masmenosDPCD3mas_Anot %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]

              
   
selGenes_10 <- (topTab_GSE33470CD34masmenosDPCD3menos_Anot %>%
    subset(adj.P.Val < 0.05) %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]

geneUniverse_10 <- (topTab_GSE33470CD34masmenosDPCD3menos_Anot %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]


selGenes_11 <- (topTab_GSE33470CD3CD34_Anot %>%
    subset(adj.P.Val < 0.05) %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]

geneUniverse_11 <- (topTab_GSE33470CD3CD34_Anot %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]


selGenes_12 <- (topTab_GSE33470CD3CD4_Anot %>%
    subset(adj.P.Val < 0.05) %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]

geneUniverse_12 <- (topTab_GSE33470CD3CD4_Anot %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]


selGenes_13 <- (topTab_GSE33470CD3DPCD3_Anot %>%
    subset(adj.P.Val < 0.05) %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]

geneUniverse_13 <- (topTab_GSE33470CD3DPCD3_Anot %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]


selGenes_14 <- (topTab_GSE33470CD3masCD4CD34masmas_Anot %>%
    subset(adj.P.Val < 0.05) %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]

geneUniverse_14 <- (topTab_GSE33470CD3masCD4CD34masmas_Anot %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]


selGenes_15 <- (topTab_GSE33470CD3masCD4CD34masmeno_Anot %>%
    subset(adj.P.Val < 0.05) %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]

geneUniverse_15 <- (topTab_GSE33470CD3masCD4CD34masmeno_Anot %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]


selGenes_16 <- (topTab_GSE33470CD3masCD4CD4_Anot %>%
    subset(adj.P.Val < 0.05) %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]

geneUniverse_16 <- (topTab_GSE33470CD3masCD4CD4_Anot %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]



selGenes_17 <- (topTab_GSE33470CD3masCD4DPCD3mas_Anot %>%
    subset(adj.P.Val < 0.05) %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]

geneUniverse_17 <- (topTab_GSE33470CD3masCD4DPCD3mas_Anot %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]



selGenes_18 <- (topTab_GSE33470CD3masCD4DPCD3menos_Anot %>%
    subset(adj.P.Val < 0.05) %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]

geneUniverse_18 <- (topTab_GSE33470CD3masCD4DPCD3menos_Anot %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]


selGenes_19 <- (topTab_GSE33470CD3masCD8CD34masmas_Anot %>%
    subset(adj.P.Val < 0.05) %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]

geneUniverse_19 <- (topTab_GSE33470CD3masCD8CD34masmas_Anot %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]


selGenes_20 <- (topTab_GSE33470CD3masCD8CD34masmenos_Anot %>%
    subset(adj.P.Val < 0.05) %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]

geneUniverse_20 <- (topTab_GSE33470CD3masCD8CD34masmenos_Anot %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]


selGenes_21 <- (topTab_GSE33470CD3masCD8CD4_Anot %>%
    subset(adj.P.Val < 0.05) %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]

geneUniverse_21 <- (topTab_GSE33470CD3masCD8CD4_Anot %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]


selGenes_22 <- (topTab_GSE33470CD3masCD8DPCD3mas_Anot %>%
    subset(adj.P.Val < 0.05) %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]

geneUniverse_22 <- (topTab_GSE33470CD3masCD8DPCD3mas_Anot %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]


selGenes_23 <- (topTab_GSE33470CD3masCD8DPCD3menos_Anot %>%
    subset(adj.P.Val < 0.05) %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]

geneUniverse_23 <- (topTab_GSE33470CD3masCD8DPCD3menos_Anot %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]


selGenes_24 <- (topTab_GSE33470CD4DPCD3_Anot %>%
    subset(adj.P.Val < 0.05) %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]

geneUniverse_24 <- (topTab_GSE33470CD4DPCD3_Anot %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]


selGenes_25 <- (topTab_GSE33470CD4DPCD3mas_Anot %>%
    subset(adj.P.Val < 0.05) %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]

geneUniverse_25 <- (topTab_GSE33470CD4DPCD3mas_Anot %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]


selGenes_26 <- (topTab_GSE33470CD4DPCD3menos_Anot %>%
    subset(adj.P.Val < 0.05) %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]

geneUniverse_26 <- (topTab_GSE33470CD4DPCD3menos_Anot %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]


selGenes_27 <- (topTab_GSE33470DPCD3_Anot %>%
    subset(adj.P.Val < 0.05) %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]

geneUniverse_27 <- (topTab_GSE33470DPCD3_Anot %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]

# La notación anterior pretende ser más clara y acorde con las tendencias
# actuales en R EL mismo resultado se habría podido obtener con un enfoque más
# clásico aunque algo más críptico : selGenes_SoloToxico<-
# unique(subset(topTab_SoloToxico_Anot, adj.P.Val < 0.05)$ENTREZID)
# selGenes_ToxicoEnMet <-unique(subset(topTab_ToxicoEnMet, adj.P.Val <
# 0.05)$ENTREZID) geneUniverse <- unique(topTab_ToxicoEnMet$ENTREZID)

```

Ejecución del análisis de enriquecimiento

El análisis es relativamente sencillo y muy parecido entre distintos paquetes.


```{r, warning=TRUE, error=TRUE}

library (Category)
library (illuminaHumanv4.db)
library(GOstats)


GOparams1 <- new("GOHyperGParams", geneIds = selGenes_1, universeGeneIds = geneUniverse_1,
    annotation = "illuminaHumanv4.db", ontology = "BP", pvalueCutoff = 0.05, conditional = FALSE,
    testDirection = "over")

KEGGparams1 <- new("KEGGHyperGParams", geneIds = selGenes_1, universeGeneIds = geneUniverse_1,
    annotation = "illuminaHumanv4.db", pvalueCutoff = 0.05)

# Ejecutamos los análisis
GOHyper1 <- hyperGTest(GOparams1)
KEGGHyper1 <- hyperGTest(KEGGparams1)


#--
GOparams2 <- new("GOHyperGParams", geneIds = selGenes_2, universeGeneIds = geneUniverse_2,
    annotation = "illuminaHumanv4.db", ontology = "BP", pvalueCutoff = 0.05, conditional = FALSE,
    testDirection = "over")

KEGGparams2 <- new("KEGGHyperGParams", geneIds = selGenes_2, universeGeneIds = geneUniverse_2,
    annotation = "illuminaHumanv4.db", pvalueCutoff = 0.05)

# Ejecutamos los análisis
GOHyper2 <- hyperGTest(GOparams2)
KEGGHyper2 <- hyperGTest(KEGGparams2)

#--
GOparams3 <- new("GOHyperGParams", geneIds = selGenes_3, universeGeneIds = geneUniverse_3,
    annotation = "illuminaHumanv4.db", ontology = "BP", pvalueCutoff = 0.05, conditional = FALSE,
    testDirection = "over")

KEGGparams3 <- new("KEGGHyperGParams", geneIds = selGenes_3, universeGeneIds = geneUniverse_3,
    annotation = "illuminaHumanv4.db", pvalueCutoff = 0.05)

# Ejecutamos los análisis
GOHyper3 <- hyperGTest(GOparams3)
KEGGHyper3 <- hyperGTest(KEGGparams3)


#--
GOparams4 <- new("GOHyperGParams", geneIds = selGenes_4, universeGeneIds = geneUniverse_4,
    annotation = "illuminaHumanv4.db", ontology = "BP", pvalueCutoff = 0.05, conditional = FALSE,
    testDirection = "over")

KEGGparams4 <- new("KEGGHyperGParams", geneIds = selGenes_4, universeGeneIds = geneUniverse_4,
    annotation = "illuminaHumanv4.db", pvalueCutoff = 0.05)

# Ejecutamos los análisis
GOHyper4 <- hyperGTest(GOparams4)
KEGGHyper4 <- hyperGTest(KEGGparams4)


#--
GOparams5 <- new("GOHyperGParams", geneIds = selGenes_5, universeGeneIds = geneUniverse_5,
    annotation = "illuminaHumanv4.db", ontology = "BP", pvalueCutoff = 0.05, conditional = FALSE,
    testDirection = "over")

KEGGparams5 <- new("KEGGHyperGParams", geneIds = selGenes_5, universeGeneIds = geneUniverse_5,
    annotation = "illuminaHumanv4.db", pvalueCutoff = 0.05)

# Ejecutamos los análisis
GOHyper5 <- hyperGTest(GOparams5)
KEGGHyper5 <- hyperGTest(KEGGparams5)



#--
GOparams6 <- new("GOHyperGParams", geneIds = selGenes_6, universeGeneIds = geneUniverse_6,
    annotation = "illuminaHumanv4.db", ontology = "BP", pvalueCutoff = 0.05, conditional = FALSE,
    testDirection = "over")

KEGGparams6 <- new("KEGGHyperGParams", geneIds = selGenes_6, universeGeneIds = geneUniverse_6,
    annotation = "illuminaHumanv4.db", pvalueCutoff = 0.05)

# Ejecutamos los análisis
GOHyper6 <- hyperGTest(GOparams6)
KEGGHyper6 <- hyperGTest(KEGGparams6)


#--
GOparams7 <- new("GOHyperGParams", geneIds = selGenes_7, universeGeneIds = geneUniverse_7,
    annotation = "illuminaHumanv4.db", ontology = "BP", pvalueCutoff = 0.05, conditional = FALSE,
    testDirection = "over")

KEGGparams7 <- new("KEGGHyperGParams", geneIds = selGenes_7, universeGeneIds = geneUniverse_7,
    annotation = "illuminaHumanv4.db", pvalueCutoff = 0.05)

# Ejecutamos los análisis
GOHyper7 <- hyperGTest(GOparams7)
KEGGHyper7 <- hyperGTest(KEGGparams7)


#--
GOparams8 <- new("GOHyperGParams", geneIds = selGenes_8, universeGeneIds = geneUniverse_8,
    annotation = "illuminaHumanv4.db", ontology = "BP", pvalueCutoff = 0.05, conditional = FALSE,
    testDirection = "over")

KEGGparams8 <- new("KEGGHyperGParams", geneIds = selGenes_8, universeGeneIds = geneUniverse_8,
    annotation = "illuminaHumanv4.db", pvalueCutoff = 0.05)

# Ejecutamos los análisis
GOHyper8 <- hyperGTest(GOparams8)
KEGGHyper8 <- hyperGTest(KEGGparams8)


#--
GOparams9 <- new("GOHyperGParams", geneIds = selGenes_9, universeGeneIds = geneUniverse_9,
    annotation = "illuminaHumanv4.db", ontology = "BP", pvalueCutoff = 0.05, conditional = FALSE,
    testDirection = "over")

KEGGparams9 <- new("KEGGHyperGParams", geneIds = selGenes_9, universeGeneIds = geneUniverse_9,
    annotation = "illuminaHumanv4.db", pvalueCutoff = 0.05)

# Ejecutamos los análisis
GOHyper9 <- hyperGTest(GOparams9)
KEGGHyper9 <- hyperGTest(KEGGparams9)


#--
GOparams10 <- new("GOHyperGParams", geneIds = selGenes_10, universeGeneIds = geneUniverse_10,
    annotation = "illuminaHumanv4.db", ontology = "BP", pvalueCutoff = 0.05, conditional = FALSE,
    testDirection = "over")

KEGGparams10 <- new("KEGGHyperGParams", geneIds = selGenes_10, universeGeneIds = geneUniverse_10,
    annotation = "illuminaHumanv4.db", pvalueCutoff = 0.05)

# Ejecutamos los análisis
GOHyper10 <- hyperGTest(GOparams10)
KEGGHyper10 <- hyperGTest(KEGGparams10)


#--
GOparams11 <- new("GOHyperGParams", geneIds = selGenes_11, universeGeneIds = geneUniverse_11,
    annotation = "illuminaHumanv4.db", ontology = "BP", pvalueCutoff = 0.05, conditional = FALSE,
    testDirection = "over")

KEGGparams11 <- new("KEGGHyperGParams", geneIds = selGenes_11, universeGeneIds = geneUniverse_11,
    annotation = "illuminaHumanv4.db", pvalueCutoff = 0.05)

# Ejecutamos los análisis
GOHyper11 <- hyperGTest(GOparams11)
KEGGHyper11 <- hyperGTest(KEGGparams11)


#--
GOparams12 <- new("GOHyperGParams", geneIds = selGenes_12, universeGeneIds = geneUniverse_12,
    annotation = "illuminaHumanv4.db", ontology = "BP", pvalueCutoff = 0.05, conditional = FALSE,
    testDirection = "over")

KEGGparams12 <- new("KEGGHyperGParams", geneIds = selGenes_12, universeGeneIds = geneUniverse_12,
    annotation = "illuminaHumanv4.db", pvalueCutoff = 0.05)

# Ejecutamos los análisis
GOHyper12 <- hyperGTest(GOparams12)
KEGGHyper12 <- hyperGTest(KEGGparams12)



#--
GOparams13 <- new("GOHyperGParams", geneIds = selGenes_13, universeGeneIds = geneUniverse_13,
    annotation = "illuminaHumanv4.db", ontology = "BP", pvalueCutoff = 0.05, conditional = FALSE,
    testDirection = "over")

KEGGparams13 <- new("KEGGHyperGParams", geneIds = selGenes_13, universeGeneIds = geneUniverse_13,
    annotation = "illuminaHumanv4.db", pvalueCutoff = 0.05)

# Ejecutamos los análisis
GOHyper13 <- hyperGTest(GOparams13)
KEGGHyper13 <- hyperGTest(KEGGparams13)


#--
GOparams14 <- new("GOHyperGParams", geneIds = selGenes_14, universeGeneIds = geneUniverse_14,
    annotation = "illuminaHumanv4.db", ontology = "BP", pvalueCutoff = 0.05, conditional = FALSE,
    testDirection = "over")

KEGGparams14 <- new("KEGGHyperGParams", geneIds = selGenes_14, universeGeneIds = geneUniverse_14,
    annotation = "illuminaHumanv4.db", pvalueCutoff = 0.05)

# Ejecutamos los análisis
GOHyper14 <- hyperGTest(GOparams14)
KEGGHyper14 <- hyperGTest(KEGGparams14)



#--
GOparams15 <- new("GOHyperGParams", geneIds = selGenes_15, universeGeneIds = geneUniverse_15,
    annotation = "illuminaHumanv4.db", ontology = "BP", pvalueCutoff = 0.05, conditional = FALSE,
    testDirection = "over")

KEGGparams15 <- new("KEGGHyperGParams", geneIds = selGenes_15, universeGeneIds = geneUniverse_15,
    annotation = "illuminaHumanv4.db", pvalueCutoff = 0.05)

# Ejecutamos los análisis
GOHyper15 <- hyperGTest(GOparams15)
KEGGHyper15 <- hyperGTest(KEGGparams15)


#--
GOparams16 <- new("GOHyperGParams", geneIds = selGenes_16, universeGeneIds = geneUniverse_16,
    annotation = "illuminaHumanv4.db", ontology = "BP", pvalueCutoff = 0.05, conditional = FALSE,
    testDirection = "over")

KEGGparams16 <- new("KEGGHyperGParams", geneIds = selGenes_16, universeGeneIds = geneUniverse_16,
    annotation = "illuminaHumanv4.db", pvalueCutoff = 0.05)

# Ejecutamos los análisis
GOHyper16 <- hyperGTest(GOparams16)
KEGGHyper16 <- hyperGTest(KEGGparams16)


#--
GOparams17 <- new("GOHyperGParams", geneIds = selGenes_17, universeGeneIds = geneUniverse_17,
    annotation = "illuminaHumanv4.db", ontology = "BP", pvalueCutoff = 0.05, conditional = FALSE,
    testDirection = "over")

KEGGparams17 <- new("KEGGHyperGParams", geneIds = selGenes_17, universeGeneIds = geneUniverse_17,
    annotation = "illuminaHumanv4.db", pvalueCutoff = 0.05)

# Ejecutamos los análisis
GOHyper17 <- hyperGTest(GOparams17)
KEGGHyper17 <- hyperGTest(KEGGparams17)


#--
GOparams18 <- new("GOHyperGParams", geneIds = selGenes_18, universeGeneIds = geneUniverse_18,
    annotation = "illuminaHumanv4.db", ontology = "BP", pvalueCutoff = 0.05, conditional = FALSE,
    testDirection = "over")

KEGGparams18 <- new("KEGGHyperGParams", geneIds = selGenes_18, universeGeneIds = geneUniverse_18,
    annotation = "illuminaHumanv4.db", pvalueCutoff = 0.05)

# Ejecutamos los análisis
GOHyper18 <- hyperGTest(GOparams18)
KEGGHyper18 <- hyperGTest(KEGGparams18)


#--
GOparams19 <- new("GOHyperGParams", geneIds = selGenes_19, universeGeneIds = geneUniverse_19,
    annotation = "illuminaHumanv4.db", ontology = "BP", pvalueCutoff = 0.05, conditional = FALSE,
    testDirection = "over")

KEGGparams19 <- new("KEGGHyperGParams", geneIds = selGenes_19, universeGeneIds = geneUniverse_19,
    annotation = "illuminaHumanv4.db", pvalueCutoff = 0.05)

# Ejecutamos los análisis
GOHyper19 <- hyperGTest(GOparams19)
KEGGHyper19 <- hyperGTest(KEGGparams19)


#--
GOparams20 <- new("GOHyperGParams", geneIds = selGenes_20, universeGeneIds = geneUniverse_20,
    annotation = "illuminaHumanv4.db", ontology = "BP", pvalueCutoff = 0.05, conditional = FALSE,
    testDirection = "over")

KEGGparams20 <- new("KEGGHyperGParams", geneIds = selGenes_20, universeGeneIds = geneUniverse_20,
    annotation = "illuminaHumanv4.db", pvalueCutoff = 0.05)

# Ejecutamos los análisis
GOHyper20 <- hyperGTest(GOparams20)
KEGGHyper20 <- hyperGTest(KEGGparams20)

#--
GOparams21 <- new("GOHyperGParams", geneIds = selGenes_21, universeGeneIds = geneUniverse_21,
    annotation = "illuminaHumanv4.db", ontology = "BP", pvalueCutoff = 0.05, conditional = FALSE,
    testDirection = "over")

KEGGparams21 <- new("KEGGHyperGParams", geneIds = selGenes_21, universeGeneIds = geneUniverse_21,
    annotation = "illuminaHumanv4.db", pvalueCutoff = 0.05)

# Ejecutamos los análisis
GOHyper21 <- hyperGTest(GOparams21)
KEGGHyper21 <- hyperGTest(KEGGparams21)

#--
GOparams22 <- new("GOHyperGParams", geneIds = selGenes_22, universeGeneIds = geneUniverse_22,
    annotation = "illuminaHumanv4.db", ontology = "BP", pvalueCutoff = 0.05, conditional = FALSE,
    testDirection = "over")

KEGGparams22 <- new("KEGGHyperGParams", geneIds = selGenes_22, universeGeneIds = geneUniverse_22,
    annotation = "illuminaHumanv4.db", pvalueCutoff = 0.05)

# Ejecutamos los análisis
GOHyper22 <- hyperGTest(GOparams22)
KEGGHyper22 <- hyperGTest(KEGGparams22)


#--
GOparams23 <- new("GOHyperGParams", geneIds = selGenes_23, universeGeneIds = geneUniverse_23,
    annotation = "illuminaHumanv4.db", ontology = "BP", pvalueCutoff = 0.05, conditional = FALSE,
    testDirection = "over")

KEGGparams23 <- new("KEGGHyperGParams", geneIds = selGenes_23, universeGeneIds = geneUniverse_23,
    annotation = "illuminaHumanv4.db", pvalueCutoff = 0.05)

# Ejecutamos los análisis
GOHyper23 <- hyperGTest(GOparams23)
KEGGHyper23 <- hyperGTest(KEGGparams23)

#--
GOparams24 <- new("GOHyperGParams", geneIds = selGenes_24, universeGeneIds = geneUniverse_24,
    annotation = "illuminaHumanv4.db", ontology = "BP", pvalueCutoff = 0.05, conditional = FALSE,
    testDirection = "over")

KEGGparams24 <- new("KEGGHyperGParams", geneIds = selGenes_24, universeGeneIds = geneUniverse_24,
    annotation = "illuminaHumanv4.db", pvalueCutoff = 0.05)

# Ejecutamos los análisis
GOHyper24 <- hyperGTest(GOparams24)
KEGGHyper24 <- hyperGTest(KEGGparams24)


#--
GOparams25 <- new("GOHyperGParams", geneIds = selGenes_25, universeGeneIds = geneUniverse_25,
    annotation = "illuminaHumanv4.db", ontology = "BP", pvalueCutoff = 0.05, conditional = FALSE,
    testDirection = "over")

KEGGparams25 <- new("KEGGHyperGParams", geneIds = selGenes_25, universeGeneIds = geneUniverse_25,
    annotation = "illuminaHumanv4.db", pvalueCutoff = 0.05)

# Ejecutamos los análisis
GOHyper25 <- hyperGTest(GOparams25)
KEGGHyper25 <- hyperGTest(KEGGparams25)


#--
GOparams26 <- new("GOHyperGParams", geneIds = selGenes_26, universeGeneIds = geneUniverse_26,
    annotation = "illuminaHumanv4.db", ontology = "BP", pvalueCutoff = 0.05, conditional = FALSE,
    testDirection = "over")

KEGGparams26 <- new("KEGGHyperGParams", geneIds = selGenes_26, universeGeneIds = geneUniverse_26,
    annotation = "illuminaHumanv4.db", pvalueCutoff = 0.05)

# Ejecutamos los análisis
GOHyper26 <- hyperGTest(GOparams26)
KEGGHyper26 <- hyperGTest(KEGGparams26)

#--
GOparams27 <- new("GOHyperGParams", geneIds = selGenes_27, universeGeneIds = geneUniverse_27,
    annotation = "illuminaHumanv4.db", ontology = "BP", pvalueCutoff = 0.05, conditional = FALSE,
    testDirection = "over")

KEGGparams27 <- new("KEGGHyperGParams", geneIds = selGenes_27, universeGeneIds = geneUniverse_27,
    annotation = "illuminaHumanv4.db", pvalueCutoff = 0.05)

# Ejecutamos los análisis
GOHyper27 <- hyperGTest(GOparams27)
KEGGHyper27 <- hyperGTest(KEGGparams27)





```



Resultados

Los resultados del análisis se encuentran en un objeto que se puede visualizar directamente.

```{r, warning=TRUE, error=FALSE}
summary(GOHyper14)
summary(KEGGHyper14)
```

Una mejor opción es exportarlos a un archivo, preferentemente con hiperenlaces que permitan una exploración directa de las categorías

----------



```{r, warning=TRUE, error=TRUE}
library(dplyr)

a <- (selGenes_4 %>%
          subset(P.Value < 0.05))
unique(a$ENTREZID)

library(ReactomePA)
enrich.result_1 <- enrichPathway(gene = selGenes_1,
                               pvalueCutoff = 0.05,
                               readable = T,
                               organism = "human",
                               universe = geneUniverse_1)



enrich.result_2 <- enrichPathway(gene = selGenes_2, # no sale
                               pvalueCutoff = 0.05,
                               readable = T,
                               organism = "human",
                               universe = geneUniverse_2)


enrich.result_3 <- enrichPathway(gene = selGenes_3,
                               pvalueCutoff = 0.05,
                               readable = T,
                               organism = "human",
                               universe = geneUniverse_3)

enrich.result_4 <- enrichPathway(gene = selGenes_4,
                               pvalueCutoff = 0.05,
                               readable = T,
                               organism = "human",
                               universe = geneUniverse_4)


enrich.result_5 <- enrichPathway(gene = selGenes_5,
                               pvalueCutoff = 0.05,
                               readable = T,
                               organism = "human",
                               universe = geneUniverse_5)


enrich.result_6 <- enrichPathway(gene = selGenes_6,
                               pvalueCutoff = 0.05,
                               readable = T,
                               organism = "human",
                               universe = geneUniverse_6)


enrich.result_7 <- enrichPathway(gene = selGenes_7,
                               pvalueCutoff = 0.05,
                               readable = T,
                               organism = "human",
                               universe = geneUniverse_7)


enrich.result_8 <- enrichPathway(gene = selGenes_8,
                               pvalueCutoff = 0.05,
                               readable = T,
                               organism = "human",
                               universe = geneUniverse_8)


enrich.result_9 <- enrichPathway(gene = selGenes_9,
                               pvalueCutoff = 0.05,
                               readable = T,
                               organism = "human",
                               universe = geneUniverse_9)

enrich.result_10 <- enrichPathway(gene = selGenes_10,
                               pvalueCutoff = 0.05,
                               readable = T,
                               organism = "human",
                               universe = geneUniverse_10)


enrich.result_11 <- enrichPathway(gene = selGenes_11,
                               pvalueCutoff = 0.05,
                               readable = T,
                               organism = "human",
                               universe = geneUniverse_11)


enrich.result_12 <- enrichPathway(gene = selGenes_12,
                               pvalueCutoff = 0.05,
                               readable = T,
                               organism = "human",
                               universe = geneUniverse_12)


enrich.result_13 <- enrichPathway(gene = selGenes_13,
                               pvalueCutoff = 0.05,
                               readable = T,
                               organism = "human",
                               universe = geneUniverse_13)



enrich.result_14 <- enrichPathway(gene = selGenes_14,
                               pvalueCutoff = 0.05,
                               readable = T,
                               organism = "human",
                               universe = geneUniverse_14)


enrich.result_15 <- enrichPathway(gene = selGenes_15,
                               pvalueCutoff = 0.05,
                               readable = T,
                               organism = "human",
                               universe = geneUniverse_15)

enrich.result_16 <- enrichPathway(gene = selGenes_16,
                               pvalueCutoff = 0.05,
                               readable = T,
                               organism = "human",
                               universe = geneUniverse_16)


enrich.result_17 <- enrichPathway(gene = selGenes_17,
                               pvalueCutoff = 0.05,
                               readable = T,
                               organism = "human",
                               universe = geneUniverse_17)


enrich.result_18 <- enrichPathway(gene = selGenes_18,
                               pvalueCutoff = 0.05,
                               readable = T,
                               organism = "human",
                               universe = geneUniverse_18)


enrich.result_19 <- enrichPathway(gene = selGenes_19,
                               pvalueCutoff = 0.05,
                               readable = T,
                               organism = "human",
                               universe = geneUniverse_19)


enrich.result_20 <- enrichPathway(gene = selGenes_20,
                               pvalueCutoff = 0.05,
                               readable = T,
                               organism = "human",
                               universe = geneUniverse_20)


enrich.result_21 <- enrichPathway(gene = selGenes_21,
                               pvalueCutoff = 0.05,
                               readable = T,
                               organism = "human",
                               universe = geneUniverse_21)

enrich.result_22 <- enrichPathway(gene = selGenes_22,
                               pvalueCutoff = 0.05,
                               readable = T,
                               organism = "human",
                               universe = geneUniverse_22)


enrich.result_23 <- enrichPathway(gene = selGenes_23,
                               pvalueCutoff = 0.05,
                               readable = T,
                               organism = "human",
                               universe = geneUniverse_23)


enrich.result_24 <- enrichPathway(gene = selGenes_24,
                               pvalueCutoff = 0.05,
                               readable = T,
                               organism = "human",
                               universe = geneUniverse_24)


enrich.result_25 <- enrichPathway(gene = selGenes_25,
                               pvalueCutoff = 0.05,
                               readable = T,
                               organism = "human",
                               universe = geneUniverse_25)

enrich.result_26 <- enrichPathway(gene = selGenes_26,
                               pvalueCutoff = 0.05,
                               readable = T,
                               organism = "human",
                               universe = geneUniverse_26)


enrich.result_27 <- enrichPathway(gene = selGenes_27, # no sale
                               pvalueCutoff = 0.05,
                               readable = T,
                               organism = "human",
                               universe = geneUniverse_27)


```

 [1] "topTab_GSE33470CD3_Anot"                    "topTab_GSE33470CD34_Anot"                   "topTab_GSE33470CD34CD4_Anot"               
 [4] "topTab_GSE33470CD34DPCD3_Anot"              "topTab_GSE33470CD34masmasCD4_Anot"          "topTab_GSE33470CD34masmasDPCD3mas_Anot"    
 [7] "topTab_GSE33470CD34masmasDPCD3menos_Anot"   "topTab_GSE33470CD34masmenosCD4_Anot"        "topTab_GSE33470CD34masmenosDPCD3mas_Anot"  
[10] "topTab_GSE33470CD34masmenosDPCD3menos_Anot" "topTab_GSE33470CD3CD34_Anot"                "topTab_GSE33470CD3CD4_Anot"                
[13] "topTab_GSE33470CD3DPCD3_Anot"               "topTab_GSE33470CD3masCD4CD34masmas_Anot"    "topTab_GSE33470CD3masCD4CD34masmeno_Anot"  
[16] "topTab_GSE33470CD3masCD4CD4_Anot"           "topTab_GSE33470CD3masCD4DPCD3mas_Anot"      "topTab_GSE33470CD3masCD4DPCD3menos_Anot"   
[19] "topTab_GSE33470CD3masCD8CD34masmas_Anot"    "topTab_GSE33470CD3masCD8CD34masmenos_Anot"  "topTab_GSE33470CD3masCD8CD4_Anot"          
[22] "topTab_GSE33470CD3masCD8DPCD3mas_Anot"      "topTab_GSE33470CD3masCD8DPCD3menos_Anot"    "topTab_GSE33470CD4DPCD3_Anot"              
[25] "topTab_GSE33470CD4DPCD3mas_Anot"            "topTab_GSE33470CD4DPCD3menos_Anot"          "topTab_GSE33470DPCD3_Anot" 

No incluimos ni el 2 ni el número 27.

```{r, warning=TRUE, error=FALSE}

listOfTables <- list(CD3 = topTab_GSE33470CD3_Anot,
                     CD34CD4= topTab_GSE33470CD34CD4_Anot,
                     CD34DPCD3= topTab_GSE33470CD34DPCD3_Anot,
                     CD34masmasCD4= topTab_GSE33470CD34masmasCD4_Anot,
                     CD34masmasDPCD3mas= topTab_GSE33470CD34masmasDPCD3mas_Anot,
                     CD34masmasDPCD3menos= topTab_GSE33470CD34masmasDPCD3menos_Anot,
                     CD34masmenosCD4= topTab_GSE33470CD34masmenosCD4_Anot,
                     CD34masmenosDPCD3mas= topTab_GSE33470CD34masmenosDPCD3mas_Anot,
                     CD34masmenosDPCD3menos= topTab_GSE33470CD34masmenosDPCD3menos_Anot, # 10
                     CD3CD34= topTab_GSE33470CD3CD34_Anot,
                     CD3CD4= topTab_GSE33470CD3CD4_Anot,
                     CD3DPCD3= topTab_GSE33470CD3DPCD3_Anot,
                     CD4CD34masmas = topTab_GSE33470CD3masCD4CD34masmas_Anot,
                     CD3masCD4CD34masmeno= topTab_GSE33470CD3masCD4CD34masmeno_Anot,
                     CD3masCD4CD4= topTab_GSE33470CD3masCD4CD4_Anot,
                     CD3masCD4DPCD3mas= topTab_GSE33470CD3masCD4DPCD3mas_Anot,
                     CD3masCD4DPCD3menos= topTab_GSE33470CD3masCD4DPCD3menos_Anot,
                     CD3masCD8CD34masmas= topTab_GSE33470CD3masCD8CD34masmas_Anot,
                     CD3masCD8CD34masmenos= topTab_GSE33470CD3masCD8CD34masmenos_Anot,
                     CD3masCD8CD4= topTab_GSE33470CD3masCD8CD4_Anot,
                     CD3masCD8DPCD3mas= topTab_GSE33470CD3masCD8DPCD3mas_Anot,
                     CD3masCD8DPCD3menos= topTab_GSE33470CD3masCD8DPCD3menos_Anot,
                     CD4DPCD3= topTab_GSE33470CD4DPCD3_Anot,
                     CD4DPCD3mas= topTab_GSE33470CD4DPCD3mas_Anot,
                     CD4DPCD3menos= topTab_GSE33470CD4DPCD3menos_Anot)

listOfSelected <- list()



for (i in 1:length(listOfTables)){
  # select the toptable
  topTab <- listOfTables[[i]]
  # select the genes to be included in the analysis
  whichGenes<-topTab["P.Value"]<0.05
  selectedIDs <- rownames(topTab)[whichGenes]
  # convert the ID to Entrez
  EntrezIDs<- listOfTables[[i]]$ENTREZID
  listOfSelected[[i]] <- EntrezIDs
  names(listOfSelected)[i] <- names(listOfTables)[i]
}

```



```{r, warning=TRUE, error=FALSE}
ls(pattern="enrich")

listOfData <- listOfSelected

comparisonsNames <- names(listOfData)

universes <- list(geneUniverse_1,
                  geneUniverse_3, geneUniverse_4,
                   geneUniverse_5, geneUniverse_6,
                   geneUniverse_7,
                  geneUniverse_8, geneUniverse_9,
                  geneUniverse_10, geneUniverse_11,
                  geneUniverse_12, geneUniverse_13,
                  geneUniverse_14, geneUniverse_15,
                  geneUniverse_16, geneUniverse_17,
                  geneUniverse_18, geneUniverse_19,
                  geneUniverse_20, geneUniverse_21,
                  geneUniverse_22, geneUniverse_23,
                  geneUniverse_24, geneUniverse_25,
                  geneUniverse_26)

table(universes[[1]] == geneUniverse_1)

enrich.results=list(enrich.result_1, enrich.result_3,
                    enrich.result_4,
                    enrich.result_5,
                    enrich.result_6,
                    enrich.result_7,
                    enrich.result_8,
                    enrich.result_9,
                    enrich.result_10,
                    enrich.result_11,
                    enrich.result_12,
                    enrich.result_13,
                    enrich.result_14,
                    enrich.result_15,
                    enrich.result_16,
                    enrich.result_17,
                    enrich.result_18,
                    enrich.result_19,
                    enrich.result_20,
                    enrich.result_21,
                    enrich.result_22,
                    enrich.result_23,
                    enrich.result_24,
                    enrich.result_25,
                    enrich.result_26)


```



```{r, warning=TRUE, error=FALSE}

for (i in 1:length(listOfData)){
  universe<-universes[[i]]
  enrich.result<-enrich.results[[i]]
  genesIn <- listOfData[[i]]
  comparison <- comparisonsNames[i]
  enrich.r <- enrich.result
  cat("##################################")
  cat("\nComparison: ", comparison,"\n")
  print(head(enrich.r))
}





```

Seguimos quitando el 2 y el 27.

```{r, warning=TRUE, error=TRUE}
enrich.result<-enrich.results[[24]]
enrich.r <- enrich.result

barplot(enrich.r, showCategory = 15, font.size = 4,
title = paste0("Reactome Pathway Analysis for ", comparison,". Barplot"))

cnetplot(enrich.r, categorySize = "geneNum", schowCategory = 15, vertex.label.cex = 0.75)


enrich.result<-enrich.results[[25]]
enrich.r <- enrich.result

barplot(enrich.r, showCategory = 15, font.size = 4,
title = paste0("Reactome Pathway Analysis for ", comparison,". Barplot"))

cnetplot(enrich.r, categorySize = "geneNum", schowCategory = 15, vertex.label.cex = 0.75)





```

```{r, warning=TRUE, error=TRUE}
enrich.result<-enrich.results[[1]]
enrich.r <- enrich.result
Path<-enrich.r@result[["ID"]]
Biological_Description<-enrich.r@result[["Description"]]
Gene<-enrich.r@result[["geneID"]]
GSE33470_CD3 <-data.frame(Path, Biological_Description, Gene)



enrich.result<-enrich.results[[2]]
enrich.r <- enrich.result
Path<-enrich.r@result[["ID"]]
Biological_Description<-enrich.r@result[["Description"]]
Gene<-enrich.r@result[["geneID"]]
GSE33470_CD34CD4 <-data.frame(Path, Biological_Description, Gene)

enrich.result<-enrich.results[[3]]
enrich.r <- enrich.result
Path<-enrich.r@result[["ID"]]
Biological_Description<-enrich.r@result[["Description"]]
Gene<-enrich.r@result[["geneID"]]
GSE33470_CD34DPCD3 <-data.frame(Path, Biological_Description, Gene)


enrich.result<-enrich.results[[4]]
enrich.r <- enrich.result
Path<-enrich.r@result[["ID"]]
Biological_Description<-enrich.r@result[["Description"]]
Gene<-enrich.r@result[["geneID"]]
GSE33470_CD34masmasCD4 <-data.frame(Path, Biological_Description, Gene)


enrich.result<-enrich.results[[5]]
enrich.r <- enrich.result
Path<-enrich.r@result[["ID"]]
Biological_Description<-enrich.r@result[["Description"]]
Gene<-enrich.r@result[["geneID"]]
GSE33470_CD34masmasDPCD3mas <-data.frame(Path, Biological_Description, Gene)

# CD3, CD34CD4, CD34DPCD3, CD34masmasCD4, CD34masmasDPCD3mas, CD34masmasDPCD3menos, CD34masmenosCD4, CD34masmenosDPCD3mas, CD34masmenosDPCD3menos, CD3CD34, CD3CD4, CD3DPCD3, CD4CD34masmas, CD3masCD4CD34masmeno, CD3masCD4CD4, CD3masCD4DPCD3mas, CD3masCD4DPCD3menos, CD3masCD8CD34masmas, CD3masCD8CD34masmenos, CD3masCD8CD4, CD3masCD8DPCD3mas, CD3masCD8DPCD3menos, CD4DPCD3, CD4DPCD3mas, CD4DPCD3menos

enrich.result<-enrich.results[[6]]
enrich.r <- enrich.result
Path<-enrich.r@result[["ID"]]
Biological_Description<-enrich.r@result[["Description"]]
Gene<-enrich.r@result[["geneID"]]
GSE33470_CD34masmasDPCD3menos <-data.frame(Path, Biological_Description, Gene)



enrich.result<-enrich.results[[7]]
enrich.r <- enrich.result
Path<-enrich.r@result[["ID"]]
Biological_Description<-enrich.r@result[["Description"]]
Gene<-enrich.r@result[["geneID"]]
GSE33470_CD34masmenosCD4 <-data.frame(Path, Biological_Description, Gene)

enrich.result<-enrich.results[[8]]
enrich.r <- enrich.result
Path<-enrich.r@result[["ID"]]
Biological_Description<-enrich.r@result[["Description"]]
Gene<-enrich.r@result[["geneID"]]
GSE33470_CD34masmenosDPCD3mas <-data.frame(Path, Biological_Description, Gene)


enrich.result<-enrich.results[[9]]
enrich.r <- enrich.result
Path<-enrich.r@result[["ID"]]
Biological_Description<-enrich.r@result[["Description"]]
Gene<-enrich.r@result[["geneID"]]
GSE33470_CD34masmenosDPCD3menos <-data.frame(Path, Biological_Description, Gene)


enrich.result<-enrich.results[[10]]
enrich.r <- enrich.result
Path<-enrich.r@result[["ID"]]
Biological_Description<-enrich.r@result[["Description"]]
Gene<-enrich.r@result[["geneID"]]
GSE33470_CD3CD34 <-data.frame(Path, Biological_Description, Gene)

# CD3CD4, CD3DPCD3, CD4CD34masmas, CD3masCD4CD34masmeno, CD3masCD4CD4, CD3masCD4DPCD3mas, CD3masCD4DPCD3menos, CD3masCD8CD34masmas, CD3masCD8CD34masmenos, CD3masCD8CD4, CD3masCD8DPCD3mas, CD3masCD8DPCD3menos, CD4DPCD3, CD4DPCD3mas, CD4DPCD3menos

enrich.result<-enrich.results[[11]]
enrich.r <- enrich.result
Path<-enrich.r@result[["ID"]]
Biological_Description<-enrich.r@result[["Description"]]
Gene<-enrich.r@result[["geneID"]]
GSE33470_CD3CD4 <-data.frame(Path, Biological_Description, Gene)



enrich.result<-enrich.results[[12]]
enrich.r <- enrich.result
Path<-enrich.r@result[["ID"]]
Biological_Description<-enrich.r@result[["Description"]]
Gene<-enrich.r@result[["geneID"]]
GSE33470_CD3DPCD3 <-data.frame(Path, Biological_Description, Gene)

enrich.result<-enrich.results[[13]]
enrich.r <- enrich.result
Path<-enrich.r@result[["ID"]]
Biological_Description<-enrich.r@result[["Description"]]
Gene<-enrich.r@result[["geneID"]]
GSE33470_CD4CD34masmas <-data.frame(Path, Biological_Description, Gene)


enrich.result<-enrich.results[[14]]
enrich.r <- enrich.result
Path<-enrich.r@result[["ID"]]
Biological_Description<-enrich.r@result[["Description"]]
Gene<-enrich.r@result[["geneID"]]
GSE33470_CD3masCD4CD34masmeno <-data.frame(Path, Biological_Description, Gene)


enrich.result<-enrich.results[[15]]
enrich.r <- enrich.result
Path<-enrich.r@result[["ID"]]
Biological_Description<-enrich.r@result[["Description"]]
Gene<-enrich.r@result[["geneID"]]
GSE33470_CD3masCD4CD4 <-data.frame(Path, Biological_Description, Gene)


enrich.result<-enrich.results[[16]]
enrich.r <- enrich.result
Path<-enrich.r@result[["ID"]]
Biological_Description<-enrich.r@result[["Description"]]
Gene<-enrich.r@result[["geneID"]]
GSE33470_CD3masCD4DPCD3mas <-data.frame(Path, Biological_Description, Gene)



enrich.result<-enrich.results[[17]]
enrich.r <- enrich.result
Path<-enrich.r@result[["ID"]]
Biological_Description<-enrich.r@result[["Description"]]
Gene<-enrich.r@result[["geneID"]]
GSE33470_CD3masCD4DPCD3menos <-data.frame(Path, Biological_Description, Gene)

enrich.result<-enrich.results[[18]]
enrich.r <- enrich.result
Path<-enrich.r@result[["ID"]]
Biological_Description<-enrich.r@result[["Description"]]
Gene<-enrich.r@result[["geneID"]]
GSE33470_CD3masCD8CD34masmas <-data.frame(Path, Biological_Description, Gene)


# CD3masCD4DPCD3mas, CD3masCD4DPCD3menos, CD3masCD8CD34masmas, CD3masCD8CD34masmenos, CD3masCD8CD4, CD3masCD8DPCD3mas, CD3masCD8DPCD3menos, CD4DPCD3, CD4DPCD3mas, CD4DPCD3menos

enrich.result<-enrich.results[[19]]
enrich.r <- enrich.result
Path<-enrich.r@result[["ID"]]
Biological_Description<-enrich.r@result[["Description"]]
Gene<-enrich.r@result[["geneID"]]
GSE33470_CD3masCD8CD34masmenos <-data.frame(Path, Biological_Description, Gene)


enrich.result<-enrich.results[[20]]
enrich.r <- enrich.result
Path<-enrich.r@result[["ID"]]
Biological_Description<-enrich.r@result[["Description"]]
Gene<-enrich.r@result[["geneID"]]
GSE33470_CD3masCD8CD4 <-data.frame(Path, Biological_Description, Gene)


enrich.result<-enrich.results[[21]]
enrich.r <- enrich.result
Path<-enrich.r@result[["ID"]]
Biological_Description<-enrich.r@result[["Description"]]
Gene<-enrich.r@result[["geneID"]]
GSE33470_CD3masCD8DPCD3mas <-data.frame(Path, Biological_Description, Gene)



enrich.result<-enrich.results[[22]]
enrich.r <- enrich.result
Path<-enrich.r@result[["ID"]]
Biological_Description<-enrich.r@result[["Description"]]
Gene<-enrich.r@result[["geneID"]]
GSE33470_CD3masCD8DPCD3menos <-data.frame(Path, Biological_Description, Gene)

enrich.result<-enrich.results[[23]]
enrich.r <- enrich.result
Path<-enrich.r@result[["ID"]]
Biological_Description<-enrich.r@result[["Description"]]
Gene<-enrich.r@result[["geneID"]]
GSE33470_CD4DPCD3 <-data.frame(Path, Biological_Description, Gene)


enrich.result<-enrich.results[[24]]
enrich.r <- enrich.result
Path<-enrich.r@result[["ID"]]
Biological_Description<-enrich.r@result[["Description"]]
Gene<-enrich.r@result[["geneID"]]
GSE33470_CD4DPCD3mas <-data.frame(Path, Biological_Description, Gene)


enrich.result<-enrich.results[[25]]
enrich.r <- enrich.result
Path<-enrich.r@result[["ID"]]
Biological_Description<-enrich.r@result[["Description"]]
Gene<-enrich.r@result[["geneID"]]
GSE33470_CD4DPCD3menos <-data.frame(Path, Biological_Description, Gene)

ls(pattern = 'GSE33470_C')

```



```{r, warning=TRUE, error=FALSE}

library("xlsx")
write.xlsx(GSE33470_CD3, 'C:/Users/Copito/OneDrive/Documentos/Master bioinf y bioest/TFM/datasets/GSE33470/Resultado_GSE33470_CD3.xlsx', row.names = FALSE,
           col.names = TRUE)
write.xlsx(GSE33470_CD34CD4, 'C:/Users/Copito/OneDrive/Documentos/Master bioinf y bioest/TFM/datasets/GSE33470/Resultado_GSE33470_CD34CD4.xlsx', row.names = FALSE,
           col.names = TRUE)
write.xlsx(GSE33470_CD34DPCD3, 'C:/Users/Copito/OneDrive/Documentos/Master bioinf y bioest/TFM/datasets/GSE33470/Resultado_GSE33470_CD34DPCD3.xlsx', row.names = FALSE,
           col.names = TRUE)
write.xlsx(GSE33470_CD34masmasCD4, 'C:/Users/Copito/OneDrive/Documentos/Master bioinf y bioest/TFM/datasets/GSE33470/Resultado_GSE33470_CD34masmasCD4.xlsx', row.names = FALSE,
           col.names = TRUE)
write.xlsx(GSE33470_CD34masmasDPCD3mas, 'C:/Users/Copito/OneDrive/Documentos/Master bioinf y bioest/TFM/datasets/GSE33470/Resultado_GSE33470_CD34masmasDPCD3mas.xlsx', row.names = FALSE,
           col.names = TRUE)
write.xlsx(GSE33470_CD34masmasDPCD3menos, 'C:/Users/Copito/OneDrive/Documentos/Master bioinf y bioest/TFM/datasets/GSE33470/Resultado_GSE33470_CD34masmasDPCD3menos.xlsx', row.names = FALSE,
           col.names = TRUE)
write.xlsx(GSE33470_CD34masmenosCD4, 'C:/Users/Copito/OneDrive/Documentos/Master bioinf y bioest/TFM/datasets/GSE33470/Resultado_GSE33470_CD34masmenosCD4.xlsx', row.names = FALSE,
           col.names = TRUE)
write.xlsx(GSE33470_CD34masmenosDPCD3mas, 'C:/Users/Copito/OneDrive/Documentos/Master bioinf y bioest/TFM/datasets/GSE33470/Resultado_GSE33470_CD34masmenosDPCD3mas.xlsx', row.names = FALSE,
           col.names = TRUE)
write.xlsx(GSE33470_CD34masmenosDPCD3menos, 'C:/Users/Copito/OneDrive/Documentos/Master bioinf y bioest/TFM/datasets/GSE33470/Resultado_GSE33470_CD34masmenosDPCD3menos.xlsx', row.names = FALSE,
           col.names = TRUE)
write.xlsx(GSE33470_CD3CD34, 'C:/Users/Copito/OneDrive/Documentos/Master bioinf y bioest/TFM/datasets/GSE33470/Resultado_GSE33470_CD3CD34.xlsx', row.names = FALSE,
           col.names = TRUE)
write.xlsx(GSE33470_CD3CD4, 'C:/Users/Copito/OneDrive/Documentos/Master bioinf y bioest/TFM/datasets/GSE33470/Resultado_GSE33470_CD3CD4.xlsx', row.names = FALSE,
           col.names = TRUE)
write.xlsx(GSE33470_CD3DPCD3, 'C:/Users/Copito/OneDrive/Documentos/Master bioinf y bioest/TFM/datasets/GSE33470/Resultado_GSE33470_CD3DPCD3.xlsx', row.names = FALSE,
           col.names = TRUE)
write.xlsx(GSE33470_CD3masCD4CD34masmeno, 'C:/Users/Copito/OneDrive/Documentos/Master bioinf y bioest/TFM/datasets/GSE33470/Resultado_GSE33470_CD3masCD4CD34masmeno.xlsx', row.names = FALSE,
           col.names = TRUE)
write.xlsx(GSE33470_CD3masCD4CD4, 'C:/Users/Copito/OneDrive/Documentos/Master bioinf y bioest/TFM/datasets/GSE33470/Resultado_GSE33470_CD3masCD4CD4.xlsx', row.names = FALSE,
           col.names = TRUE)
write.xlsx(GSE33470_CD3masCD4DPCD3mas, 'C:/Users/Copito/OneDrive/Documentos/Master bioinf y bioest/TFM/datasets/GSE33470/Resultado_GSE33470_CD3masCD4DPCD3mas.xlsx', row.names = FALSE,
           col.names = TRUE)
write.xlsx(GSE33470_CD3masCD4DPCD3menos, 'C:/Users/Copito/OneDrive/Documentos/Master bioinf y bioest/TFM/datasets/GSE33470/Resultado_GSE33470_CD3masCD4DPCD3menos.xlsx', row.names = FALSE,
           col.names = TRUE)
write.xlsx(GSE33470_CD3masCD8CD34masmas, 'C:/Users/Copito/OneDrive/Documentos/Master bioinf y bioest/TFM/datasets/GSE33470/Resultado_GSE33470_CD3masCD8CD34masmas.xlsx', row.names = FALSE,
           col.names = TRUE)
write.xlsx(GSE33470_CD3masCD8CD34masmenos, 'C:/Users/Copito/OneDrive/Documentos/Master bioinf y bioest/TFM/datasets/GSE33470/Resultado_GSE33470_CD3masCD8CD34masmenos.xlsx', row.names = FALSE,
           col.names = TRUE)
write.xlsx(GSE33470_CD3masCD8CD4, 'C:/Users/Copito/OneDrive/Documentos/Master bioinf y bioest/TFM/datasets/GSE33470/Resultado_GSE33470_CD3masCD8CD4.xlsx', row.names = FALSE,
           col.names = TRUE)
write.xlsx(GSE33470_CD3masCD8DPCD3mas, 'C:/Users/Copito/OneDrive/Documentos/Master bioinf y bioest/TFM/datasets/GSE33470/Resultado_GSE33470_CD3masCD8DPCD3mas.xlsx', row.names = FALSE,
           col.names = TRUE)
write.xlsx(GSE33470_CD3masCD8DPCD3menos, 'C:/Users/Copito/OneDrive/Documentos/Master bioinf y bioest/TFM/datasets/GSE33470/Resultado_GSE33470_CD3masCD8DPCD3menos.xlsx', row.names = FALSE,
           col.names = TRUE)


write.xlsx(GSE33470_CD4CD34masmas, 'C:/Users/Copito/OneDrive/Documentos/Master bioinf y bioest/TFM/datasets/GSE33470/Resultado_GSE33470_CD4CD34masmas.xlsx', row.names = FALSE,
           col.names = TRUE)
write.xlsx(GSE33470_CD4DPCD3, 'C:/Users/Copito/OneDrive/Documentos/Master bioinf y bioest/TFM/datasets/GSE33470/Resultado_GSE33470_CD4DPCD3.xlsx', row.names = FALSE,
           col.names = TRUE)
write.xlsx(GSE33470_CD4DPCD3mas, 'C:/Users/Copito/OneDrive/Documentos/Master bioinf y bioest/TFM/datasets/GSE33470/Resultado_GSE33470_CD4DPCD3mas.xlsx', row.names = FALSE,
           col.names = TRUE)
write.xlsx(GSE33470_CD4DPCD3menos, 'C:/Users/Copito/OneDrive/Documentos/Master bioinf y bioest/TFM/datasets/GSE33470/Resultado_GSE33470_CD4DPCD3menos.xlsx', row.names = FALSE,
           col.names = TRUE)

```

# GSE37389
## Análisis de significación biológica

Métodos de análisis



```{r, warning=TRUE, error=FALSE}
load('C:/Users/Copito/OneDrive/Documentos/Master bioinf y bioest/TFM/datasets/GSE37389/GSE37389datos.normalizados.Rda')
load('C:/Users/Copito/OneDrive/Documentos/Master bioinf y bioest/TFM/datasets/GSE37389/GSE37389topTab_Anot.Rda')
```


```{r, warning=TRUE, error=FALSE}
ls(pattern = 'topTab')
```



```{r, warning=TRUE, error=TRUE}
library(dplyr)


(selGenes_GSE37389 <- (topTab_GSE37389_Anot %>%
    subset(adj.P.Val < 0.05) %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1])

geneUniverse_GSE37389 <- (topTab_GSE37389_Anot %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]




```

Ejecución del análisis de enriquecimiento

El análisis es relativamente sencillo y muy parecido entre distintos paquetes.


```{r, warning=TRUE, error=TRUE}

library (Category)
library (hgug4112a.db)
library(GOstats)


GOparamsGSE37389 <- new("GOHyperGParams", geneIds = selGenes_GSE37389, universeGeneIds = geneUniverse_GSE37389,
    annotation = "hgug4112a.db", ontology = "BP", pvalueCutoff = 0.05, conditional = FALSE,
    testDirection = "over")

KEGGparamsGSE37389 <- new("KEGGHyperGParams", geneIds = selGenes_GSE37389, universeGeneIds = geneUniverse_GSE37389,
    annotation = "hgug4112a.db", pvalueCutoff = 0.05)

# Ejecutamos los análisis
GOHyper_GSE37389 <- hyperGTest(GOparamsGSE37389)
KEGGHyper_GSE37389 <- hyperGTest(KEGGparamsGSE37389)



```



Resultados

Los resultados del análisis se encuentran en un objeto que se puede visualizar directamente.

```{r, warning=TRUE, error=TRUE}
summary(GOHyper_GSE37389)
summary(KEGGHyper_GSE37389)
```

Una mejor opción es exportarlos a un archivo, preferentemente con hiperenlaces que permitan una exploración directa de las categorías

----------



```{r, warning=TRUE, error=TRUE}
library(dplyr)

a <- (selGenes_4 %>%
          subset(P.Value < 0.05))
unique(a$ENTREZID)

library(ReactomePA)
enrich.result_GSE37389 <- enrichPathway(gene = selGenes_GSE37389,
                               pvalueCutoff = 0.05,
                               readable = T,
                               organism = "human",
                               universe = geneUniverse_GSE37389)

```

No obtenemos nada..... 

# GSE62156



## Análisis de significación biológica




```{r, warning=TRUE, error=FALSE}
load('C:/Users/Copito/OneDrive/Documentos/Master bioinf y bioest/TFM/datasets/GSE62156/GSE62156datos.normalizados.Rda')
load('C:/Users/Copito/OneDrive/Documentos/Master bioinf y bioest/TFM/datasets/GSE62156/GSE62156topTab_Anot.Rda')
```


```{r, warning=TRUE, error=FALSE}
ls(pattern = 'topTab')
```



```{r, warning=TRUE, error=TRUE}
library(dplyr)


selGenes_1 <- (topTab_GSE62156_1_Anot %>%
    subset(adj.P.Val < 0.05) %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]

geneUniverse_1 <- (topTab_GSE62156_1_Anot %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]


selGenes_2 <- (topTab_GSE62156_2_Anot %>%
    subset(adj.P.Val < 0.05) %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]

geneUniverse_2 <- (topTab_GSE62156_2_Anot %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]


selGenes_3 <- (topTab_GSE62156_3_Anot %>%
    subset(adj.P.Val < 0.05) %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]

geneUniverse_3 <- (topTab_GSE62156_3_Anot %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]


selGenes_4 <- (topTab_GSE62156_4_Anot %>%
    subset(adj.P.Val < 0.05) %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]

geneUniverse_4 <- (topTab_GSE62156_4_Anot %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]


selGenes_5 <- (topTab_GSE62156_5_Anot %>%
    subset(adj.P.Val < 0.05) %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]

geneUniverse_5 <- (topTab_GSE62156_5_Anot %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]
  
 

selGenes_6 <- (topTab_GSE62156_6_Anot %>%
    subset(adj.P.Val < 0.05) %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]

geneUniverse_6 <- (topTab_GSE62156_6_Anot %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]

selGenes_7 <- (topTab_GSE62156_7_Anot %>%
    subset(adj.P.Val < 0.05) %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]

geneUniverse_7 <- (topTab_GSE62156_7_Anot %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]


selGenes_8 <- (topTab_GSE62156_8_Anot %>%
    subset(adj.P.Val < 0.05) %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]

geneUniverse_8 <- (topTab_GSE62156_8_Anot %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]


selGenes_9 <- (topTab_GSE62156_9_Anot %>%
    subset(adj.P.Val < 0.05) %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]

geneUniverse_9 <- (topTab_GSE62156_9_Anot %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]






selGenes_9REAL <- (topTab_GSE62156_9REAL_Anot %>%
    subset(adj.P.Val < 0.05) %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]

geneUniverse_9REAL <- (topTab_GSE62156_9REAL_Anot %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]




   
selGenes_10 <- (topTab_GSE62156_10_Anot %>%
    subset(adj.P.Val < 0.05) %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]

geneUniverse_10 <- (topTab_GSE62156_10_Anot %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]


selGenes_11 <- (topTab_GSE62156_11_Anot %>%
    subset(adj.P.Val < 0.05) %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]

geneUniverse_11 <- (topTab_GSE62156_11_Anot %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]


selGenes_12 <- (topTab_GSE62156_12_Anot %>%
    subset(adj.P.Val < 0.05) %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]

geneUniverse_12 <- (topTab_GSE62156_12_Anot %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]


selGenes_13 <- (topTab_GSE62156_13_Anot %>%
    subset(adj.P.Val < 0.05) %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]

geneUniverse_13 <- (topTab_GSE62156_13_Anot %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]


selGenes_14 <- (topTab_GSE62156_14_Anot %>%
    subset(adj.P.Val < 0.05) %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]

geneUniverse_14 <- (topTab_GSE62156_14_Anot %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]


selGenes_15 <- (topTab_GSE62156_15_Anot %>%
    subset(adj.P.Val < 0.05) %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]

geneUniverse_15 <- (topTab_GSE62156_15_Anot %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]


selGenes_16 <- (topTab_GSE62156_16_Anot %>%
    subset(adj.P.Val < 0.05) %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]

geneUniverse_16 <- (topTab_GSE62156_16_Anot %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]



selGenes_17 <- (topTab_GSE62156_17_Anot %>%
    subset(adj.P.Val < 0.05) %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]

geneUniverse_17 <- (topTab_GSE62156_17_Anot %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]



selGenes_18 <- (topTab_GSE62156_18_Anot %>%
    subset(adj.P.Val < 0.05) %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]

geneUniverse_18 <- (topTab_GSE62156_18_Anot %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]


selGenes_19 <- (topTab_GSE62156_19_Anot %>%
    subset(adj.P.Val < 0.05) %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]

geneUniverse_19 <- (topTab_GSE62156_19_Anot %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]


selGenes_20 <- (topTab_GSE62156_20_Anot %>%
    subset(adj.P.Val < 0.05) %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]

geneUniverse_20 <- (topTab_GSE62156_20_Anot %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]


selGenes_21 <- (topTab_GSE62156_21_Anot %>%
    subset(adj.P.Val < 0.05) %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]

geneUniverse_21 <- (topTab_GSE62156_21_Anot %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]


selGenes_22 <- (topTab_GSE62156_22_Anot %>%
    subset(adj.P.Val < 0.05) %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]

geneUniverse_22 <- (topTab_GSE62156_22_Anot %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]


selGenes_23 <- (topTab_GSE62156_23_Anot %>%
    subset(adj.P.Val < 0.05) %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]

geneUniverse_23 <- (topTab_GSE62156_23_Anot %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]


selGenes_24 <- (topTab_GSE62156_24_Anot %>%
    subset(adj.P.Val < 0.05) %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]

geneUniverse_24 <- (topTab_GSE62156_24_Anot %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]


selGenes_25 <- (topTab_GSE62156_25_Anot %>%
    subset(adj.P.Val < 0.05) %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]

geneUniverse_25 <- (topTab_GSE62156_25_Anot %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]


selGenes_26 <- (topTab_GSE62156_26_Anot %>%
    subset(adj.P.Val < 0.05) %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]

geneUniverse_26 <- (topTab_GSE62156_26_Anot %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]


selGenes_27 <- (topTab_GSE62156_27_Anot %>%
    subset(adj.P.Val < 0.05) %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]

geneUniverse_27 <- (topTab_GSE62156_27_Anot %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]


selGenes_28 <- (topTab_GSE62156_28_Anot %>%
    subset(adj.P.Val < 0.05) %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]

geneUniverse_28 <- (topTab_GSE62156_28_Anot %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]



selGenes_29 <- (topTab_GSE62156_29_Anot %>%
    subset(adj.P.Val < 0.05) %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]

geneUniverse_29 <- (topTab_GSE62156_29_Anot %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]



selGenes_30 <- (topTab_GSE62156_30_Anot %>%
    subset(adj.P.Val < 0.05) %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]

geneUniverse_30 <- (topTab_GSE62156_30_Anot %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]


selGenes_31 <- (topTab_GSE62156_31_Anot %>%
    subset(adj.P.Val < 0.05) %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]

geneUniverse_31 <- (topTab_GSE62156_31_Anot %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]


selGenes_32 <- (topTab_GSE62156_32_Anot %>%
    subset(adj.P.Val < 0.05) %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]

geneUniverse_32 <- (topTab_GSE62156_32_Anot %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]


selGenes_33 <- (topTab_GSE62156_33_Anot %>%
    subset(adj.P.Val < 0.05) %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]

geneUniverse_33 <- (topTab_GSE62156_33_Anot %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]


selGenes_34 <- (topTab_GSE62156_34_Anot %>%
    subset(adj.P.Val < 0.05) %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]

geneUniverse_34 <- (topTab_GSE62156_34_Anot %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]


selGenes_35 <- (topTab_GSE62156_35_Anot %>%
    subset(adj.P.Val < 0.05) %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]

geneUniverse_35 <- (topTab_GSE62156_35_Anot %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]


selGenes_36 <- (topTab_GSE62156_36_Anot %>%
    subset(adj.P.Val < 0.05) %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]

geneUniverse_36 <- (topTab_GSE62156_36_Anot %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]




selGenes_36REAL <- (topTab_GSE62156_36REAL_Anot %>%
    subset(adj.P.Val < 0.05) %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]

geneUniverse_36REAL <- (topTab_GSE62156_36REAL_Anot %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]




selGenes_37 <- (topTab_GSE62156_37_Anot %>%
    subset(adj.P.Val < 0.05) %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]

geneUniverse_37 <- (topTab_GSE62156_37_Anot %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]


selGenes_38 <- (topTab_GSE62156_38_Anot %>%
    subset(adj.P.Val < 0.05) %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]

geneUniverse_38 <- (topTab_GSE62156_38_Anot %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]


selGenes_39 <- (topTab_GSE62156_39_Anot %>%
    subset(adj.P.Val < 0.05) %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]

geneUniverse_39 <- (topTab_GSE62156_39_Anot %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]



selGenes_40 <- (topTab_GSE62156_40_Anot %>%
    subset(adj.P.Val < 0.05) %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]

geneUniverse_40 <- (topTab_GSE62156_40_Anot %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]


selGenes_41 <- (topTab_GSE62156_41_Anot %>%
    subset(adj.P.Val < 0.05) %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]

geneUniverse_41 <- (topTab_GSE62156_41_Anot %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]


selGenes_42 <- (topTab_GSE62156_42_Anot %>%
    subset(adj.P.Val < 0.05) %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]

geneUniverse_42 <- (topTab_GSE62156_42_Anot %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]


selGenes_43 <- (topTab_GSE62156_43_Anot %>%
    subset(adj.P.Val < 0.05) %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]

geneUniverse_43 <- (topTab_GSE62156_43_Anot %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]


selGenes_44 <- (topTab_GSE62156_44_Anot %>%
    subset(adj.P.Val < 0.05) %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]

geneUniverse_44 <- (topTab_GSE62156_44_Anot %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]


selGenes_45 <- (topTab_GSE62156_45_Anot %>%
    subset(adj.P.Val < 0.05) %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]

geneUniverse_45 <- (topTab_GSE62156_45_Anot %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]


selGenes_46 <- (topTab_GSE62156_46_Anot %>%
    subset(adj.P.Val < 0.05) %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]

geneUniverse_46 <- (topTab_GSE62156_46_Anot %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]


selGenes_47 <- (topTab_GSE62156_47_Anot %>%
    subset(adj.P.Val < 0.05) %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]

geneUniverse_47 <- (topTab_GSE62156_47_Anot %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]

selGenes_48 <- (topTab_GSE62156_48_Anot %>%
    subset(adj.P.Val < 0.05) %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]

geneUniverse_48 <- (topTab_GSE62156_48_Anot %>%
    dplyr::select(ENTREZID) %>%
    unique)[, 1]




# La notación anterior pretende ser más clara y acorde con las tendencias
# actuales en R EL mismo resultado se habría podido obtener con un enfoque más
# clásico aunque algo más críptico : selGenes_SoloToxico<-
# unique(subset(topTab_SoloToxico_Anot, adj.P.Val < 0.05)$ENTREZID)
# selGenes_ToxicoEnMet <-unique(subset(topTab_ToxicoEnMet, adj.P.Val <
# 0.05)$ENTREZID) geneUniverse <- unique(topTab_ToxicoEnMet$ENTREZID)

```

Ejecución del análisis de enriquecimiento

El análisis es relativamente sencillo y muy parecido entre distintos paquetes.


```{r, warning=TRUE, error=TRUE}

library (Category)
library (hgu133plus2.db)
library(GOstats)


GOparams1 <- new("GOHyperGParams", geneIds = selGenes_1, universeGeneIds = geneUniverse_1,
    annotation = "hgu133plus2.db", ontology = "BP", pvalueCutoff = 0.05, conditional = FALSE,
    testDirection = "over")

KEGGparams1 <- new("KEGGHyperGParams", geneIds = selGenes_1, universeGeneIds = geneUniverse_1,
    annotation = "hgu133plus2.db", pvalueCutoff = 0.05)

# Ejecutamos los análisis
GOHyper1 <- hyperGTest(GOparams1)
KEGGHyper1 <- hyperGTest(KEGGparams1)


#--
GOparams2 <- new("GOHyperGParams", geneIds = selGenes_2, universeGeneIds = geneUniverse_2,
    annotation = "hgu133plus2.db", ontology = "BP", pvalueCutoff = 0.05, conditional = FALSE,
    testDirection = "over")

KEGGparams2 <- new("KEGGHyperGParams", geneIds = selGenes_2, universeGeneIds = geneUniverse_2,
    annotation = "hgu133plus2.db", pvalueCutoff = 0.05)

# Ejecutamos los análisis
GOHyper2 <- hyperGTest(GOparams2)
KEGGHyper2 <- hyperGTest(KEGGparams2)

#--
GOparams3 <- new("GOHyperGParams", geneIds = selGenes_3, universeGeneIds = geneUniverse_3,
    annotation = "hgu133plus2.db", ontology = "BP", pvalueCutoff = 0.05, conditional = FALSE,
    testDirection = "over")

KEGGparams3 <- new("KEGGHyperGParams", geneIds = selGenes_3, universeGeneIds = geneUniverse_3,
    annotation = "hgu133plus2.db", pvalueCutoff = 0.05)

# Ejecutamos los análisis
GOHyper3 <- hyperGTest(GOparams3)
KEGGHyper3 <- hyperGTest(KEGGparams3)


#--
GOparams4 <- new("GOHyperGParams", geneIds = selGenes_4, universeGeneIds = geneUniverse_4,
    annotation = "hgu133plus2.db", ontology = "BP", pvalueCutoff = 0.05, conditional = FALSE,
    testDirection = "over")

KEGGparams4 <- new("KEGGHyperGParams", geneIds = selGenes_4, universeGeneIds = geneUniverse_4,
    annotation = "hgu133plus2.db", pvalueCutoff = 0.05)

# Ejecutamos los análisis
GOHyper4 <- hyperGTest(GOparams4)
KEGGHyper4 <- hyperGTest(KEGGparams4)


#--
GOparams5 <- new("GOHyperGParams", geneIds = selGenes_5, universeGeneIds = geneUniverse_5,
    annotation = "hgu133plus2.db", ontology = "BP", pvalueCutoff = 0.05, conditional = FALSE,
    testDirection = "over")

KEGGparams5 <- new("KEGGHyperGParams", geneIds = selGenes_5, universeGeneIds = geneUniverse_5,
    annotation = "hgu133plus2.db", pvalueCutoff = 0.05)

# Ejecutamos los análisis
GOHyper5 <- hyperGTest(GOparams5)
KEGGHyper5 <- hyperGTest(KEGGparams5)



#--
GOparams6 <- new("GOHyperGParams", geneIds = selGenes_6, universeGeneIds = geneUniverse_6,
    annotation = "hgu133plus2.db", ontology = "BP", pvalueCutoff = 0.05, conditional = FALSE,
    testDirection = "over")

KEGGparams6 <- new("KEGGHyperGParams", geneIds = selGenes_6, universeGeneIds = geneUniverse_6,
    annotation = "hgu133plus2.db", pvalueCutoff = 0.05)

# Ejecutamos los análisis
GOHyper6 <- hyperGTest(GOparams6)
KEGGHyper6 <- hyperGTest(KEGGparams6)


#--
GOparams7 <- new("GOHyperGParams", geneIds = selGenes_7, universeGeneIds = geneUniverse_7,
    annotation = "hgu133plus2.db", ontology = "BP", pvalueCutoff = 0.05, conditional = FALSE,
    testDirection = "over")

KEGGparams7 <- new("KEGGHyperGParams", geneIds = selGenes_7, universeGeneIds = geneUniverse_7,
    annotation = "hgu133plus2.db", pvalueCutoff = 0.05)

# Ejecutamos los análisis
GOHyper7 <- hyperGTest(GOparams7)
KEGGHyper7 <- hyperGTest(KEGGparams7)


#--
GOparams8 <- new("GOHyperGParams", geneIds = selGenes_8, universeGeneIds = geneUniverse_8,
    annotation = "hgu133plus2.db", ontology = "BP", pvalueCutoff = 0.05, conditional = FALSE,
    testDirection = "over")

KEGGparams8 <- new("KEGGHyperGParams", geneIds = selGenes_8, universeGeneIds = geneUniverse_8,
    annotation = "hgu133plus2.db", pvalueCutoff = 0.05)

# Ejecutamos los análisis
GOHyper8 <- hyperGTest(GOparams8)
KEGGHyper8 <- hyperGTest(KEGGparams8)


#--
GOparams9 <- new("GOHyperGParams", geneIds = selGenes_9, universeGeneIds = geneUniverse_9,
    annotation = "hgu133plus2.db", ontology = "BP", pvalueCutoff = 0.05, conditional = FALSE,
    testDirection = "over")

KEGGparams9 <- new("KEGGHyperGParams", geneIds = selGenes_9, universeGeneIds = geneUniverse_9,
    annotation = "hgu133plus2.db", pvalueCutoff = 0.05)

# Ejecutamos los análisis
GOHyper9 <- hyperGTest(GOparams9)
KEGGHyper9 <- hyperGTest(KEGGparams9)


#--


#--
GOparams9REAL <- new("GOHyperGParams", geneIds = selGenes_9REAL, universeGeneIds = geneUniverse_9REAL,
    annotation = "hgu133plus2.db", ontology = "BP", pvalueCutoff = 0.05, conditional = FALSE,
    testDirection = "over")

KEGGparams9REAL <- new("KEGGHyperGParams", geneIds = selGenes_9REAL, universeGeneIds = geneUniverse_9REAL,
    annotation = "hgu133plus2.db", pvalueCutoff = 0.05)

# Ejecutamos los análisis
GOHyper9REAL <- hyperGTest(GOparams9REAL)
KEGGHyper9REAL <- hyperGTest(KEGGparams9REAL)


#--

GOparams10 <- new("GOHyperGParams", geneIds = selGenes_10, universeGeneIds = geneUniverse_10,
    annotation = "hgu133plus2.db", ontology = "BP", pvalueCutoff = 0.05, conditional = FALSE,
    testDirection = "over")

KEGGparams10 <- new("KEGGHyperGParams", geneIds = selGenes_10, universeGeneIds = geneUniverse_10,
    annotation = "hgu133plus2.db", pvalueCutoff = 0.05)

# Ejecutamos los análisis
GOHyper10 <- hyperGTest(GOparams10)
KEGGHyper10 <- hyperGTest(KEGGparams10)


#--
GOparams11 <- new("GOHyperGParams", geneIds = selGenes_11, universeGeneIds = geneUniverse_11,
    annotation = "hgu133plus2.db", ontology = "BP", pvalueCutoff = 0.05, conditional = FALSE,
    testDirection = "over")

KEGGparams11 <- new("KEGGHyperGParams", geneIds = selGenes_11, universeGeneIds = geneUniverse_11,
    annotation = "hgu133plus2.db", pvalueCutoff = 0.05)

# Ejecutamos los análisis
GOHyper11 <- hyperGTest(GOparams11)
KEGGHyper11 <- hyperGTest(KEGGparams11)


#--
GOparams12 <- new("GOHyperGParams", geneIds = selGenes_12, universeGeneIds = geneUniverse_12,
    annotation = "hgu133plus2.db", ontology = "BP", pvalueCutoff = 0.05, conditional = FALSE,
    testDirection = "over")

KEGGparams12 <- new("KEGGHyperGParams", geneIds = selGenes_12, universeGeneIds = geneUniverse_12,
    annotation = "hgu133plus2.db", pvalueCutoff = 0.05)

# Ejecutamos los análisis
GOHyper12 <- hyperGTest(GOparams12)
KEGGHyper12 <- hyperGTest(KEGGparams12)



#--
GOparams13 <- new("GOHyperGParams", geneIds = selGenes_13, universeGeneIds = geneUniverse_13,
    annotation = "hgu133plus2.db", ontology = "BP", pvalueCutoff = 0.05, conditional = FALSE,
    testDirection = "over")

KEGGparams13 <- new("KEGGHyperGParams", geneIds = selGenes_13, universeGeneIds = geneUniverse_13,
    annotation = "hgu133plus2.db", pvalueCutoff = 0.05)

# Ejecutamos los análisis
GOHyper13 <- hyperGTest(GOparams13)
KEGGHyper13 <- hyperGTest(KEGGparams13)


#--
GOparams14 <- new("GOHyperGParams", geneIds = selGenes_14, universeGeneIds = geneUniverse_14,
    annotation = "hgu133plus2.db", ontology = "BP", pvalueCutoff = 0.05, conditional = FALSE,
    testDirection = "over")

KEGGparams14 <- new("KEGGHyperGParams", geneIds = selGenes_14, universeGeneIds = geneUniverse_14,
    annotation = "hgu133plus2.db", pvalueCutoff = 0.05)

# Ejecutamos los análisis
GOHyper14 <- hyperGTest(GOparams14)
KEGGHyper14 <- hyperGTest(KEGGparams14)



#--
GOparams15 <- new("GOHyperGParams", geneIds = selGenes_15, universeGeneIds = geneUniverse_15,
    annotation = "hgu133plus2.db", ontology = "BP", pvalueCutoff = 0.05, conditional = FALSE,
    testDirection = "over")

KEGGparams15 <- new("KEGGHyperGParams", geneIds = selGenes_15, universeGeneIds = geneUniverse_15,
    annotation = "hgu133plus2.db", pvalueCutoff = 0.05)

# Ejecutamos los análisis
GOHyper15 <- hyperGTest(GOparams15)
KEGGHyper15 <- hyperGTest(KEGGparams15)


#--
GOparams16 <- new("GOHyperGParams", geneIds = selGenes_16, universeGeneIds = geneUniverse_16,
    annotation = "hgu133plus2.db", ontology = "BP", pvalueCutoff = 0.05, conditional = FALSE,
    testDirection = "over")

KEGGparams16 <- new("KEGGHyperGParams", geneIds = selGenes_16, universeGeneIds = geneUniverse_16,
    annotation = "hgu133plus2.db", pvalueCutoff = 0.05)

# Ejecutamos los análisis
GOHyper16 <- hyperGTest(GOparams16)
KEGGHyper16 <- hyperGTest(KEGGparams16)


#--
GOparams17 <- new("GOHyperGParams", geneIds = selGenes_17, universeGeneIds = geneUniverse_17,
    annotation = "hgu133plus2.db", ontology = "BP", pvalueCutoff = 0.05, conditional = FALSE,
    testDirection = "over")

KEGGparams17 <- new("KEGGHyperGParams", geneIds = selGenes_17, universeGeneIds = geneUniverse_17,
    annotation = "hgu133plus2.db", pvalueCutoff = 0.05)

# Ejecutamos los análisis
GOHyper17 <- hyperGTest(GOparams17)
KEGGHyper17 <- hyperGTest(KEGGparams17)


#--
GOparams18 <- new("GOHyperGParams", geneIds = selGenes_18, universeGeneIds = geneUniverse_18,
    annotation = "hgu133plus2.db", ontology = "BP", pvalueCutoff = 0.05, conditional = FALSE,
    testDirection = "over")

KEGGparams18 <- new("KEGGHyperGParams", geneIds = selGenes_18, universeGeneIds = geneUniverse_18,
    annotation = "hgu133plus2.db", pvalueCutoff = 0.05)

# Ejecutamos los análisis
GOHyper18 <- hyperGTest(GOparams18)
KEGGHyper18 <- hyperGTest(KEGGparams18)


#--
GOparams19 <- new("GOHyperGParams", geneIds = selGenes_19, universeGeneIds = geneUniverse_19,
    annotation = "hgu133plus2.db", ontology = "BP", pvalueCutoff = 0.05, conditional = FALSE,
    testDirection = "over")

KEGGparams19 <- new("KEGGHyperGParams", geneIds = selGenes_19, universeGeneIds = geneUniverse_19,
    annotation = "hgu133plus2.db", pvalueCutoff = 0.05)

# Ejecutamos los análisis
GOHyper19 <- hyperGTest(GOparams19)
KEGGHyper19 <- hyperGTest(KEGGparams19)


#--
GOparams20 <- new("GOHyperGParams", geneIds = selGenes_20, universeGeneIds = geneUniverse_20,
    annotation = "hgu133plus2.db", ontology = "BP", pvalueCutoff = 0.05, conditional = FALSE,
    testDirection = "over")

KEGGparams20 <- new("KEGGHyperGParams", geneIds = selGenes_20, universeGeneIds = geneUniverse_20,
    annotation = "hgu133plus2.db", pvalueCutoff = 0.05)

# Ejecutamos los análisis
GOHyper20 <- hyperGTest(GOparams20)
KEGGHyper20 <- hyperGTest(KEGGparams20)

#--
GOparams21 <- new("GOHyperGParams", geneIds = selGenes_21, universeGeneIds = geneUniverse_21,
    annotation = "hgu133plus2.db", ontology = "BP", pvalueCutoff = 0.05, conditional = FALSE,
    testDirection = "over")

KEGGparams21 <- new("KEGGHyperGParams", geneIds = selGenes_21, universeGeneIds = geneUniverse_21,
    annotation = "hgu133plus2.db", pvalueCutoff = 0.05)

# Ejecutamos los análisis
GOHyper21 <- hyperGTest(GOparams21)
KEGGHyper21 <- hyperGTest(KEGGparams21)

#--
GOparams22 <- new("GOHyperGParams", geneIds = selGenes_22, universeGeneIds = geneUniverse_22,
    annotation = "hgu133plus2.db", ontology = "BP", pvalueCutoff = 0.05, conditional = FALSE,
    testDirection = "over")

KEGGparams22 <- new("KEGGHyperGParams", geneIds = selGenes_22, universeGeneIds = geneUniverse_22,
    annotation = "hgu133plus2.db", pvalueCutoff = 0.05)

# Ejecutamos los análisis
GOHyper22 <- hyperGTest(GOparams22)
KEGGHyper22 <- hyperGTest(KEGGparams22)


#--
GOparams23 <- new("GOHyperGParams", geneIds = selGenes_23, universeGeneIds = geneUniverse_23,
    annotation = "hgu133plus2.db", ontology = "BP", pvalueCutoff = 0.05, conditional = FALSE,
    testDirection = "over")

KEGGparams23 <- new("KEGGHyperGParams", geneIds = selGenes_23, universeGeneIds = geneUniverse_23,
    annotation = "hgu133plus2.db", pvalueCutoff = 0.05)

# Ejecutamos los análisis
GOHyper23 <- hyperGTest(GOparams23)
KEGGHyper23 <- hyperGTest(KEGGparams23)

#--
GOparams24 <- new("GOHyperGParams", geneIds = selGenes_24, universeGeneIds = geneUniverse_24,
    annotation = "hgu133plus2.db", ontology = "BP", pvalueCutoff = 0.05, conditional = FALSE,
    testDirection = "over")

KEGGparams24 <- new("KEGGHyperGParams", geneIds = selGenes_24, universeGeneIds = geneUniverse_24,
    annotation = "hgu133plus2.db", pvalueCutoff = 0.05)

# Ejecutamos los análisis
GOHyper24 <- hyperGTest(GOparams24)
KEGGHyper24 <- hyperGTest(KEGGparams24)


#--
GOparams25 <- new("GOHyperGParams", geneIds = selGenes_25, universeGeneIds = geneUniverse_25,
    annotation = "hgu133plus2.db", ontology = "BP", pvalueCutoff = 0.05, conditional = FALSE,
    testDirection = "over")

KEGGparams25 <- new("KEGGHyperGParams", geneIds = selGenes_25, universeGeneIds = geneUniverse_25,
    annotation = "hgu133plus2.db", pvalueCutoff = 0.05)

# Ejecutamos los análisis
GOHyper25 <- hyperGTest(GOparams25)
KEGGHyper25 <- hyperGTest(KEGGparams25)


#--
GOparams26 <- new("GOHyperGParams", geneIds = selGenes_26, universeGeneIds = geneUniverse_26,
    annotation = "hgu133plus2.db", ontology = "BP", pvalueCutoff = 0.05, conditional = FALSE,
    testDirection = "over")

KEGGparams26 <- new("KEGGHyperGParams", geneIds = selGenes_26, universeGeneIds = geneUniverse_26,
    annotation = "hgu133plus2.db", pvalueCutoff = 0.05)

# Ejecutamos los análisis
GOHyper26 <- hyperGTest(GOparams26)
KEGGHyper26 <- hyperGTest(KEGGparams26)

#--
GOparams27 <- new("GOHyperGParams", geneIds = selGenes_27, universeGeneIds = geneUniverse_27,
    annotation = "hgu133plus2.db", ontology = "BP", pvalueCutoff = 0.05, conditional = FALSE,
    testDirection = "over")

KEGGparams27 <- new("KEGGHyperGParams", geneIds = selGenes_27, universeGeneIds = geneUniverse_27,
    annotation = "hgu133plus2.db", pvalueCutoff = 0.05)

# Ejecutamos los análisis
GOHyper27 <- hyperGTest(GOparams27)
KEGGHyper27 <- hyperGTest(KEGGparams27)



#--
GOparams28 <- new("GOHyperGParams", geneIds = selGenes_28, universeGeneIds = geneUniverse_28,
    annotation = "hgu133plus2.db", ontology = "BP", pvalueCutoff = 0.05, conditional = FALSE,
    testDirection = "over")

KEGGparams28 <- new("KEGGHyperGParams", geneIds = selGenes_28, universeGeneIds = geneUniverse_28,
    annotation = "hgu133plus2.db", pvalueCutoff = 0.05)

# Ejecutamos los análisis
GOHyper28 <- hyperGTest(GOparams28)
KEGGHyper28 <- hyperGTest(KEGGparams28)


#--
GOparams29 <- new("GOHyperGParams", geneIds = selGenes_29, universeGeneIds = geneUniverse_29,
    annotation = "hgu133plus2.db", ontology = "BP", pvalueCutoff = 0.05, conditional = FALSE,
    testDirection = "over")

KEGGparams29 <- new("KEGGHyperGParams", geneIds = selGenes_29, universeGeneIds = geneUniverse_29,
    annotation = "hgu133plus2.db", pvalueCutoff = 0.05)

# Ejecutamos los análisis
GOHyper29 <- hyperGTest(GOparams29)
KEGGHyper29 <- hyperGTest(KEGGparams29)


#--
GOparams30 <- new("GOHyperGParams", geneIds = selGenes_30, universeGeneIds = geneUniverse_30,
    annotation = "hgu133plus2.db", ontology = "BP", pvalueCutoff = 0.05, conditional = FALSE,
    testDirection = "over")

KEGGparams30 <- new("KEGGHyperGParams", geneIds = selGenes_30, universeGeneIds = geneUniverse_30,
    annotation = "hgu133plus2.db", pvalueCutoff = 0.05)

# Ejecutamos los análisis
GOHyper30 <- hyperGTest(GOparams30)
KEGGHyper30 <- hyperGTest(KEGGparams30)


#--
GOparams31 <- new("GOHyperGParams", geneIds = selGenes_31, universeGeneIds = geneUniverse_31,
    annotation = "hgu133plus2.db", ontology = "BP", pvalueCutoff = 0.05, conditional = FALSE,
    testDirection = "over")

KEGGparams31 <- new("KEGGHyperGParams", geneIds = selGenes_31, universeGeneIds = geneUniverse_31,
    annotation = "hgu133plus2.db", pvalueCutoff = 0.05)

# Ejecutamos los análisis
GOHyper31 <- hyperGTest(GOparams31)
KEGGHyper31 <- hyperGTest(KEGGparams31)


#--
GOparams32 <- new("GOHyperGParams", geneIds = selGenes_32, universeGeneIds = geneUniverse_32,
    annotation = "hgu133plus2.db", ontology = "BP", pvalueCutoff = 0.05, conditional = FALSE,
    testDirection = "over")

KEGGparams32 <- new("KEGGHyperGParams", geneIds = selGenes_32, universeGeneIds = geneUniverse_32,
    annotation = "hgu133plus2.db", pvalueCutoff = 0.05)

# Ejecutamos los análisis
GOHyper32 <- hyperGTest(GOparams32)
KEGGHyper32 <- hyperGTest(KEGGparams32)


#--
GOparams33 <- new("GOHyperGParams", geneIds = selGenes_33, universeGeneIds = geneUniverse_33,
    annotation = "hgu133plus2.db", ontology = "BP", pvalueCutoff = 0.05, conditional = FALSE,
    testDirection = "over")

KEGGparams33 <- new("KEGGHyperGParams", geneIds = selGenes_33, universeGeneIds = geneUniverse_33,
    annotation = "hgu133plus2.db", pvalueCutoff = 0.05)

# Ejecutamos los análisis
GOHyper33 <- hyperGTest(GOparams33)
KEGGHyper33 <- hyperGTest(KEGGparams33)

#--
GOparams34 <- new("GOHyperGParams", geneIds = selGenes_34, universeGeneIds = geneUniverse_34,
    annotation = "hgu133plus2.db", ontology = "BP", pvalueCutoff = 0.05, conditional = FALSE,
    testDirection = "over")

KEGGparams34 <- new("KEGGHyperGParams", geneIds = selGenes_34, universeGeneIds = geneUniverse_34,
    annotation = "hgu133plus2.db", pvalueCutoff = 0.05)

# Ejecutamos los análisis
GOHyper34 <- hyperGTest(GOparams34)
KEGGHyper34 <- hyperGTest(KEGGparams34)

#--
GOparams35 <- new("GOHyperGParams", geneIds = selGenes_35, universeGeneIds = geneUniverse_35,
    annotation = "hgu133plus2.db", ontology = "BP", pvalueCutoff = 0.05, conditional = FALSE,
    testDirection = "over")

KEGGparams35 <- new("KEGGHyperGParams", geneIds = selGenes_35, universeGeneIds = geneUniverse_35,
    annotation = "hgu133plus2.db", pvalueCutoff = 0.05)

# Ejecutamos los análisis
GOHyper35 <- hyperGTest(GOparams35)
KEGGHyper35 <- hyperGTest(KEGGparams35)


#--
GOparams36 <- new("GOHyperGParams", geneIds = selGenes_36, universeGeneIds = geneUniverse_36,
    annotation = "hgu133plus2.db", ontology = "BP", pvalueCutoff = 0.05, conditional = FALSE,
    testDirection = "over")

KEGGparams36 <- new("KEGGHyperGParams", geneIds = selGenes_36, universeGeneIds = geneUniverse_36,
    annotation = "hgu133plus2.db", pvalueCutoff = 0.05)

# Ejecutamos los análisis
GOHyper36 <- hyperGTest(GOparams36)
KEGGHyper36 <- hyperGTest(KEGGparams36)

#--



#--
GOparams36REAL <- new("GOHyperGParams", geneIds = selGenes_36REAL, universeGeneIds = geneUniverse_36REAL,
    annotation = "hgu133plus2.db", ontology = "BP", pvalueCutoff = 0.05, conditional = FALSE,
    testDirection = "over")

KEGGparams36REAL <- new("KEGGHyperGParams", geneIds = selGenes_36REAL, universeGeneIds = geneUniverse_36REAL,
    annotation = "hgu133plus2.db", pvalueCutoff = 0.05)

# Ejecutamos los análisis
GOHyper36REAL <- hyperGTest(GOparams36REAL)
KEGGHyper36REAL <- hyperGTest(KEGGparams36REAL)

#--


GOparams37 <- new("GOHyperGParams", geneIds = selGenes_37, universeGeneIds = geneUniverse_37,
    annotation = "hgu133plus2.db", ontology = "BP", pvalueCutoff = 0.05, conditional = FALSE,
    testDirection = "over")

KEGGparams37 <- new("KEGGHyperGParams", geneIds = selGenes_37, universeGeneIds = geneUniverse_37,
    annotation = "hgu133plus2.db", pvalueCutoff = 0.05)

# Ejecutamos los análisis
GOHyper37 <- hyperGTest(GOparams37)
KEGGHyper37 <- hyperGTest(KEGGparams37)


#--
GOparams38 <- new("GOHyperGParams", geneIds = selGenes_38, universeGeneIds = geneUniverse_38,
    annotation = "hgu133plus2.db", ontology = "BP", pvalueCutoff = 0.05, conditional = FALSE,
    testDirection = "over")

KEGGparams38 <- new("KEGGHyperGParams", geneIds = selGenes_38, universeGeneIds = geneUniverse_38,
    annotation = "hgu133plus2.db", pvalueCutoff = 0.05)

# Ejecutamos los análisis
GOHyper38 <- hyperGTest(GOparams38)
KEGGHyper38 <- hyperGTest(KEGGparams38)


#--
GOparams39 <- new("GOHyperGParams", geneIds = selGenes_39, universeGeneIds = geneUniverse_39,
    annotation = "hgu133plus2.db", ontology = "BP", pvalueCutoff = 0.05, conditional = FALSE,
    testDirection = "over")

KEGGparams39 <- new("KEGGHyperGParams", geneIds = selGenes_39, universeGeneIds = geneUniverse_39,
    annotation = "hgu133plus2.db", pvalueCutoff = 0.05)

# Ejecutamos los análisis
GOHyper39 <- hyperGTest(GOparams39)
KEGGHyper39 <- hyperGTest(KEGGparams39)

#--
GOparams40 <- new("GOHyperGParams", geneIds = selGenes_40, universeGeneIds = geneUniverse_40,
    annotation = "hgu133plus2.db", ontology = "BP", pvalueCutoff = 0.05, conditional = FALSE,
    testDirection = "over")

KEGGparams40 <- new("KEGGHyperGParams", geneIds = selGenes_40, universeGeneIds = geneUniverse_40,
    annotation = "hgu133plus2.db", pvalueCutoff = 0.05)

# Ejecutamos los análisis
GOHyper40 <- hyperGTest(GOparams40)
KEGGHyper40 <- hyperGTest(KEGGparams40)

#--
GOparams41 <- new("GOHyperGParams", geneIds = selGenes_41, universeGeneIds = geneUniverse_41,
    annotation = "hgu133plus2.db", ontology = "BP", pvalueCutoff = 0.05, conditional = FALSE,
    testDirection = "over")

KEGGparams41 <- new("KEGGHyperGParams", geneIds = selGenes_41, universeGeneIds = geneUniverse_41,
    annotation = "hgu133plus2.db", pvalueCutoff = 0.05)

# Ejecutamos los análisis
GOHyper41 <- hyperGTest(GOparams41)
KEGGHyper41 <- hyperGTest(KEGGparams41)



#--
GOparams42 <- new("GOHyperGParams", geneIds = selGenes_42, universeGeneIds = geneUniverse_42,
    annotation = "hgu133plus2.db", ontology = "BP", pvalueCutoff = 0.05, conditional = FALSE,
    testDirection = "over")

KEGGparams42 <- new("KEGGHyperGParams", geneIds = selGenes_42, universeGeneIds = geneUniverse_42,
    annotation = "hgu133plus2.db", pvalueCutoff = 0.05)

# Ejecutamos los análisis
GOHyper42 <- hyperGTest(GOparams42)
KEGGHyper42 <- hyperGTest(KEGGparams42)



#--
GOparams43 <- new("GOHyperGParams", geneIds = selGenes_43, universeGeneIds = geneUniverse_43,
    annotation = "hgu133plus2.db", ontology = "BP", pvalueCutoff = 0.05, conditional = FALSE,
    testDirection = "over")

KEGGparams43 <- new("KEGGHyperGParams", geneIds = selGenes_43, universeGeneIds = geneUniverse_43,
    annotation = "hgu133plus2.db", pvalueCutoff = 0.05)

# Ejecutamos los análisis
GOHyper43 <- hyperGTest(GOparams43)
KEGGHyper43 <- hyperGTest(KEGGparams43)



#--
GOparams44 <- new("GOHyperGParams", geneIds = selGenes_44, universeGeneIds = geneUniverse_44,
    annotation = "hgu133plus2.db", ontology = "BP", pvalueCutoff = 0.05, conditional = FALSE,
    testDirection = "over")

KEGGparams44 <- new("KEGGHyperGParams", geneIds = selGenes_44, universeGeneIds = geneUniverse_44,
    annotation = "hgu133plus2.db", pvalueCutoff = 0.05)

# Ejecutamos los análisis
GOHyper44 <- hyperGTest(GOparams44)
KEGGHyper44 <- hyperGTest(KEGGparams44)



#--
GOparams45 <- new("GOHyperGParams", geneIds = selGenes_45, universeGeneIds = geneUniverse_45,
    annotation = "hgu133plus2.db", ontology = "BP", pvalueCutoff = 0.05, conditional = FALSE,
    testDirection = "over")

KEGGparams45 <- new("KEGGHyperGParams", geneIds = selGenes_45, universeGeneIds = geneUniverse_45,
    annotation = "hgu133plus2.db", pvalueCutoff = 0.05)

# Ejecutamos los análisis
GOHyper45 <- hyperGTest(GOparams45)
KEGGHyper45 <- hyperGTest(KEGGparams45)

#--
GOparams46 <- new("GOHyperGParams", geneIds = selGenes_46, universeGeneIds = geneUniverse_46,
    annotation = "hgu133plus2.db", ontology = "BP", pvalueCutoff = 0.05, conditional = FALSE,
    testDirection = "over")

KEGGparams46 <- new("KEGGHyperGParams", geneIds = selGenes_46, universeGeneIds = geneUniverse_46,
    annotation = "hgu133plus2.db", pvalueCutoff = 0.05)

# Ejecutamos los análisis
GOHyper46 <- hyperGTest(GOparams46)
KEGGHyper46 <- hyperGTest(KEGGparams46)


#--
GOparams47 <- new("GOHyperGParams", geneIds = selGenes_47, universeGeneIds = geneUniverse_47,
    annotation = "hgu133plus2.db", ontology = "BP", pvalueCutoff = 0.05, conditional = FALSE,
    testDirection = "over")

KEGGparams47 <- new("KEGGHyperGParams", geneIds = selGenes_47, universeGeneIds = geneUniverse_47,
    annotation = "hgu133plus2.db", pvalueCutoff = 0.05)

# Ejecutamos los análisis
GOHyper47 <- hyperGTest(GOparams47)
KEGGHyper47 <- hyperGTest(KEGGparams47)


#--
GOparams48 <- new("GOHyperGParams", geneIds = selGenes_48, universeGeneIds = geneUniverse_48,
    annotation = "hgu133plus2.db", ontology = "BP", pvalueCutoff = 0.05, conditional = FALSE,
    testDirection = "over")

KEGGparams48 <- new("KEGGHyperGParams", geneIds = selGenes_48, universeGeneIds = geneUniverse_48,
    annotation = "hgu133plus2.db", pvalueCutoff = 0.05)

# Ejecutamos los análisis
GOHyper48 <- hyperGTest(GOparams48)
KEGGHyper48 <- hyperGTest(KEGGparams48)

```



Resultados

Los resultados del análisis se encuentran en un objeto que se puede visualizar directamente.

```{r, warning=TRUE, error=FALSE}
summary(GOHyper17)
summary(KEGGHyper17)
```

Una mejor opción es exportarlos a un archivo, preferentemente con hiperenlaces que permitan una exploración directa de las categorías

----------



```{r, warning=TRUE, error=TRUE}
library(dplyr)

a <- (selGenes_2 %>%
          subset(P.Value < 0.05))
unique(a$ENTREZID)

library(ReactomePA)
enrich.result_1 <- enrichPathway(gene = selGenes_1,
                               pvalueCutoff = 0.05,
                               readable = T,
                               organism = "human",
                               universe = geneUniverse_1)



enrich.result_2 <- enrichPathway(gene = selGenes_2, # no sale
                               pvalueCutoff = 0.05,
                               readable = T,
                               organism = "human",
                               universe = geneUniverse_2)


enrich.result_3 <- enrichPathway(gene = selGenes_3,
                               pvalueCutoff = 0.05,
                               readable = T,
                               organism = "human",
                               universe = geneUniverse_3)

enrich.result_4 <- enrichPathway(gene = selGenes_4,
                               pvalueCutoff = 0.05,
                               readable = T,
                               organism = "human",
                               universe = geneUniverse_4)


enrich.result_5 <- enrichPathway(gene = selGenes_5,
                               pvalueCutoff = 0.05,
                               readable = T,
                               organism = "human",
                               universe = geneUniverse_5)


enrich.result_6 <- enrichPathway(gene = selGenes_6,
                               pvalueCutoff = 0.05,
                               readable = T,
                               organism = "human",
                               universe = geneUniverse_6)


enrich.result_7 <- enrichPathway(gene = selGenes_7,
                               pvalueCutoff = 0.05,
                               readable = T,
                               organism = "human",
                               universe = geneUniverse_7)


enrich.result_8 <- enrichPathway(gene = selGenes_8,
                               pvalueCutoff = 0.05,
                               readable = T,
                               organism = "human",
                               universe = geneUniverse_8)


enrich.result_9 <- enrichPathway(gene = selGenes_9,
                               pvalueCutoff = 0.05,
                               readable = T,
                               organism = "human",
                               universe = geneUniverse_9)




enrich.result_9REAL <- enrichPathway(gene = selGenes_9REAL,
                               pvalueCutoff = 0.05,
                               readable = T,
                               organism = "human",
                               universe = geneUniverse_9REAL)



enrich.result_10 <- enrichPathway(gene = selGenes_10,
                               pvalueCutoff = 0.05,
                               readable = T,
                               organism = "human",
                               universe = geneUniverse_10)


enrich.result_11 <- enrichPathway(gene = selGenes_11,
                               pvalueCutoff = 0.05,
                               readable = T,
                               organism = "human",
                               universe = geneUniverse_11)


enrich.result_12 <- enrichPathway(gene = selGenes_12,
                               pvalueCutoff = 0.05,
                               readable = T,
                               organism = "human",
                               universe = geneUniverse_12)


enrich.result_13 <- enrichPathway(gene = selGenes_13,
                               pvalueCutoff = 0.05,
                               readable = T,
                               organism = "human",
                               universe = geneUniverse_13)



enrich.result_14 <- enrichPathway(gene = selGenes_14,
                               pvalueCutoff = 0.05,
                               readable = T,
                               organism = "human",
                               universe = geneUniverse_14)


enrich.result_15 <- enrichPathway(gene = selGenes_15,
                               pvalueCutoff = 0.05,
                               readable = T,
                               organism = "human",
                               universe = geneUniverse_15)

enrich.result_16 <- enrichPathway(gene = selGenes_16,
                               pvalueCutoff = 0.05,
                               readable = T,
                               organism = "human",
                               universe = geneUniverse_16)


enrich.result_17 <- enrichPathway(gene = selGenes_17,
                               pvalueCutoff = 0.05,
                               readable = T,
                               organism = "human",
                               universe = geneUniverse_17)


enrich.result_18 <- enrichPathway(gene = selGenes_18,
                               pvalueCutoff = 0.05,
                               readable = T,
                               organism = "human",
                               universe = geneUniverse_18)


enrich.result_19 <- enrichPathway(gene = selGenes_19,
                               pvalueCutoff = 0.05,
                               readable = T,
                               organism = "human",
                               universe = geneUniverse_19)


enrich.result_20 <- enrichPathway(gene = selGenes_20,
                               pvalueCutoff = 0.05,
                               readable = T,
                               organism = "human",
                               universe = geneUniverse_20)


enrich.result_21 <- enrichPathway(gene = selGenes_21,
                               pvalueCutoff = 0.05,
                               readable = T,
                               organism = "human",
                               universe = geneUniverse_21)

enrich.result_22 <- enrichPathway(gene = selGenes_22,
                               pvalueCutoff = 0.05,
                               readable = T,
                               organism = "human",
                               universe = geneUniverse_22)


enrich.result_23 <- enrichPathway(gene = selGenes_23,
                               pvalueCutoff = 0.05,
                               readable = T,
                               organism = "human",
                               universe = geneUniverse_23)


enrich.result_24 <- enrichPathway(gene = selGenes_24,
                               pvalueCutoff = 0.05,
                               readable = T,
                               organism = "human",
                               universe = geneUniverse_24)


enrich.result_25 <- enrichPathway(gene = selGenes_25,
                               pvalueCutoff = 0.05,
                               readable = T,
                               organism = "human",
                               universe = geneUniverse_25)

enrich.result_26 <- enrichPathway(gene = selGenes_26,
                               pvalueCutoff = 0.05,
                               readable = T,
                               organism = "human",
                               universe = geneUniverse_26)


enrich.result_27 <- enrichPathway(gene = selGenes_27, # no sale
                               pvalueCutoff = 0.05,
                               readable = T,
                               organism = "human",
                               universe = geneUniverse_27)


enrich.result_28 <- enrichPathway(gene = selGenes_28,
                               pvalueCutoff = 0.05,
                               readable = T,
                               organism = "human",
                               universe = geneUniverse_28)


enrich.result_29 <- enrichPathway(gene = selGenes_29,
                               pvalueCutoff = 0.05,
                               readable = T,
                               organism = "human",
                               universe = geneUniverse_29)


enrich.result_30 <- enrichPathway(gene = selGenes_30,
                               pvalueCutoff = 0.05,
                               readable = T,
                               organism = "human",
                               universe = geneUniverse_30)



enrich.result_31 <- enrichPathway(gene = selGenes_31,
                               pvalueCutoff = 0.05,
                               readable = T,
                               organism = "human",
                               universe = geneUniverse_31)


enrich.result_32 <- enrichPathway(gene = selGenes_32,
                               pvalueCutoff = 0.05,
                               readable = T,
                               organism = "human",
                               universe = geneUniverse_32)

enrich.result_33 <- enrichPathway(gene = selGenes_33,
                               pvalueCutoff = 0.05,
                               readable = T,
                               organism = "human",
                               universe = geneUniverse_33)


enrich.result_34 <- enrichPathway(gene = selGenes_34,
                               pvalueCutoff = 0.05,
                               readable = T,
                               organism = "human",
                               universe = geneUniverse_34)


enrich.result_35 <- enrichPathway(gene = selGenes_35,
                               pvalueCutoff = 0.05,
                               readable = T,
                               organism = "human",
                               universe = geneUniverse_35)


enrich.result_36 <- enrichPathway(gene = selGenes_36,
                               pvalueCutoff = 0.05,
                               readable = T,
                               organism = "human",
                               universe = geneUniverse_36)



enrich.result_36REAL <- enrichPathway(gene = selGenes_36REAL,
                               pvalueCutoff = 0.05,
                               readable = T,
                               organism = "human",
                               universe = geneUniverse_36REAL)



enrich.result_37 <- enrichPathway(gene = selGenes_37,
                               pvalueCutoff = 0.05,
                               readable = T,
                               organism = "human",
                               universe = geneUniverse_37)


enrich.result_38 <- enrichPathway(gene = selGenes_38,
                               pvalueCutoff = 0.05,
                               readable = T,
                               organism = "human",
                               universe = geneUniverse_38)

enrich.result_39 <- enrichPathway(gene = selGenes_39,
                               pvalueCutoff = 0.05,
                               readable = T,
                               organism = "human",
                               universe = geneUniverse_39)


enrich.result_40 <- enrichPathway(gene = selGenes_40,
                               pvalueCutoff = 0.05,
                               readable = T,
                               organism = "human",
                               universe = geneUniverse_40)


enrich.result_41 <- enrichPathway(gene = selGenes_41,
                               pvalueCutoff = 0.05,
                               readable = T,
                               organism = "human",
                               universe = geneUniverse_41)


enrich.result_42 <- enrichPathway(gene = selGenes_42,
                               pvalueCutoff = 0.05,
                               readable = T,
                               organism = "human",
                               universe = geneUniverse_42)

enrich.result_43 <- enrichPathway(gene = selGenes_43,
                               pvalueCutoff = 0.05,
                               readable = T,
                               organism = "human",
                               universe = geneUniverse_43)


enrich.result_44 <- enrichPathway(gene = selGenes_44, 
                               pvalueCutoff = 0.05,
                               readable = T,
                               organism = "human",
                               universe = geneUniverse_44)

enrich.result_45 <- enrichPathway(gene = selGenes_45,
                               pvalueCutoff = 0.05,
                               readable = T,
                               organism = "human",
                               universe = geneUniverse_45)

enrich.result_46 <- enrichPathway(gene = selGenes_46,
                               pvalueCutoff = 0.05,
                               readable = T,
                               organism = "human",
                               universe = geneUniverse_46)


enrich.result_47 <- enrichPathway(gene = selGenes_47, # no sale
                               pvalueCutoff = 0.05,
                               readable = T,
                               organism = "human",
                               universe = geneUniverse_47)



enrich.result_48 <- enrichPathway(gene = selGenes_48, # no sale
                               pvalueCutoff = 0.05,
                               readable = T,
                               organism = "human",
                               universe = geneUniverse_48)


```

[1] "topTab_GSE62156_1_Anot"  "topTab_GSE62156_10_Anot" "topTab_GSE62156_11_Anot" "topTab_GSE62156_12_Anot" "topTab_GSE62156_13_Anot"
 [6] "topTab_GSE62156_14_Anot" "topTab_GSE62156_15_Anot" "topTab_GSE62156_16_Anot" "topTab_GSE62156_17_Anot" "topTab_GSE62156_18_Anot"
[11] "topTab_GSE62156_19_Anot" "topTab_GSE62156_2_Anot"  "topTab_GSE62156_20_Anot" "topTab_GSE62156_21_Anot" "topTab_GSE62156_22_Anot"
[16] "topTab_GSE62156_23_Anot" "topTab_GSE62156_24_Anot" "topTab_GSE62156_25_Anot" "topTab_GSE62156_26_Anot" "topTab_GSE62156_27_Anot"
[21] "topTab_GSE62156_28_Anot" "topTab_GSE62156_29_Anot" "topTab_GSE62156_3_Anot"  "topTab_GSE62156_30_Anot" "topTab_GSE62156_31_Anot"
[26] "topTab_GSE62156_32_Anot" "topTab_GSE62156_33_Anot" "topTab_GSE62156_34_Anot" "topTab_GSE62156_35_Anot" "topTab_GSE62156_36_Anot"
[31] "topTab_GSE62156_37_Anot" "topTab_GSE62156_38_Anot" "topTab_GSE62156_39_Anot" "topTab_GSE62156_4_Anot"  "topTab_GSE62156_40_Anot"
[36] "topTab_GSE62156_41_Anot" "topTab_GSE62156_42_Anot" "topTab_GSE62156_43_Anot" "topTab_GSE62156_44_Anot" "topTab_GSE62156_45_Anot"
[41] "topTab_GSE62156_46_Anot" "topTab_GSE62156_47_Anot" "topTab_GSE62156_48_Anot" "topTab_GSE62156_5_Anot"  "topTab_GSE62156_6_Anot" 
[46] "topTab_GSE62156_7_Anot"  "topTab_GSE62156_8_Anot"  "topTab_GSE62156_9_Anot" 


```{r, warning=TRUE, error=FALSE}

listOfTables <- list(CALMAF10_CALMHOX = topTab_GSE62156_1_Anot,
                     CALMAF10_CALMHOXAUnk= topTab_GSE62156_2_Anot,
                     CALMAF10_CALMImmature= topTab_GSE62156_3_Anot,
                     CALMAF10_CALMImmatureHOXA= topTab_GSE62156_4_Anot,
                     CALMAF10_CALMMLL= topTab_GSE62156_5_Anot,
                     CALMAF10_CALMTAL= topTab_GSE62156_6_Anot,
                     CALMAF10_CALMTLX1= topTab_GSE62156_7_Anot,
                     CALMAF10_CALMTLX3= topTab_GSE62156_8_Anot,
                     HOX_Immature= topTab_GSE62156_9_Anot,
                     HOX_HOXA=topTab_GSE62156_9REAL_Anot,
                     HOX_ImmHOXA= topTab_GSE62156_10_Anot, # 10
                     HOX_MLL= topTab_GSE62156_11_Anot,
                     HOX_TAL= topTab_GSE62156_12_Anot,
                     HOX_TLX1 = topTab_GSE62156_13_Anot,
                     HOX_TLX3= topTab_GSE62156_14_Anot,
                     HOXAUnk_Imm= topTab_GSE62156_15_Anot,
                     HOXAUnk_HOX= topTab_GSE62156_16_Anot,
                     HOXAUnk_ImmHOXA= topTab_GSE62156_17_Anot,
                     HOXAUnk_MLL= topTab_GSE62156_18_Anot,
                     HOXAUnk_TLX1= topTab_GSE62156_19_Anot,
                     HOXAUnk_TLX3= topTab_GSE62156_20_Anot, #20
                     Immature_ImmHOXA= topTab_GSE62156_21_Anot,
                     Immature_MLL= topTab_GSE62156_22_Anot,
                     Immature_TAL= topTab_GSE62156_23_Anot,
                     Immature_TLX1= topTab_GSE62156_24_Anot,
                     Immature_TLX3= topTab_GSE62156_25_Anot,
                     ImmHOXA_MLL = topTab_GSE62156_26_Anot,
                     ImmHOXA_TAL = topTab_GSE62156_27_Anot,
                     ImmHOXA_TLX1 = topTab_GSE62156_28_Anot,
                     ImmHOXA_TLX3 = topTab_GSE62156_29_Anot,
                     MLL_TAL = topTab_GSE62156_30_Anot, #30
                     MLL_TLX1 = topTab_GSE62156_31_Anot,
                     MLL_TLX3 = topTab_GSE62156_32_Anot,
                     TLX = topTab_GSE62156_33_Anot,
                     HOX_CALM = topTab_GSE62156_34_Anot,
                     HOX_ImHOXA = topTab_GSE62156_35_Anot,
                     HOXs_MLL = topTab_GSE62156_36_Anot,
                     HOX_Imm=topTab_GSE62156_36REAL_Anot,
                     HOXs_TAL = topTab_GSE62156_37_Anot,
                     HOXs_TLX1 = topTab_GSE62156_38_Anot,
                     HOXs_TLX3 = topTab_GSE62156_39_Anot,
                     HOX_TLX = topTab_GSE62156_40_Anot, # 40
                     Imm_HOX = topTab_GSE62156_41_Anot,
                     Imm_HOXAUnk = topTab_GSE62156_42_Anot,
                     Imm_CALM = topTab_GSE62156_43_Anot,
                     Imm_MLL = topTab_GSE62156_44_Anot,
                     Imm_TAL = topTab_GSE62156_45_Anot,
                     Imm_TLX1 = topTab_GSE62156_46_Anot,
                     Imm_TLX3 = topTab_GSE62156_47_Anot,
                     Imm_TLX = topTab_GSE62156_48_Anot)

listOfSelected <- list()



for (i in 1:length(listOfTables)){
  # select the toptable
  topTab <- listOfTables[[i]]
  # select the genes to be included in the analysis
  whichGenes<-topTab["P.Value"]<0.05
  selectedIDs <- rownames(topTab)[whichGenes]
  # convert the ID to Entrez
  EntrezIDs<- listOfTables[[i]]$ENTREZID
  listOfSelected[[i]] <- EntrezIDs
  names(listOfSelected)[i] <- names(listOfTables)[i]
}

```



```{r, warning=TRUE, error=FALSE}
ls(pattern="enrich")

listOfData <- listOfSelected

comparisonsNames <- names(listOfData)

universes <- list(geneUniverse_1,geneUniverse_2,
                  geneUniverse_3, geneUniverse_4,
                   geneUniverse_5, geneUniverse_6,
                   geneUniverse_7,
                  geneUniverse_8, geneUniverse_9,
                  geneUniverse_9REAL,
                  geneUniverse_10, geneUniverse_11,
                  geneUniverse_12, geneUniverse_13,
                  geneUniverse_14, geneUniverse_15,
                  geneUniverse_16, geneUniverse_17,
                  geneUniverse_18, geneUniverse_19,
                  geneUniverse_20, geneUniverse_21,
                  geneUniverse_22, geneUniverse_23,
                  geneUniverse_24, geneUniverse_25,
                  geneUniverse_26, geneUniverse_27,
                  geneUniverse_28,geneUniverse_29,
                  geneUniverse_30,geneUniverse_31,
                  geneUniverse_32,geneUniverse_33,
                  geneUniverse_34,geneUniverse_35,
                  geneUniverse_36,
                  geneUniverse_36REAL,
                  geneUniverse_37,
                  geneUniverse_38,geneUniverse_39,
                  geneUniverse_40,geneUniverse_41,
                  geneUniverse_42,geneUniverse_43,
                  geneUniverse_44,geneUniverse_45,
                  geneUniverse_46,geneUniverse_47,
                  geneUniverse_48)

table(universes[[1]] == geneUniverse_1)

enrich.results=list(enrich.result_1,enrich.result_2,
                    enrich.result_3,
                    enrich.result_4,
                    enrich.result_5,
                    enrich.result_6,
                    enrich.result_7,
                    enrich.result_8,
                    enrich.result_9,
                    enrich.result_9REAL,
                    enrich.result_10,
                    enrich.result_11,
                    enrich.result_12,
                    enrich.result_13,
                    enrich.result_14,
                    enrich.result_15,
                    enrich.result_16,
                    enrich.result_17,
                    enrich.result_18,
                    enrich.result_19,
                    enrich.result_20,
                    enrich.result_21,
                    enrich.result_22,
                    enrich.result_23,
                    enrich.result_24,
                    enrich.result_25,
                    enrich.result_26,
                    enrich.result_27,
                    enrich.result_28,
                    enrich.result_29,
                    enrich.result_30,
                    enrich.result_31,
                    enrich.result_32,
                    enrich.result_33,
                    enrich.result_34,
                    enrich.result_35,
                    enrich.result_36,
                    enrich.result_36REAL,
                    enrich.result_37,
                    enrich.result_38,
                    enrich.result_39,enrich.result_40,
                    enrich.result_41,enrich.result_42,
                    enrich.result_43,enrich.result_44,
                    enrich.result_45,enrich.result_46,
                    enrich.result_47, enrich.result_48)


```



```{r, warning=TRUE, error=FALSE}

for (i in 1:length(listOfData)){
  universe<-universes[[i]]
  enrich.result<-enrich.results[[i]]
  genesIn <- listOfData[[i]]
  comparison <- comparisonsNames[i]
  enrich.r <- enrich.result
  cat("##################################")
  cat("\nComparison: ", comparison,"\n")
  print(head(enrich.r))
}





```
CAMBIAR LO DE ABAJO IGUAL NO ESTA BIEN.

```{r, warning=TRUE, error=TRUE}

enrich.result<-enrich.results[[3]]
enrich.r <- enrich.result

barplot(enrich.r, showCategory = 15, font.size = 4,
        title = paste0("Reactome Pathway Analysis for ", comparison,". Barplot"))

enrich.result<-enrich.results[[5]]
enrich.r <- enrich.result

barplot(enrich.r, showCategory = 15, font.size = 4,
        title = paste0("Reactome Pathway Analysis for ", comparison,". Barplot"))


enrich.result<-enrich.results[[6]]
enrich.r <- enrich.result

barplot(enrich.r, showCategory = 15, font.size = 4,
title = paste0("Reactome Pathway Analysis for ", comparison,". Barplot"))

cnetplot(enrich.r, categorySize = "geneNum", schowCategory = 15, vertex.label.cex = 0.75)


enrich.result<-enrich.results[[7]]
enrich.r <- enrich.result

barplot(enrich.r, showCategory = 15, font.size = 4,
title = paste0("Reactome Pathway Analysis for ", comparison,". Barplot"))

cnetplot(enrich.r, categorySize = "geneNum", schowCategory = 15, vertex.label.cex = 0.75)


enrich.result<-enrich.results[[19]]
enrich.r <- enrich.result

barplot(enrich.r, showCategory = 15, font.size = 4,
title = paste0("Reactome Pathway Analysis for ", comparison,". Barplot"))

cnetplot(enrich.r, categorySize = "geneNum", schowCategory = 15, vertex.label.cex = 0.75)





```

CALMAF10_CALMHOX, CALMAF10_CALMHOXAUnk, CALMAF10_CALMImmature, CALMAF10_CALMImmatureHOXA, CALMAF10_CALMMLL, CALMAF10_CALMTAL, CALMAF10_CALMTLX1, CALMAF10_CALMTLX3, HOX_Immature, HOX_ImmHOXA, HOX_MLL, HOX_TAL, HOX_TLX1, HOX_TLX3, HOXAUnk_Imm, HOXAUnk_HOX, HOXAUnk_ImmHOXA, HOXAUnk_MLL, HOXAUnk_TLX1, HOXAUnk_TLX3, Immature_ImmHOXA, Immature_MLL, Immature_TAL, Immature_TLX1, Immature_TLX3, ImmHOXA_MLL, ImmHOXA_TAL, ImmHOXA_TLX1, ImmHOXA_TLX3, MLL_TAL, MLL_TLX1, MLL_TLX3, TLX, HOX_CALM, HOX_ImHOXA, HOXs_MLL, HOXs_TAL, HOXs_TLX1, HOXs_TLX3, HOX_TLX, Imm_HOX, Imm_HOXAUnk, Imm_CALM, Imm_MLL, Imm_TAL, Imm_TLX1, Imm_TLX3, Imm_TLX



```{r, warning=TRUE, error=TRUE}
enrich.result<-enrich.results[[1]]
enrich.r <- enrich.result
Path<-enrich.r@result[["ID"]]
Biological_Description<-enrich.r@result[["Description"]]
Gene<-enrich.r@result[["geneID"]]
GSE62156_CALMAF10_CALMHOX <-data.frame(Path, Biological_Description, Gene)



enrich.result<-enrich.results[[2]]
enrich.r <- enrich.result
Path<-enrich.r@result[["ID"]]
Biological_Description<-enrich.r@result[["Description"]]
Gene<-enrich.r@result[["geneID"]]
GSE62156_CALMAF10_CALMHOXAUnk <-data.frame(Path, Biological_Description, Gene)

enrich.result<-enrich.results[[3]]
enrich.r <- enrich.result
Path<-enrich.r@result[["ID"]]
Biological_Description<-enrich.r@result[["Description"]]
Gene<-enrich.r@result[["geneID"]]
GSE62156_CALMAF10_CALMImmature <-data.frame(Path, Biological_Description, Gene)


enrich.result<-enrich.results[[4]]
enrich.r <- enrich.result
Path<-enrich.r@result[["ID"]]
Biological_Description<-enrich.r@result[["Description"]]
Gene<-enrich.r@result[["geneID"]]
GSE62156_CALMAF10_CALMImmatureHOXA <-data.frame(Path, Biological_Description, Gene)


enrich.result<-enrich.results[[5]]
enrich.r <- enrich.result
Path<-enrich.r@result[["ID"]]
Biological_Description<-enrich.r@result[["Description"]]
Gene<-enrich.r@result[["geneID"]]
GSE62156_CALMAF10_CALMMLL <-data.frame(Path, Biological_Description, Gene)

# CALMAF10_CALMHOX, CALMAF10_CALMHOXAUnk, CALMAF10_CALMImmature, CALMAF10_CALMImmatureHOXA, CALMAF10_CALMMLL, CALMAF10_CALMTAL, CALMAF10_CALMTLX1, CALMAF10_CALMTLX3, HOX_Immature, HOX_ImmHOXA, HOX_MLL, HOX_TAL, HOX_TLX1, HOX_TLX3, HOXAUnk_Imm, HOXAUnk_HOX, HOXAUnk_ImmHOXA, HOXAUnk_MLL, HOXAUnk_TLX1, HOXAUnk_TLX3, Immature_ImmHOXA, Immature_MLL, Immature_TAL, Immature_TLX1, Immature_TLX3, ImmHOXA_MLL, ImmHOXA_TAL, ImmHOXA_TLX1, ImmHOXA_TLX3, MLL_TAL, MLL_TLX1, MLL_TLX3, TLX, HOX_CALM, HOX_ImHOXA, HOXs_MLL, HOXs_TAL, HOXs_TLX1, HOXs_TLX3, HOX_TLX, Imm_HOX, Imm_HOXAUnk, Imm_CALM, Imm_MLL, Imm_TAL, Imm_TLX1, Imm_TLX3, Imm_TLX

enrich.result<-enrich.results[[6]]
enrich.r <- enrich.result
Path<-enrich.r@result[["ID"]]
Biological_Description<-enrich.r@result[["Description"]]
Gene<-enrich.r@result[["geneID"]]
GSE62156_CALMAF10_CALMTAL <-data.frame(Path, Biological_Description, Gene)



enrich.result<-enrich.results[[7]]
enrich.r <- enrich.result
Path<-enrich.r@result[["ID"]]
Biological_Description<-enrich.r@result[["Description"]]
Gene<-enrich.r@result[["geneID"]]
GSE62156_CALMAF10_CALMTLX1 <-data.frame(Path, Biological_Description, Gene)

enrich.result<-enrich.results[[8]]
enrich.r <- enrich.result
Path<-enrich.r@result[["ID"]]
Biological_Description<-enrich.r@result[["Description"]]
Gene<-enrich.r@result[["geneID"]]
GSE62156_CALMAF10_CALMTLX3 <-data.frame(Path, Biological_Description, Gene)


enrich.result<-enrich.results[[9]]
enrich.r <- enrich.result
Path<-enrich.r@result[["ID"]]
Biological_Description<-enrich.r@result[["Description"]]
Gene<-enrich.r@result[["geneID"]]
GSE62156_HOX_Immature <-data.frame(Path, Biological_Description, Gene)

enrich.result<-enrich.results[[10]]
enrich.r <- enrich.result
Path<-enrich.r@result[["ID"]]
Biological_Description<-enrich.r@result[["Description"]]
Gene<-enrich.r@result[["geneID"]]
GSE62156_HOX_HOXA <-data.frame(Path, Biological_Description, Gene)

enrich.result<-enrich.results[[11]]
enrich.r <- enrich.result
Path<-enrich.r@result[["ID"]]
Biological_Description<-enrich.r@result[["Description"]]
Gene<-enrich.r@result[["geneID"]]
GSE62156_HOX_ImmHOXA <-data.frame(Path, Biological_Description, Gene)

# CALMAF10_CALMTLX3, HOX_Immature, HOX_ImmHOXA, HOX_MLL, HOX_TAL, HOX_TLX1, HOX_TLX3, HOXAUnk_Imm, HOXAUnk_HOX, HOXAUnk_ImmHOXA, HOXAUnk_MLL, HOXAUnk_TLX1, HOXAUnk_TLX3, Immature_ImmHOXA, Immature_MLL, Immature_TAL, Immature_TLX1, Immature_TLX3, ImmHOXA_MLL, ImmHOXA_TAL, ImmHOXA_TLX1, ImmHOXA_TLX3, MLL_TAL, MLL_TLX1, MLL_TLX3, TLX, HOX_CALM, HOX_ImHOXA, HOXs_MLL, HOXs_TAL, HOXs_TLX1, HOXs_TLX3, HOX_TLX, Imm_HOX, Imm_HOXAUnk, Imm_CALM, Imm_MLL, Imm_TAL, Imm_TLX1, Imm_TLX3, Imm_TLX


enrich.result<-enrich.results[[12]]
enrich.r <- enrich.result
Path<-enrich.r@result[["ID"]]
Biological_Description<-enrich.r@result[["Description"]]
Gene<-enrich.r@result[["geneID"]]
GSE62156_HOX_MLL <-data.frame(Path, Biological_Description, Gene)



enrich.result<-enrich.results[[13]]
enrich.r <- enrich.result
Path<-enrich.r@result[["ID"]]
Biological_Description<-enrich.r@result[["Description"]]
Gene<-enrich.r@result[["geneID"]]
GSE62156_HOX_TAL <-data.frame(Path, Biological_Description, Gene)

enrich.result<-enrich.results[[14]]
enrich.r <- enrich.result
Path<-enrich.r@result[["ID"]]
Biological_Description<-enrich.r@result[["Description"]]
Gene<-enrich.r@result[["geneID"]]
GSE62156_HOX_TLX1 <-data.frame(Path, Biological_Description, Gene)


enrich.result<-enrich.results[[15]]
enrich.r <- enrich.result
Path<-enrich.r@result[["ID"]]
Biological_Description<-enrich.r@result[["Description"]]
Gene<-enrich.r@result[["geneID"]]
GSE62156_HOX_TLX3 <-data.frame(Path, Biological_Description, Gene)


enrich.result<-enrich.results[[16]]
enrich.r <- enrich.result
Path<-enrich.r@result[["ID"]]
Biological_Description<-enrich.r@result[["Description"]]
Gene<-enrich.r@result[["geneID"]]
GSE62156_HOXAUnk_Imm <-data.frame(Path, Biological_Description, Gene)


enrich.result<-enrich.results[[17]]
enrich.r <- enrich.result
Path<-enrich.r@result[["ID"]]
Biological_Description<-enrich.r@result[["Description"]]
Gene<-enrich.r@result[["geneID"]]
GSE62156_HOXAUnk_HOX <-data.frame(Path, Biological_Description, Gene)



enrich.result<-enrich.results[[18]]
enrich.r <- enrich.result
Path<-enrich.r@result[["ID"]]
Biological_Description<-enrich.r@result[["Description"]]
Gene<-enrich.r@result[["geneID"]]
GSE62156_HOXAUnk_ImmHOXA <-data.frame(Path, Biological_Description, Gene)

enrich.result<-enrich.results[[19]]
enrich.r <- enrich.result
Path<-enrich.r@result[["ID"]]
Biological_Description<-enrich.r@result[["Description"]]
Gene<-enrich.r@result[["geneID"]]
GSE62156_HOXAUnk_MLL <-data.frame(Path, Biological_Description, Gene)

# HOXAUnk_MLL, HOXAUnk_TLX1, HOXAUnk_TLX3, Immature_ImmHOXA, Immature_MLL, Immature_TAL, Immature_TLX1, Immature_TLX3, ImmHOXA_MLL, ImmHOXA_TAL, ImmHOXA_TLX1, ImmHOXA_TLX3, MLL_TAL, MLL_TLX1, MLL_TLX3, TLX, HOX_CALM, HOX_ImHOXA, HOXs_MLL, HOXs_TAL, HOXs_TLX1, HOXs_TLX3, HOX_TLX, Imm_HOX, Imm_HOXAUnk, Imm_CALM, Imm_MLL, Imm_TAL, Imm_TLX1, Imm_TLX3, Imm_TLX

enrich.result<-enrich.results[[20]]
enrich.r <- enrich.result
Path<-enrich.r@result[["ID"]]
Biological_Description<-enrich.r@result[["Description"]]
Gene<-enrich.r@result[["geneID"]]
GSE62156_HOXAUnk_TLX1 <-data.frame(Path, Biological_Description, Gene)


enrich.result<-enrich.results[[21]]
enrich.r <- enrich.result
Path<-enrich.r@result[["ID"]]
Biological_Description<-enrich.r@result[["Description"]]
Gene<-enrich.r@result[["geneID"]]
GSE62156_HOXAUnk_TLX3 <-data.frame(Path, Biological_Description, Gene)


enrich.result<-enrich.results[[22]]
enrich.r <- enrich.result
Path<-enrich.r@result[["ID"]]
Biological_Description<-enrich.r@result[["Description"]]
Gene<-enrich.r@result[["geneID"]]
GSE62156_Immature_ImmHOXA <-data.frame(Path, Biological_Description, Gene)



enrich.result<-enrich.results[[23]]
enrich.r <- enrich.result
Path<-enrich.r@result[["ID"]]
Biological_Description<-enrich.r@result[["Description"]]
Gene<-enrich.r@result[["geneID"]]
GSE62156_Immature_MLL <-data.frame(Path, Biological_Description, Gene)

enrich.result<-enrich.results[[24]]
enrich.r <- enrich.result
Path<-enrich.r@result[["ID"]]
Biological_Description<-enrich.r@result[["Description"]]
Gene<-enrich.r@result[["geneID"]]
GSE62156_Immature_TAL <-data.frame(Path, Biological_Description, Gene)


enrich.result<-enrich.results[[25]]
enrich.r <- enrich.result
Path<-enrich.r@result[["ID"]]
Biological_Description<-enrich.r@result[["Description"]]
Gene<-enrich.r@result[["geneID"]]
GSE62156_Immature_TLX1 <-data.frame(Path, Biological_Description, Gene)


enrich.result<-enrich.results[[26]]
enrich.r <- enrich.result
Path<-enrich.r@result[["ID"]]
Biological_Description<-enrich.r@result[["Description"]]
Gene<-enrich.r@result[["geneID"]]
GSE62156_Immature_TLX3 <-data.frame(Path, Biological_Description, Gene)


# Immature_MLL, Immature_TAL, Immature_TLX1, Immature_TLX3, ImmHOXA_MLL, ImmHOXA_TAL, ImmHOXA_TLX1, ImmHOXA_TLX3, MLL_TAL, MLL_TLX1, MLL_TLX3, TLX, HOX_CALM, HOX_ImHOXA, HOXs_MLL, HOXs_TAL, HOXs_TLX1, HOXs_TLX3, HOX_TLX, Imm_HOX, Imm_HOXAUnk, Imm_CALM, Imm_MLL, Imm_TAL, Imm_TLX1, Imm_TLX3, Imm_TLX

enrich.result<-enrich.results[[27]]
enrich.r <- enrich.result
Path<-enrich.r@result[["ID"]]
Biological_Description<-enrich.r@result[["Description"]]
Gene<-enrich.r@result[["geneID"]]
GSE62156_ImmHOXA_MLL <-data.frame(Path, Biological_Description, Gene)



enrich.result<-enrich.results[[28]]
enrich.r <- enrich.result
Path<-enrich.r@result[["ID"]]
Biological_Description<-enrich.r@result[["Description"]]
Gene<-enrich.r@result[["geneID"]]
GSE62156_ImmHOXA_TAL <-data.frame(Path, Biological_Description, Gene)

enrich.result<-enrich.results[[29]]
enrich.r <- enrich.result
Path<-enrich.r@result[["ID"]]
Biological_Description<-enrich.r@result[["Description"]]
Gene<-enrich.r@result[["geneID"]]
GSE62156_ImmHOXA_TLX1 <-data.frame(Path, Biological_Description, Gene)


enrich.result<-enrich.results[[30]]
enrich.r <- enrich.result
Path<-enrich.r@result[["ID"]]
Biological_Description<-enrich.r@result[["Description"]]
Gene<-enrich.r@result[["geneID"]]
GSE62156_ImmHOXA_TLX3 <-data.frame(Path, Biological_Description, Gene)


enrich.result<-enrich.results[[31]]
enrich.r <- enrich.result
Path<-enrich.r@result[["ID"]]
Biological_Description<-enrich.r@result[["Description"]]
Gene<-enrich.r@result[["geneID"]]
GSE62156_MLL_TAL <-data.frame(Path, Biological_Description, Gene)


enrich.result<-enrich.results[[32]]
enrich.r <- enrich.result
Path<-enrich.r@result[["ID"]]
Biological_Description<-enrich.r@result[["Description"]]
Gene<-enrich.r@result[["geneID"]]
GSE62156_MLL_TLX1 <-data.frame(Path, Biological_Description, Gene)



enrich.result<-enrich.results[[33]]
enrich.r <- enrich.result
Path<-enrich.r@result[["ID"]]
Biological_Description<-enrich.r@result[["Description"]]
Gene<-enrich.r@result[["geneID"]]
GSE62156_MLL_TLX3 <-data.frame(Path, Biological_Description, Gene)

enrich.result<-enrich.results[[34]]
enrich.r <- enrich.result
Path<-enrich.r@result[["ID"]]
Biological_Description<-enrich.r@result[["Description"]]
Gene<-enrich.r@result[["geneID"]]
GSE62156_TLX <-data.frame(Path, Biological_Description, Gene)



enrich.result<-enrich.results[[35]]
enrich.r <- enrich.result
Path<-enrich.r@result[["ID"]]
Biological_Description<-enrich.r@result[["Description"]]
Gene<-enrich.r@result[["geneID"]]
GSE62156_HOX_CALM <-data.frame(Path, Biological_Description, Gene)

# ImmHOXA_TLX3, MLL_TAL, MLL_TLX1, MLL_TLX3, TLX, HOX_CALM, HOX_ImHOXA, HOXs_MLL, HOXs_TAL, HOXs_TLX1, HOXs_TLX3, HOX_TLX, Imm_HOX, Imm_HOXAUnk, Imm_CALM, Imm_MLL, Imm_TAL, Imm_TLX1, Imm_TLX3, Imm_TLX

enrich.result<-enrich.results[[36]]
enrich.r <- enrich.result
Path<-enrich.r@result[["ID"]]
Biological_Description<-enrich.r@result[["Description"]]
Gene<-enrich.r@result[["geneID"]]
GSE62156_HOX_ImHOXA <-data.frame(Path, Biological_Description, Gene)

enrich.result<-enrich.results[[37]]
enrich.r <- enrich.result
Path<-enrich.r@result[["ID"]]
Biological_Description<-enrich.r@result[["Description"]]
Gene<-enrich.r@result[["geneID"]]
GSE62156_HOXs_MLL <-data.frame(Path, Biological_Description, Gene)

enrich.result<-enrich.results[[38]]
enrich.r <- enrich.result
Path<-enrich.r@result[["ID"]]
Biological_Description<-enrich.r@result[["Description"]]
Gene<-enrich.r@result[["geneID"]]
GSE62156_HOX_Imm <-data.frame(Path, Biological_Description, Gene)


enrich.result<-enrich.results[[39]]
enrich.r <- enrich.result
Path<-enrich.r@result[["ID"]]
Biological_Description<-enrich.r@result[["Description"]]
Gene<-enrich.r@result[["geneID"]]
GSE62156_HOXs_TAL <-data.frame(Path, Biological_Description, Gene)

enrich.result<-enrich.results[[40]]
enrich.r <- enrich.result
Path<-enrich.r@result[["ID"]]
Biological_Description<-enrich.r@result[["Description"]]
Gene<-enrich.r@result[["geneID"]]
GSE62156_HOXs_TLX1 <-data.frame(Path, Biological_Description, Gene)


enrich.result<-enrich.results[[41]]
enrich.r <- enrich.result
Path<-enrich.r@result[["ID"]]
Biological_Description<-enrich.r@result[["Description"]]
Gene<-enrich.r@result[["geneID"]]
GSE62156_HOXs_TLX3 <-data.frame(Path, Biological_Description, Gene)


enrich.result<-enrich.results[[42]]
enrich.r <- enrich.result
Path<-enrich.r@result[["ID"]]
Biological_Description<-enrich.r@result[["Description"]]
Gene<-enrich.r@result[["geneID"]]
GSE62156_HOX_TLX <-data.frame(Path, Biological_Description, Gene)


enrich.result<-enrich.results[[43]]
enrich.r <- enrich.result
Path<-enrich.r@result[["ID"]]
Biological_Description<-enrich.r@result[["Description"]]
Gene<-enrich.r@result[["geneID"]]
GSE62156_Imm_HOX <-data.frame(Path, Biological_Description, Gene)

# HOXs_TAL, HOXs_TLX1, HOXs_TLX3, HOX_TLX, Imm_HOX, Imm_HOXAUnk, Imm_CALM, Imm_MLL, Imm_TAL, Imm_TLX1, Imm_TLX3, Imm_TLX

enrich.result<-enrich.results[[44]]
enrich.r <- enrich.result
Path<-enrich.r@result[["ID"]]
Biological_Description<-enrich.r@result[["Description"]]
Gene<-enrich.r@result[["geneID"]]
GSE62156_Imm_HOXAUnk <-data.frame(Path, Biological_Description, Gene)

enrich.result<-enrich.results[[45]]
enrich.r <- enrich.result
Path<-enrich.r@result[["ID"]]
Biological_Description<-enrich.r@result[["Description"]]
Gene<-enrich.r@result[["geneID"]]
GSE62156_Imm_CALM <-data.frame(Path, Biological_Description, Gene)



enrich.result<-enrich.results[[46]]
enrich.r <- enrich.result
Path<-enrich.r@result[["ID"]]
Biological_Description<-enrich.r@result[["Description"]]
Gene<-enrich.r@result[["geneID"]]
GSE62156_Imm_MLL <-data.frame(Path, Biological_Description, Gene)


enrich.result<-enrich.results[[47]]
enrich.r <- enrich.result
Path<-enrich.r@result[["ID"]]
Biological_Description<-enrich.r@result[["Description"]]
Gene<-enrich.r@result[["geneID"]]
GSE62156_Imm_TAL <-data.frame(Path, Biological_Description, Gene)


enrich.result<-enrich.results[[48]]
enrich.r <- enrich.result
Path<-enrich.r@result[["ID"]]
Biological_Description<-enrich.r@result[["Description"]]
Gene<-enrich.r@result[["geneID"]]
GSE62156_Imm_TLX1 <-data.frame(Path, Biological_Description, Gene)



enrich.result<-enrich.results[[49]]
enrich.r <- enrich.result
Path<-enrich.r@result[["ID"]]
Biological_Description<-enrich.r@result[["Description"]]
Gene<-enrich.r@result[["geneID"]]
GSE62156_Imm_TLX3 <-data.frame(Path, Biological_Description, Gene)

enrich.result<-enrich.results[[50]]
enrich.r <- enrich.result
Path<-enrich.r@result[["ID"]]
Biological_Description<-enrich.r@result[["Description"]]
Gene<-enrich.r@result[["geneID"]]
GSE62156_Imm_TLX <-data.frame(Path, Biological_Description, Gene)

ls(pattern = 'GSE62156_')

```


GSE62156_CALMAF10_CALMHOX, GSE62156_CALMAF10_CALMHOXAUnk, GSE62156_CALMAF10_CALMImmature, GSE62156_CALMAF10_CALMImmatureHOXA, GSE62156_CALMAF10_CALMMLL, GSE62156_CALMAF10_CALMTAL, GSE62156_CALMAF10_CALMTLX1, GSE62156_CALMAF10_CALMTLX3, GSE62156_HOX_Immature, GSE62156_HOX_ImmHOXA, GSE62156_HOX_MLL, GSE62156_HOX_TAL, GSE62156_HOX_TLX1, GSE62156_HOX_TLX3, GSE62156_HOXAUnk_Imm, GSE62156_HOXAUnk_HOX, GSE62156_HOXAUnk_ImmHOXA, GSE62156_HOXAUnk_MLL, GSE62156_HOXAUnk_TLX1, GSE62156_HOXAUnk_TLX3, GSE62156_Immature_ImmHOXA, GSE62156_Immature_MLL, GSE62156_Immature_TAL, GSE62156_Immature_TLX1, GSE62156_Immature_TLX3, GSE62156_ImmHOXA_MLL, GSE62156_ImmHOXA_TAL, GSE62156_ImmHOXA_TLX1, GSE62156_ImmHOXA_TLX3, GSE62156_MLL_TAL, GSE62156_MLL_TLX1, GSE62156_MLL_TLX3, GSE62156_TLX, GSE62156_HOX_CALM, GSE62156_HOX_ImHOXA, GSE62156_HOXs_MLL, GSE62156_HOXs_TAL, GSE62156_HOXs_TLX1, GSE62156_HOXs_TLX3, GSE62156_HOX_TLX, GSE62156_Imm_HOX, GSE62156_Imm_HOXAUnk, GSE62156_Imm_CALM, GSE62156_Imm_MLL, GSE62156_Imm_TAL, GSE62156_Imm_TLX1, GSE62156_Imm_TLX3, GSE62156_Imm_TLX


```{r, warning=TRUE, error=TRUE}

library("xlsx")
write.xlsx(GSE62156_CALMAF10_CALMHOX, 'C:/Users/Copito/OneDrive/Documentos/Master bioinf y bioest/TFM/datasets/GSE33470/Resultado_GSE62156_CALMAF10_CALMHOX.xlsx', row.names = FALSE,
           col.names = TRUE)

write.xlsx(GSE62156_CALMAF10_CALMHOXAUnk, 'C:/Users/Copito/OneDrive/Documentos/Master bioinf y bioest/TFM/datasets/GSE33470/Resultado_GSE62156_CALMAF10_CALMHOXAUnk.xlsx', row.names = FALSE,
           col.names = TRUE)
           
write.xlsx(GSE62156_CALMAF10_CALMImmature, 'C:/Users/Copito/OneDrive/Documentos/Master bioinf y bioest/TFM/datasets/GSE33470/Resultado_GSE62156_CALMAF10_CALMImmature.xlsx', row.names = FALSE,
           col.names = TRUE)

write.xlsx(GSE62156_CALMAF10_CALMImmatureHOXA, 'C:/Users/Copito/OneDrive/Documentos/Master bioinf y bioest/TFM/datasets/GSE33470/Resultado_GSE62156_CALMAF10_CALMImmatureHOXA.xlsx', row.names = FALSE,
           col.names = TRUE)


write.xlsx(GSE62156_CALMAF10_CALMMLL, 'C:/Users/Copito/OneDrive/Documentos/Master bioinf y bioest/TFM/datasets/GSE33470/Resultado_GSE62156_CALMAF10_CALMMLL.xlsx', row.names = FALSE,
           col.names = TRUE)


write.xlsx(GSE62156_CALMAF10_CALMTAL, 'C:/Users/Copito/OneDrive/Documentos/Master bioinf y bioest/TFM/datasets/GSE33470/Resultado_GSE62156_CALMAF10_CALMTAL.xlsx', row.names = FALSE,
           col.names = TRUE)


write.xlsx(GSE62156_CALMAF10_CALMTLX1, 'C:/Users/Copito/OneDrive/Documentos/Master bioinf y bioest/TFM/datasets/GSE33470/Resultado_GSE62156_CALMAF10_CALMTLX1.xlsx', row.names = FALSE,
           col.names = TRUE)


write.xlsx(GSE62156_CALMAF10_CALMTLX3, 'C:/Users/Copito/OneDrive/Documentos/Master bioinf y bioest/TFM/datasets/GSE33470/Resultado_GSE62156_CALMAF10_CALMTLX3.xlsx', row.names = FALSE,
           col.names = TRUE)


write.xlsx(GSE62156_HOX_Immature, 'C:/Users/Copito/OneDrive/Documentos/Master bioinf y bioest/TFM/datasets/GSE33470/Resultado_GSE62156_HOX_Immature.xlsx', row.names = FALSE,
           col.names = TRUE)

# GSE62156_CALMAF10_CALMTLX1, GSE62156_CALMAF10_CALMTLX3, GSE62156_HOX_Immature, GSE62156_HOX_ImmHOXA, GSE62156_HOX_MLL, GSE62156_HOX_TAL, GSE62156_HOX_TLX1, GSE62156_HOX_TLX3, GSE62156_HOXAUnk_Imm, GSE62156_HOXAUnk_HOX, GSE62156_HOXAUnk_ImmHOXA, GSE62156_HOXAUnk_MLL, GSE62156_HOXAUnk_TLX1, GSE62156_HOXAUnk_TLX3, GSE62156_Immature_ImmHOXA, GSE62156_Immature_MLL, GSE62156_Immature_TAL, GSE62156_Immature_TLX1, GSE62156_Immature_TLX3, GSE62156_ImmHOXA_MLL, GSE62156_ImmHOXA_TAL, GSE62156_ImmHOXA_TLX1, GSE62156_ImmHOXA_TLX3, GSE62156_MLL_TAL, GSE62156_MLL_TLX1, GSE62156_MLL_TLX3, GSE62156_TLX, GSE62156_HOX_CALM, GSE62156_HOX_ImHOXA, GSE62156_HOXs_MLL, GSE62156_HOXs_TAL, GSE62156_HOXs_TLX1, GSE62156_HOXs_TLX3, GSE62156_HOX_TLX, GSE62156_Imm_HOX, GSE62156_Imm_HOXAUnk, GSE62156_Imm_CALM, GSE62156_Imm_MLL, GSE62156_Imm_TAL, GSE62156_Imm_TLX1, GSE62156_Imm_TLX3, GSE62156_Imm_TLX

write.xlsx(GSE62156_HOX_HOXA, 'C:/Users/Copito/OneDrive/Documentos/Master bioinf y bioest/TFM/datasets/GSE33470/Resultado_GSE62156_HOX_HOXA.xlsx', row.names = FALSE,
           col.names = TRUE)

write.xlsx(GSE62156_HOX_ImmHOXA, 'C:/Users/Copito/OneDrive/Documentos/Master bioinf y bioest/TFM/datasets/GSE33470/Resultado_GSE62156_HOX_ImmHOXA.xlsx', row.names = FALSE,
           col.names = TRUE)

write.xlsx(GSE62156_HOX_MLL, 'C:/Users/Copito/OneDrive/Documentos/Master bioinf y bioest/TFM/datasets/GSE33470/Resultado_GSE62156_HOX_MLL.xlsx', row.names = FALSE,
           col.names = TRUE)

write.xlsx(GSE62156_HOX_TAL, 'C:/Users/Copito/OneDrive/Documentos/Master bioinf y bioest/TFM/datasets/GSE33470/Resultado_GSE62156_HOX_TAL.xlsx', row.names = FALSE,
           col.names = TRUE)


write.xlsx(GSE62156_HOX_TLX1, 'C:/Users/Copito/OneDrive/Documentos/Master bioinf y bioest/TFM/datasets/GSE33470/Resultado_GSE62156_HOX_TLX1.xlsx', row.names = FALSE,
           col.names = TRUE)


write.xlsx(GSE62156_HOX_TLX3, 'C:/Users/Copito/OneDrive/Documentos/Master bioinf y bioest/TFM/datasets/GSE33470/Resultado_GSE62156_HOX_TLX3.xlsx', row.names = FALSE,
           col.names = TRUE)

write.xlsx(GSE62156_HOXAUnk_Imm, 'C:/Users/Copito/OneDrive/Documentos/Master bioinf y bioest/TFM/datasets/GSE33470/Resultado_GSE62156_HOXAUnk_Imm.xlsx', row.names = FALSE,
           col.names = TRUE)

write.xlsx(GSE62156_HOXAUnk_HOX, 'C:/Users/Copito/OneDrive/Documentos/Master bioinf y bioest/TFM/datasets/GSE33470/Resultado_GSE62156_HOXAUnk_HOX.xlsx', row.names = FALSE,
           col.names = TRUE)


write.xlsx(GSE62156_HOXAUnk_ImmHOXA, 'C:/Users/Copito/OneDrive/Documentos/Master bioinf y bioest/TFM/datasets/GSE33470/Resultado_GSE62156_HOXAUnk_ImmHOXA.xlsx', row.names = FALSE,
           col.names = TRUE)


write.xlsx(GSE62156_HOXAUnk_MLL, 'C:/Users/Copito/OneDrive/Documentos/Master bioinf y bioest/TFM/datasets/GSE33470/Resultado_GSE62156_HOXAUnk_MLL.xlsx', row.names = FALSE,
           col.names = TRUE)

write.xlsx(GSE62156_HOXAUnk_TLX1, 'C:/Users/Copito/OneDrive/Documentos/Master bioinf y bioest/TFM/datasets/GSE33470/Resultado_GSE62156_HOXAUnk_TLX1.xlsx', row.names = FALSE,
           col.names = TRUE)


write.xlsx(GSE62156_HOXAUnk_TLX3, 'C:/Users/Copito/OneDrive/Documentos/Master bioinf y bioest/TFM/datasets/GSE33470/Resultado_GSE62156_HOXAUnk_TLX3.xlsx', row.names = FALSE,
           col.names = TRUE)

# GSE62156_HOX_TLX3, GSE62156_HOXAUnk_Imm, GSE62156_HOXAUnk_HOX, GSE62156_HOXAUnk_ImmHOXA, GSE62156_HOXAUnk_MLL, GSE62156_HOXAUnk_TLX1, GSE62156_HOXAUnk_TLX3, GSE62156_Immature_ImmHOXA, GSE62156_Immature_MLL, GSE62156_Immature_TAL, GSE62156_Immature_TLX1, GSE62156_Immature_TLX3, GSE62156_ImmHOXA_MLL, GSE62156_ImmHOXA_TAL, GSE62156_ImmHOXA_TLX1, GSE62156_ImmHOXA_TLX3, GSE62156_MLL_TAL, GSE62156_MLL_TLX1, GSE62156_MLL_TLX3, GSE62156_TLX, GSE62156_HOX_CALM, GSE62156_HOX_ImHOXA, GSE62156_HOXs_MLL, GSE62156_HOXs_TAL, GSE62156_HOXs_TLX1, GSE62156_HOXs_TLX3, GSE62156_HOX_TLX, GSE62156_Imm_HOX, GSE62156_Imm_HOXAUnk, GSE62156_Imm_CALM, GSE62156_Imm_MLL, GSE62156_Imm_TAL, GSE62156_Imm_TLX1, GSE62156_Imm_TLX3, GSE62156_Imm_TLX

write.xlsx(GSE62156_Immature_ImmHOXA, 'C:/Users/Copito/OneDrive/Documentos/Master bioinf y bioest/TFM/datasets/GSE33470/Resultado_GSE62156_Immature_ImmHOXA.xlsx', row.names = FALSE,
           col.names = TRUE)


write.xlsx(GSE62156_Immature_MLL, 'C:/Users/Copito/OneDrive/Documentos/Master bioinf y bioest/TFM/datasets/GSE33470/Resultado_GSE62156_Immature_MLL.xlsx', row.names = FALSE,
           col.names = TRUE)


write.xlsx(GSE62156_Immature_TAL, 'C:/Users/Copito/OneDrive/Documentos/Master bioinf y bioest/TFM/datasets/GSE33470/Resultado_GSE62156_Immature_TAL.xlsx', row.names = FALSE,
           col.names = TRUE)


write.xlsx(GSE62156_Immature_TLX1, 'C:/Users/Copito/OneDrive/Documentos/Master bioinf y bioest/TFM/datasets/GSE33470/Resultado_GSE62156_Immature_TLX1.xlsx', row.names = FALSE,
           col.names = TRUE)


write.xlsx(GSE62156_Immature_TLX3, 'C:/Users/Copito/OneDrive/Documentos/Master bioinf y bioest/TFM/datasets/GSE33470/Resultado_GSE62156_Immature_TLX3.xlsx', row.names = FALSE,
           col.names = TRUE)


write.xlsx(GSE62156_ImmHOXA_MLL, 'C:/Users/Copito/OneDrive/Documentos/Master bioinf y bioest/TFM/datasets/GSE33470/Resultado_GSE62156_ImmHOXA_MLL.xlsx', row.names = FALSE,
           col.names = TRUE)


write.xlsx(GSE62156_ImmHOXA_TAL, 'C:/Users/Copito/OneDrive/Documentos/Master bioinf y bioest/TFM/datasets/GSE33470/Resultado_GSE62156_ImmHOXA_TAL.xlsx', row.names = FALSE,
           col.names = TRUE)


write.xlsx(GSE62156_ImmHOXA_TLX1, 'C:/Users/Copito/OneDrive/Documentos/Master bioinf y bioest/TFM/datasets/GSE33470/Resultado_GSE62156_ImmHOXA_TLX1.xlsx', row.names = FALSE,
           col.names = TRUE)


write.xlsx(GSE62156_ImmHOXA_TLX3, 'C:/Users/Copito/OneDrive/Documentos/Master bioinf y bioest/TFM/datasets/GSE33470/Resultado_GSE62156_ImmHOXA_TLX3.xlsx', row.names = FALSE,
           col.names = TRUE)


write.xlsx(GSE62156_MLL_TAL, 'C:/Users/Copito/OneDrive/Documentos/Master bioinf y bioest/TFM/datasets/GSE33470/Resultado_GSE62156_MLL_TAL.xlsx', row.names = FALSE,
           col.names = TRUE)


write.xlsx(GSE62156_MLL_TLX1, 'C:/Users/Copito/OneDrive/Documentos/Master bioinf y bioest/TFM/datasets/GSE33470/Resultado_GSE62156_MLL_TLX1.xlsx', row.names = FALSE,
           col.names = TRUE)

write.xlsx(GSE62156_MLL_TLX3, 'C:/Users/Copito/OneDrive/Documentos/Master bioinf y bioest/TFM/datasets/GSE33470/Resultado_GSE62156_MLL_TLX3.xlsx', row.names = FALSE,
           col.names = TRUE)


write.xlsx(GSE62156_TLX, 'C:/Users/Copito/OneDrive/Documentos/Master bioinf y bioest/TFM/datasets/GSE33470/Resultado_GSE62156_TLX.xlsx', row.names = FALSE,
           col.names = TRUE)

# GSE62156_Immature_TLX1, GSE62156_Immature_TLX3, GSE62156_ImmHOXA_MLL, GSE62156_ImmHOXA_TAL, GSE62156_ImmHOXA_TLX1, GSE62156_ImmHOXA_TLX3, GSE62156_MLL_TAL, GSE62156_MLL_TLX1, GSE62156_MLL_TLX3, GSE62156_TLX, GSE62156_HOX_CALM, GSE62156_HOX_ImHOXA, GSE62156_HOXs_MLL, GSE62156_HOXs_TAL, GSE62156_HOXs_TLX1, GSE62156_HOXs_TLX3, GSE62156_HOX_TLX, GSE62156_Imm_HOX, GSE62156_Imm_HOXAUnk, GSE62156_Imm_CALM, GSE62156_Imm_MLL, GSE62156_Imm_TAL, GSE62156_Imm_TLX1, GSE62156_Imm_TLX3, GSE62156_Imm_TLX

write.xlsx(GSE62156_HOX_CALM, 'C:/Users/Copito/OneDrive/Documentos/Master bioinf y bioest/TFM/datasets/GSE33470/Resultado_GSE62156_HOX_CALM.xlsx', row.names = FALSE,
           col.names = TRUE)


write.xlsx(GSE62156_HOX_ImHOXA, 'C:/Users/Copito/OneDrive/Documentos/Master bioinf y bioest/TFM/datasets/GSE33470/Resultado_GSE62156_HOX_ImHOXA.xlsx', row.names = FALSE,
           col.names = TRUE)


write.xlsx(GSE62156_HOXs_MLL, 'C:/Users/Copito/OneDrive/Documentos/Master bioinf y bioest/TFM/datasets/GSE33470/Resultado_GSE62156_HOXs_MLL.xlsx', row.names = FALSE,
           col.names = TRUE)


write.xlsx(GSE62156_HOX_Imm, 'C:/Users/Copito/OneDrive/Documentos/Master bioinf y bioest/TFM/datasets/GSE33470/Resultado_GSE62156_HOX_Imm.xlsx', row.names = FALSE,
           col.names = TRUE)



write.xlsx(GSE62156_HOXs_TAL, 'C:/Users/Copito/OneDrive/Documentos/Master bioinf y bioest/TFM/datasets/GSE33470/Resultado_GSE62156_HOXs_TAL.xlsx', row.names = FALSE,
           col.names = TRUE)


write.xlsx(GSE62156_HOXs_TLX1, 'C:/Users/Copito/OneDrive/Documentos/Master bioinf y bioest/TFM/datasets/GSE33470/Resultado_GSE62156_HOXs_TLX1.xlsx', row.names = FALSE,
           col.names = TRUE)



write.xlsx(GSE62156_HOXs_TLX3, 'C:/Users/Copito/OneDrive/Documentos/Master bioinf y bioest/TFM/datasets/GSE33470/Resultado_GSE62156_HOXs_TLX3.xlsx', row.names = FALSE,
           col.names = TRUE)


write.xlsx(GSE62156_HOX_TLX, 'C:/Users/Copito/OneDrive/Documentos/Master bioinf y bioest/TFM/datasets/GSE33470/Resultado_GSE62156_HOX_TLX.xlsx', row.names = FALSE,
           col.names = TRUE)

write.xlsx(GSE62156_Imm_HOX, 'C:/Users/Copito/OneDrive/Documentos/Master bioinf y bioest/TFM/datasets/GSE33470/Resultado_GSE62156_Imm_HOX.xlsx', row.names = FALSE,
           col.names = TRUE)


write.xlsx(GSE62156_Imm_HOXAUnk, 'C:/Users/Copito/OneDrive/Documentos/Master bioinf y bioest/TFM/datasets/GSE33470/Resultado_GSE62156_Imm_HOXAUnk.xlsx', row.names = FALSE,
           col.names = TRUE)



write.xlsx(GSE62156_Imm_CALM, 'C:/Users/Copito/OneDrive/Documentos/Master bioinf y bioest/TFM/datasets/GSE33470/Resultado_GSE62156_Imm_CALM.xlsx', row.names = FALSE,
           col.names = TRUE)


write.xlsx(GSE62156_Imm_MLL, 'C:/Users/Copito/OneDrive/Documentos/Master bioinf y bioest/TFM/datasets/GSE33470/Resultado_GSE62156_Imm_MLL.xlsx', row.names = FALSE,
           col.names = TRUE)



write.xlsx(GSE62156_Imm_TAL, 'C:/Users/Copito/OneDrive/Documentos/Master bioinf y bioest/TFM/datasets/GSE33470/Resultado_GSE62156_Imm_TAL.xlsx', row.names = FALSE,
           col.names = TRUE)


write.xlsx(GSE62156_Imm_TLX1, 'C:/Users/Copito/OneDrive/Documentos/Master bioinf y bioest/TFM/datasets/GSE33470/Resultado_GSE62156_Imm_TLX1.xlsx', row.names = FALSE,
           col.names = TRUE)


write.xlsx(GSE62156_Imm_TLX3, 'C:/Users/Copito/OneDrive/Documentos/Master bioinf y bioest/TFM/datasets/GSE33470/Resultado_GSE62156_Imm_TLX3.xlsx', row.names = FALSE,
           col.names = TRUE)

write.xlsx(GSE62156_Imm_TLX, 'C:/Users/Copito/OneDrive/Documentos/Master bioinf y bioest/TFM/datasets/GSE33470/Resultado_GSE62156_Imm_TLX.xlsx', row.names = FALSE,
           col.names = TRUE)


# GSE62156_HOXs_TLX3, GSE62156_HOX_TLX, GSE62156_Imm_HOX, GSE62156_Imm_HOXAUnk, GSE62156_Imm_CALM, GSE62156_Imm_MLL, GSE62156_Imm_TAL, GSE62156_Imm_TLX1, GSE62156_Imm_TLX3, GSE62156_Imm_TLX

```

# GSE110633


## Anotación de resultados y análisis de significación biológica

Para el análisis de significación se utilizan dos listas de transcritos:

La lista de transcritos diferencialmenete expresados
La lista de todos los tránscritos o “Universo”


```{r, include=TRUE, message=TRUE}
load('C:/Users/Copito/OneDrive/Documentos/Master bioinf y bioest/TFM/datasets/GSE110633/GSE110633_objetos.Rda')

load('C:/Users/Copito/OneDrive/Documentos/Master bioinf y bioest/TFM/datasets/GSE110633/filtr_dgeObjnorm.Rda')

load('C:/Users/Copito/OneDrive/Documentos/Master bioinf y bioest/TFM/datasets/GSE110633/GSE110633_Toptabs&Universe.Rda')

# load('C:/Users/crist/Documents/TFM/GSE110633_objetos.Rda')

# load('C:/Users/crist/Documents/TFM/GSE110633_Toptabs&Universe.rda')
```

```{r, include=TRUE, message=TRUE}


length(topGenes3)

length(universe3)
```


Anotación de los identificadores.

Esto es posible, y de hecho sencillo de llevar a cabo, usando el paquete annotate.

```{r, include=TRUE, message=TRUE}
library(GEOquery)
GSE110633_getGEO <- getGEO("GSE110633", GSEMatrix =TRUE, AnnotGPL=TRUE,destdir = "C:/Users/Copito/OneDrive/Documentos/Master bioinf y bioest/TFM/datasets/GSE110633/" )
GSE110633_getGEO<-GSE110633_getGEO[[1]]

```

Poniendo GRCh38 en internet, sale un enlace a Bioconductor. Vamos a usar org.Hs.eg.db...


```{r, include=TRUE, message=TRUE}
library(org.Hs.eg.db)
AnnotationDbi::keytypes(org.Hs.eg.db)
```



Los genes están determinados a partir de genes de Ensembl, pero con un punto y un número detrás. Quitaremos los puntos y los números de detrás, dejando solo el nombre de cada gen.

```{r, include=TRUE, message=TRUE}
library(stringr)
topGenes1<-str_sub(topGenes1,1,15)

topGenes2<-str_sub(topGenes2,1,15)

topGenes3<-str_sub(topGenes3,1,15)

topGenes4<-str_sub(topGenes4,1,15)

topGenes5<-str_sub(topGenes5,1,15)

topGenes6<-str_sub(topGenes6,1,15)


topAnots1 = AnnotationDbi::select(org.Hs.eg.db, topGenes1, c("ENTREZID",
                                             "SYMBOL",
                                             "UNIPROT",
                                             'GO',
                                             "GENENAME",
                                             "PATH"), keytype =
                                   "ENSEMBL")

topAnots2 = AnnotationDbi::select(org.Hs.eg.db, topGenes2, c("ENTREZID",
                                             "SYMBOL",
                                             "UNIPROT",
                                             'GO',
                                             "GENENAME",
                                             "PATH"), keytype =
                                   "ENSEMBL")


topAnots3 = AnnotationDbi::select(org.Hs.eg.db, topGenes3, c("ENTREZID",
                                             "SYMBOL",
                                             "UNIPROT",
                                             'GO',
                                             "GENENAME",
                                             "PATH"), keytype =
                                   "ENSEMBL")


topAnots4 = AnnotationDbi::select(org.Hs.eg.db, topGenes4, c("ENTREZID",
                                             "SYMBOL",
                                             "UNIPROT",
                                             'GO',
                                             "GENENAME",
                                             "PATH"), keytype =
                                   "ENSEMBL")


topAnots5 = AnnotationDbi::select(org.Hs.eg.db, topGenes5, c("ENTREZID",
                                             "SYMBOL",
                                             "UNIPROT",
                                             'GO',
                                             "GENENAME",
                                             "PATH"), keytype =
                                   "ENSEMBL")


topAnots6 = AnnotationDbi::select(org.Hs.eg.db, topGenes6, c("ENTREZID",
                                             "SYMBOL",
                                             "UNIPROT",
                                             'GO',
                                             "GENENAME",
                                             "PATH"), keytype =
                                   "ENSEMBL")
head(topAnots3)
dim(topAnots3)
```


```{r, include=TRUE, message=TRUE}

universe1<-str_sub(universe1,1,15)

universe2<-str_sub(universe2,1,15)


universe3<-str_sub(universe3,1,15)

universe4<-str_sub(universe4,1,15)
universe5<-str_sub(universe5,1,15)

universe6<-str_sub(universe6,1,15)

```


```{r, warning=TRUE, error=FALSE}
#if (!requireNamespace("BiocManager"))
    #install.packages("BiocManager")
#BiocManager::install(c("limma", "edgeR", "Glimma", #"org.Mm.eg.db", "gplots", "RColorBrewer", "NMF", "BiasedUrn"))
library(edgeR)
library(limma)
library(Glimma)
library(org.Mm.eg.db)
library(gplots)
library(RColorBrewer)
library(NMF)
```

```{r, warning=TRUE, error=FALSE}

y<-GSE110633_dgeObjnorm
group <- GSE110633_dgeObjnorm[["samples"]][["group"]]
y$samples$group <- group

highly_variable_lcpm<-GSE110633_log2countnorm
mypalette <- brewer.pal(60,"RdYlBu")
morecols <- colorRampPalette(mypalette)
col.cell <- GSE110633_dgeObjnorm[["samples"]][["cols"]]

heatmap.2(highly_variable_lcpm,col=rev(morecols(50)),trace="none", main="GSE110633",ColSideColors=col.cell,scale="row")

```


```{r, include=TRUE, message=TRUE}

univAnots1 = AnnotationDbi::select(org.Hs.eg.db, universe1, c("ENTREZID",
                                             "SYMBOL",
                                             "UNIPROT",
                                             'GO',
                                             "GENENAME",
                                             "PATH"), keytype = "ENSEMBL")

univAnots2 = AnnotationDbi::select(org.Hs.eg.db, universe2, c("ENTREZID",
                                             "SYMBOL",
                                             "UNIPROT",
                                             'GO',
                                             "GENENAME",
                                             "PATH"), keytype = "ENSEMBL")


univAnots3 = AnnotationDbi::select(org.Hs.eg.db, universe3, c("ENTREZID",
                                             "SYMBOL",
                                             "UNIPROT",
                                             'GO',
                                             "GENENAME",
                                             "PATH"), keytype = "ENSEMBL")


univAnots4 = AnnotationDbi::select(org.Hs.eg.db, universe4, c("ENTREZID",
                                             "SYMBOL",
                                             "UNIPROT",
                                             'GO',
                                             "GENENAME",
                                             "PATH"), keytype = "ENSEMBL")


univAnots5 = AnnotationDbi::select(org.Hs.eg.db, universe5, c("ENTREZID",
                                             "SYMBOL",
                                             "UNIPROT",
                                             'GO',
                                             "GENENAME",
                                             "PATH"), keytype = "ENSEMBL")


univAnots6 = AnnotationDbi::select(org.Hs.eg.db, universe6, c("ENTREZID",
                                             "SYMBOL",
                                             "UNIPROT",
                                             'GO',
                                             "GENENAME",
                                             "PATH"), keytype = "ENSEMBL")


head(univAnots2)
dim(univAnots2)
```

En este caso se observa como hay más anotaciones que transcritos, lo que sugiere que múltiples transcritos han sido mapeados en el mismo gen.


Análisis de enriquecimiento.

El paquete clusterProfiler admite identificadores de tipo ENSEMBL y permite gran variedad de análisis complementarios al enriquecimiento por lo que, es una de las mejores opciones para el análisis de significación biológica.

```{r, include=TRUE, message=TRUE}
library(clusterProfiler)
library(org.Hs.eg.db)



ego1 = enrichGO(gene = topGenes1, universe = universe1, keyType = "ENSEMBL", OrgDb = org.Hs.eg.db,
    ont = "BP", pAdjustMethod = "BH", pvalueCutoff = 0.05, qvalueCutoff = 0.05, readable = TRUE)
head(ego1[, -8], n = 5)


ego2 = enrichGO(gene = topGenes2, universe = universe2, keyType = "ENSEMBL", OrgDb = org.Hs.eg.db,
    ont = "BP", pAdjustMethod = "BH", pvalueCutoff = 0.05, qvalueCutoff = 0.05, readable = TRUE)
head(ego2[, -8], n = 5)


ego3 = enrichGO(gene = topGenes3, universe = universe3, keyType = "ENSEMBL", OrgDb = org.Hs.eg.db,
    ont = "BP", pAdjustMethod = "BH", pvalueCutoff = 0.05, qvalueCutoff = 0.05, readable = TRUE)
head(ego3[, -8], n = 5)


ego4 = enrichGO(gene = topGenes4, universe = universe4, keyType = "ENSEMBL", OrgDb = org.Hs.eg.db,
    ont = "BP", pAdjustMethod = "BH", pvalueCutoff = 0.05, qvalueCutoff = 0.05, readable = TRUE)
head(ego4[, -8], n = 5)


ego5 = enrichGO(gene = topGenes5, universe = universe5, keyType = "ENSEMBL", OrgDb = org.Hs.eg.db,
    ont = "BP", pAdjustMethod = "BH", pvalueCutoff = 0.05, qvalueCutoff = 0.05, readable = TRUE)
head(ego5[, -8], n = 5)


ego6 = enrichGO(gene = topGenes6, universe = universe6, keyType = "ENSEMBL", OrgDb = org.Hs.eg.db,
    ont = "BP", pAdjustMethod = "BH", pvalueCutoff = 0.05, qvalueCutoff = 0.05, readable = TRUE)
head(ego6[, -8], n = 5)
```

Con los resultados del análisis de enriquecimiento se pueden llevar a cabo distintas visualizaciones cuya interpretación exacta puede verse en el manual de clusterProfiler

```{r, include=TRUE, message=TRUE}
dotplot(ego2, showCategory = 7)
dotplot(ego4, showCategory = 7)
dotplot(ego6, showCategory = 7)
```


```{r, include=TRUE, message=TRUE}
library(ggplot2)
ego31 = simplify(ego4)
cnetplot(ego31, showCategory = 3, cex_category = 0.3, cex_label_category = 0.7, cex_gene = 0.2,
    cex_label_gene = 0.4, circular = TRUE, colorEdge = TRUE)
```


```{r, include=TRUE, message=TRUE}
library(enrichplot)
goplot(ego31, showCategory = 6, cex = 0.1)
```

```{r, include=TRUE, message=TRUE}
heatplot(ego31)
term_similarity_matrix = pairwise_termsim(ego4)
emapplot(term_similarity_matrix, showCategory = 15, group_category = TRUE, group_legend = TRUE)
```


```{r, include=TRUE, message=TRUE}
dotplot(ego4, showCategory = 7)
```

HOXA_IMM, HOXA_TAL, HOXA_TLX, IMM_TAL, IMM_TLX, TAL_TLX.
                            
```{r, include=TRUE, message=TRUE}
Path<-ego1@result[["ID"]]
Biological_Description<-ego1@result[["Description"]]
Gene<-ego1@result[["geneID"]]
GSE110633_HOXA_IMM <-data.frame(Path, Biological_Description, Gene)

library("xlsx")
write.xlsx(GSE110633_HOXA_IMM, 'C:/Users/Copito/OneDrive/Documentos/Master bioinf y bioest/TFM/datasets/GSE110633/Resultado_GSE110633_HOXA_IMM.xlsx', row.names = FALSE,
           col.names = TRUE)




Path<-ego2@result[["ID"]]
Biological_Description<-ego2@result[["Description"]]
Gene<-ego2@result[["geneID"]]
GSE110633_HOXA_TAL <-data.frame(Path, Biological_Description, Gene)

write.xlsx(GSE110633_HOXA_TAL, 'C:/Users/Copito/OneDrive/Documentos/Master bioinf y bioest/TFM/datasets/GSE33470/Resultado_GSE62156_HOXA_TAL.xlsx', row.names = FALSE,
           col.names = TRUE)



Path<-ego3@result[["ID"]]
Biological_Description<-ego3@result[["Description"]]
Gene<-ego3@result[["geneID"]]
GSE110633_HOXA_TLX <-data.frame(Path, Biological_Description, Gene)

write.xlsx(GSE110633_HOXA_TLX, 'C:/Users/Copito/OneDrive/Documentos/Master bioinf y bioest/TFM/datasets/GSE33470/Resultado_HOXA_TLX.xlsx', row.names = FALSE,
           col.names = TRUE)



Path<-ego4@result[["ID"]]
Biological_Description<-ego4@result[["Description"]]
Gene<-ego4@result[["geneID"]]
GSE110633_IMM_TAL <-data.frame(Path, Biological_Description, Gene)

library("xlsx")
write.xlsx(GSE110633_IMM_TAL, 'C:/Users/Copito/OneDrive/Documentos/Master bioinf y bioest/TFM/datasets/GSE110633/Resultado_GSE110633_IMM_TAL.xlsx', row.names = FALSE,
           col.names = TRUE)




Path<-ego5@result[["ID"]]
Biological_Description<-ego5@result[["Description"]]
Gene<-ego5@result[["geneID"]]
GSE110633_IMM_TLX <-data.frame(Path, Biological_Description, Gene)

write.xlsx(GSE110633_IMM_TLX, 'C:/Users/Copito/OneDrive/Documentos/Master bioinf y bioest/TFM/datasets/GSE33470/Resultado_GSE62156_IMM_TLX.xlsx', row.names = FALSE,
           col.names = TRUE)



Path<-ego6@result[["ID"]]
Biological_Description<-ego6@result[["Description"]]
Gene<-ego6@result[["geneID"]]
GSE110633_TAL_TLX <-data.frame(Path, Biological_Description, Gene)

write.xlsx(GSE110633_TAL_TLX, 'C:/Users/Copito/OneDrive/Documentos/Master bioinf y bioest/TFM/datasets/GSE33470/Resultado_TAL_TLX.xlsx', row.names = FALSE,
           col.names = TRUE)



           
```          


```{r, include=TRUE, message=TRUE}
save(ego1, topGenes1,
     ego2, topGenes2,
     ego3, topGenes3,
     ego4, topGenes4,
     ego5, topGenes5,
     ego6, topGenes6,
     
     file='C:/Users/Copito/OneDrive/Documentos/Master bioinf y bioest/TFM/datasets/GSE110633/GSE110633_Toptabs&Universe.Rda')

```


# GSE110636

## Anotación de resultados y análisis de significación biológica

Para el análisis de significación se utilizan dos listas de transcritos:

La lista de transcritos diferencialmenete expresados
La lista de todos los tránscritos o “Universo”


```{r, include=TRUE, message=TRUE}
load('C:/Users/Copito/OneDrive/Documentos/Master bioinf y bioest/TFM/datasets/GSE110636/GSE110636_objetos.Rda')

load('C:/Users/Copito/OneDrive/Documentos/Master bioinf y bioest/TFM/datasets/GSE110636/filtr_dgeObjnorm.Rda')

load('C:/Users/Copito/OneDrive/Documentos/Master bioinf y bioest/TFM/datasets/GSE110636/GSE110636_Toptabs&Universe.rda')

# load('C:/Users/laura/OneDrive/Documentos/Cris/GSE110633_objetos.Rda')

# load('C:/Users/crist/Documents/TFM/GSE110633_Toptabs&Universe.rda')
```


Anotación de los identificadores.

Esto es posible, y de hecho sencillo de llevar a cabo, usando el paquete annotate.

```{r, include=TRUE, message=TRUE}
library(GEOquery)
GSE110636_getGEO <- getGEO("GSE110636", GSEMatrix =TRUE, AnnotGPL=TRUE,destdir = "C:/Users/Copito/OneDrive/Documentos/Master bioinf y bioest/TFM/datasets/GSE110636/" )
GSE110636_getGEO<-GSE110636_getGEO[[1]]

```

Anotamos anteriormente con hgu133a.db.


```{r, include=TRUE, message=TRUE}
library(hgu133a.db)
AnnotationDbi::keytypes(hgu133a.db)
```



Los genes están determinados a partir de genes de Ensembl, pero con un punto y un número detrás. Quitaremos los puntos y los números de detrás, dejando solo el nombre de cada gen.

```{r, include=TRUE, message=TRUE}
library(stringr)
topGenes1<-str_sub(topGenes1,1,15)

topGenes2<-str_sub(topGenes2,1,15)

topGenes3<-str_sub(topGenes3,1,15)

topGenes4<-str_sub(topGenes4,1,15)

topGenes5<-str_sub(topGenes5,1,15)

topGenes6<-str_sub(topGenes6,1,15)


topAnots1 = AnnotationDbi::select(org.Hs.eg.db, topGenes1, c("ENTREZID",
                                             "SYMBOL",
                                             "UNIPROT",
                                             'GO',
                                             "GENENAME",
                                             "PATH"), keytype =
                                   "ENSEMBL")

topAnots2 = AnnotationDbi::select(org.Hs.eg.db, topGenes2, c("ENTREZID",
                                             "SYMBOL",
                                             "UNIPROT",
                                             'GO',
                                             "GENENAME",
                                             "PATH"), keytype =
                                   "ENSEMBL")


topAnots3 = AnnotationDbi::select(org.Hs.eg.db, topGenes3, c("ENTREZID",
                                             "SYMBOL",
                                             "UNIPROT",
                                             'GO',
                                             "GENENAME",
                                             "PATH"), keytype =
                                   "ENSEMBL")


topAnots4 = AnnotationDbi::select(org.Hs.eg.db, topGenes4, c("ENTREZID",
                                             "SYMBOL",
                                             "UNIPROT",
                                             'GO',
                                             "GENENAME",
                                             "PATH"), keytype =
                                   "ENSEMBL")


topAnots5 = AnnotationDbi::select(org.Hs.eg.db, topGenes5, c("ENTREZID",
                                             "SYMBOL",
                                             "UNIPROT",
                                             'GO',
                                             "GENENAME",
                                             "PATH"), keytype =
                                   "ENSEMBL")


topAnots6 = AnnotationDbi::select(org.Hs.eg.db, topGenes6, c("ENTREZID",
                                             "SYMBOL",
                                             "UNIPROT",
                                             'GO',
                                             "GENENAME",
                                             "PATH"), keytype =
                                   "ENSEMBL")
head(topAnots3)
dim(topAnots3)
```


```{r, include=TRUE, message=TRUE}

universe1<-str_sub(universe1,1,15)

universe2<-str_sub(universe2,1,15)


universe3<-str_sub(universe3,1,15)

universe4<-str_sub(universe4,1,15)
universe5<-str_sub(universe5,1,15)

universe6<-str_sub(universe6,1,15)

```



```{r, warning=TRUE, error=FALSE}
#if (!requireNamespace("BiocManager"))
    #install.packages("BiocManager")
#BiocManager::install(c("limma", "edgeR", "Glimma", #"org.Mm.eg.db", "gplots", "RColorBrewer", "NMF", "BiasedUrn"))
library(edgeR)
library(limma)
library(Glimma)
library(org.Mm.eg.db)
library(gplots)
library(RColorBrewer)
library(NMF)
```

```{r, warning=TRUE, error=FALSE}

y<-GSE110636_dgeObjnorm
group <- GSE110636_dgeObjnorm[["samples"]][["group"]]
y$samples$group <- group

highly_variable_lcpm<-GSE110636_log2countnorm
mypalette <- brewer.pal(60,"RdYlBu")
morecols <- colorRampPalette(mypalette)
col.cell <- GSE110636_dgeObjnorm[["samples"]][["cols"]]

GSE110636_colores=c("blue", "peru", "blue", "blue", "peru", "purple1", "red", "purple1", "blue", "purple1", "peru", "peru", "purple1", "peru", "peru", "red", "red", "red", "peru", "peru", "peru", "peru", "purple1", "blue", "red")


heatmap.2(highly_variable_lcpm,col=rev(morecols(50)),trace="none", main="GSE110636",ColSideColors=GSE110636_colores,scale="row")

```

```{r, include=TRUE, message=TRUE}

univAnots1 = AnnotationDbi::select(hgu133a.db, universe1, c("ENTREZID",
                                             "SYMBOL",
                                             "UNIPROT",
                                             'GO',
                                             "GENENAME",
                                             "PATH"), keytype = "ENSEMBL")

univAnots2 = AnnotationDbi::select(hgu133a.db, universe2, c("ENTREZID",
                                             "SYMBOL",
                                             "UNIPROT",
                                             'GO',
                                             "GENENAME",
                                             "PATH"), keytype = "ENSEMBL")


univAnots3 = AnnotationDbi::select(hgu133a.db, universe3, c("ENTREZID",
                                             "SYMBOL",
                                             "UNIPROT",
                                             'GO',
                                             "GENENAME",
                                             "PATH"), keytype = "ENSEMBL")


univAnots4 = AnnotationDbi::select(hgu133a.db, universe4, c("ENTREZID",
                                             "SYMBOL",
                                             "UNIPROT",
                                             'GO',
                                             "GENENAME",
                                             "PATH"), keytype = "ENSEMBL")


univAnots5 = AnnotationDbi::select(hgu133a.db, universe5, c("ENTREZID",
                                             "SYMBOL",
                                             "UNIPROT",
                                             'GO',
                                             "GENENAME",
                                             "PATH"), keytype = "ENSEMBL")


univAnots6 = AnnotationDbi::select(hgu133a.db, universe6, c("ENTREZID",
                                             "SYMBOL",
                                             "UNIPROT",
                                             'GO',
                                             "GENENAME",
                                             "PATH"), keytype = "ENSEMBL")


head(univAnots2)
dim(univAnots2)
```

En este caso se observa como hay más anotaciones que transcritos, lo que sugiere que múltiples transcritos han sido mapeados en el mismo gen.


Análisis de enriquecimiento.

El paquete clusterProfiler admite identificadores de tipo ENSEMBL y permite gran variedad de análisis complementarios al enriquecimiento por lo que, es una de las mejores opciones para el análisis de significación biológica.

```{r, include=TRUE, message=TRUE}
library(clusterProfiler)
library(hgu133a.db)



ego1 = enrichGO(gene = topGenes1, universe = universe1, keyType = "ENSEMBL", OrgDb = hgu133a.db,
    ont = "BP", pAdjustMethod = "BH", pvalueCutoff = 0.05, qvalueCutoff = 0.05, readable = TRUE)
head(ego1[, -8], n = 5)


ego2 = enrichGO(gene = topGenes2, universe = universe2, keyType = "ENSEMBL", OrgDb = hgu133a.db,
    ont = "BP", pAdjustMethod = "BH", pvalueCutoff = 0.05, qvalueCutoff = 0.05, readable = TRUE)
head(ego2[, -8], n = 5)


ego3 = enrichGO(gene = topGenes3, universe = universe3, keyType = "ENSEMBL", OrgDb = hgu133a.db,
    ont = "BP", pAdjustMethod = "BH", pvalueCutoff = 0.05, qvalueCutoff = 0.05, readable = TRUE)
head(ego3[, -8], n = 5)


ego4 = enrichGO(gene = topGenes4, universe = universe4, keyType = "ENSEMBL", OrgDb = hgu133a.db,
    ont = "BP", pAdjustMethod = "BH", pvalueCutoff = 0.05, qvalueCutoff = 0.05, readable = TRUE)
head(ego4[, -8], n = 5)


ego5 = enrichGO(gene = topGenes5, universe = universe5, keyType = "ENSEMBL", OrgDb = hgu133a.db,
    ont = "BP", pAdjustMethod = "BH", pvalueCutoff = 0.05, qvalueCutoff = 0.05, readable = TRUE)
head(ego5[, -8], n = 5)


ego6 = enrichGO(gene = topGenes6, universe = universe6, keyType = "ENSEMBL", OrgDb = hgu133a.db,
    ont = "BP", pAdjustMethod = "BH", pvalueCutoff = 0.05, qvalueCutoff = 0.05, readable = TRUE)
head(ego6[, -8], n = 5)
```

Con los resultados del análisis de enriquecimiento se pueden llevar a cabo distintas visualizaciones cuya interpretación exacta puede verse en el manual de clusterProfiler

```{r, include=TRUE, message=TRUE}
dotplot(ego2, showCategory = 7)
dotplot(ego3, showCategory = 7)
dotplot(ego4, showCategory = 7)
dotplot(ego5, showCategory = 7)
dotplot(ego6, showCategory = 7)
```


```{r, include=TRUE, message=TRUE}
library(ggplot2)
ego31 = simplify(ego3)
cnetplot(ego31, showCategory = 3, cex_category = 0.3, cex_label_category = 0.7, cex_gene = 0.2,
    cex_label_gene = 0.4, circular = TRUE, colorEdge = TRUE)
```


```{r, include=TRUE, message=TRUE}
library(enrichplot)
goplot(ego31, showCategory = 6, cex = 0.1)
```

```{r, include=TRUE, message=TRUE}
heatplot(ego31)
term_similarity_matrix = pairwise_termsim(ego3)
emapplot(term_similarity_matrix, showCategory = 15, group_category = TRUE, group_legend = TRUE)
```



HOXA_IMM, HOXA_TAL, HOXA_TLX, IMM_TAL, IMM_TLX, TAL_TLX.
                            
```{r, include=TRUE, message=TRUE}
Path<-ego1@result[["ID"]]
Biological_Description<-ego1@result[["Description"]]
Gene<-ego1@result[["geneID"]]
GSE110636_HOXA_IMM <-data.frame(Path, Biological_Description, Gene)

library("xlsx")
write.xlsx(GSE110636_HOXA_IMM, 'C:/Users/Copito/OneDrive/Documentos/Master bioinf y bioest/TFM/datasets/GSE110636/Resultado_GSE110636_HOXA_IMM.xlsx', row.names = FALSE,
           col.names = TRUE)




Path<-ego2@result[["ID"]]
Biological_Description<-ego2@result[["Description"]]
Gene<-ego2@result[["geneID"]]
GSE110636_HOXA_TAL <-data.frame(Path, Biological_Description, Gene)

write.xlsx(GSE110636_HOXA_TAL, 'C:/Users/Copito/OneDrive/Documentos/Master bioinf y bioest/TFM/datasets/GSE110636/Resultado_GSE110636_HOXA_TAL.xlsx', row.names = FALSE,
           col.names = TRUE)



Path<-ego3@result[["ID"]]
Biological_Description<-ego3@result[["Description"]]
Gene<-ego3@result[["geneID"]]
GSE110636_HOXA_TLX <-data.frame(Path, Biological_Description, Gene)

write.xlsx(GSE110636_HOXA_TLX, 'C:/Users/Copito/OneDrive/Documentos/Master bioinf y bioest/TFM/datasets/GSE110636/Resultado_GSE110636_HOXA_TLX.xlsx', row.names = FALSE,
           col.names = TRUE)



Path<-ego4@result[["ID"]]
Biological_Description<-ego4@result[["Description"]]
Gene<-ego4@result[["geneID"]]
GSE110636_IMM_TAL <-data.frame(Path, Biological_Description, Gene)

library("xlsx")
write.xlsx(GSE110636_IMM_TAL, 'C:/Users/Copito/OneDrive/Documentos/Master bioinf y bioest/TFM/datasets/GSE110636/Resultado_GSE110636_IMM_TAL.xlsx', row.names = FALSE,
           col.names = TRUE)




Path<-ego5@result[["ID"]]
Biological_Description<-ego5@result[["Description"]]
Gene<-ego5@result[["geneID"]]
GSE110636_IMM_TLX <-data.frame(Path, Biological_Description, Gene)

write.xlsx(GSE110636_IMM_TLX, 'C:/Users/Copito/OneDrive/Documentos/Master bioinf y bioest/TFM/datasets/GSE110636/Resultado_GSE110636_IMM_TLX.xlsx', row.names = FALSE,
           col.names = TRUE)



Path<-ego6@result[["ID"]]
Biological_Description<-ego6@result[["Description"]]
Gene<-ego6@result[["geneID"]]
GSE110636_TAL_TLX <-data.frame(Path, Biological_Description, Gene)

write.xlsx(GSE110636_TAL_TLX, 'C:/Users/Copito/OneDrive/Documentos/Master bioinf y bioest/TFM/datasets/GSE110636/Resultado_GSE110636_TAL_TLX.xlsx', row.names = FALSE,
           col.names = TRUE)



           
```          


```{r, include=TRUE, message=TRUE}
save(ego1, topGenes1,
     ego2, topGenes2,
     ego3, topGenes3,
     ego4, topGenes4,
     ego5, topGenes5,
     ego6, topGenes6,
     
     file='C:/Users/Copito/OneDrive/Documentos/Master bioinf y bioest/TFM/datasets/GSE110636/GSE110636_Toptabs&Universe.Rda')

```












